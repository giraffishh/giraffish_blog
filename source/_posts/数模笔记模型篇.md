---
index_img: 'https://img.picgo.net/2025/05/31/25-05-31-174868501780081c5020678b86acf.webp'
banner_img: 'https://img.picgo.net/2025/05/31/25-05-31-174868456032966958ff522538315.webp'
title: 数模笔记模型篇
categories:
  - 学习笔记
tags:
  - 数学建模
comments: true
abbrlink: 51e2c075
date: 2025-05-31 19:42:50
updated: 2025-05-31 19:51:50
---
## 线性规划（LP)

### 一般形式

![](https://img.picgo.net/2025/05/31/25-05-31-1748681029505759b640b31607dc8.png)

**可行解：** 满足约束条件（4）的解 $x = [x_1, \ldots, x_n]^T$，称为线性规划问题的可行解，而使目标函数（3）达到最大值的可行解叫最优解。  

**可行域：** 可行解构成的集合称为问题的可行域，记为 $R$​

使用 `scipy.optimize.linprog` 解 LP 的代码模板

```python
from scipy.optimize import linprog

# 目标函数系数 c（注意是最小化）
c = [cost1, cost2, ..., costn]  # 要求最小化 c^T x

# 不等式约束：Ax ≤ b, 若Ax ≥ b则两边同时取负号−Ax ≤ −b
A = [
    [a11, a12, ..., a1n],
    [a21, a22, ..., a2n],
    ...
]
b = [b1, b2, ..., bm]

# 等式约束：Aeq x = beq（可选）
A_eq = [
    [aeq11, aeq12, ..., aeq1n],
    ...
]
b_eq = [beq1, beq2, ...]

# 变量范围：每个变量 x_i 的 (min, max)
bounds = [(lb1, ub1), (lb2, ub2), ..., (lbn, ubn)]

# 求解
res = linprog(c, A_ub=A, b_ub=b, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method="highs")

# 输出结果
if res.success:
    print("最小值:", res.fun)
    print("最优解 x:", res.x)
else:
    print("求解失败:", res.message)
```

> 若求最大值就在目标函数c处加负号
>
> 例如：最大化利润 40x + 30y → 最小化 -40x -30y
> 则 `c = [-40, -30]`

非线性的有时候也可以转化为线性规划的问题

![](https://img.picgo.net/2025/05/31/25-05-31-1748683411323f0172724c3fe79bd.webp)

***

### 例题

市场上有 $n$ 种资产 $S_i$（$i = 1, 2, \ldots, n$）可以选择，现用数额为 $M$ 的相当大的资金作一个时期的投资。这 $n$ 种资产在这一时期内购买 $S_i$ 的平均收益率为 $r_i$，风险损失率为 $q_i$。投资越分散，总的风险越少，总体风险可用投资的 $S_i$ 中最大的一个风险来度量。

购买 $S_i$ 时要付交易费，费率为 $p_i$，当购买额不超过给定值 $u_i$ 时，交易费按购买 $u_i$ 计算。另外，假定同期银行存款利率是 $r_0$（$r_0 = 5\%$），既无交易费又无风险。

已知 $n = 4$ 时相关数据如下：

| 资产 $S_i$ | 收益率 $r_i(\%)$ | 风险率 $q_i(\%)$ | 交易费率 $p_i(\%)$ | 交易费阈值 $u_i$(元) |
|------------|------------------|------------------|--------------------|-----------------------|
| $S_1$      | 28               | 2.5              | 1                  | 103                   |
| $S_2$      | 21               | 1.5              | 2                  | 198                   |
| $S_3$      | 23               | 5.5              | 4.5                | 52                    |
| $S_4$      | 25               | 2.6              | 6.5                | 40                    |

**投资目标** 
用给定资金 $M$，有选择地购买若干种资产或存银行生息（无风险利率 $r_0=5\%$），要求：

1. 净收益尽可能大
2. 总体风险（定义为所投资资产中最大单个风险）尽可能小

### 解答

#### 符号规定

| 符号 | 说明 |
|------|------|
| $s_i$ | 第 $i$ 种投资项目（$i = 0,1,\ldots,n$），其中 $s_0$ 表示存入银行 |
| $r_i$ | $s_i$ 的平均收益率（$i = 0,\ldots,n$） |
| $p_i$ | $s_i$ 的交易费率（$i = 0,\ldots,n$），其中 $p_0 = 0$ |
| $q_i$ | $s_i$ 的风险损失率（$i = 0,\ldots,n$），其中 $q_0 = 0$ |
| $u_i$ | $s_i$ 的交易定额（$i = 1,\ldots,n$） |
| $x_i$ | 投资项目 $s_i$ 的资金（$i = 0,1,\ldots,n$） |
| $a$   | 投资风险度 |
| $Q$   | 总体收益 |

#### 基本假设

* 投资规模
   投资数额 $M$ 相当大，为便于计算，设 $M = 1$（单位化处理）

* 风险分散性
   投资越分散，总风险越小

* 风险度量
   总体风险定义为所有投资项目 $s_i$ 中最大的单个风险，即 $\max(q_i x_i)$，其中 $x_i$ 为投资比例

* 资产独立性
   $n + 1$ 种资产 $s_i$（含银行存款）之间相互独立

* 参数稳定性
   在投资期内，各资产的参数为定值，不受其他意外因素影响： 
   - 收益率 $r_i$ 
   - 交易费率 $p_i$ 
   - 风险损失率 $q_i$ 

* 收益与风险的决定性
   净收益和总体风险仅由 $r_i, p_i, q_i$ 决定，不受其他因素干扰

#### 模型关键定义

* 总体风险度量
   总体风险定义为所投资资产中最大单项风险：
   $$\max \{ q_i x_i \mid i = 1, 2, \ldots, n \}.$$

* 交易费分段函数
   购买资产 $s_i$ ($i = 1, \ldots, n$) 的交易费计算规则： 
   $$
   \text{交易费} = 
   \begin{cases} 
   p_i x_i, & x_i > u_i; \\ 
   p_i u_i, & x_i \leq u_i.
   \end{cases}
   $$
   > 简化假设：由于 $u_i$ 和 $p_i u_i$ 相对总投资 $M$ 极小，净收益可近似为 $(r_i - p_i)x_i$

* 多目标规划性质
   目标函数需同时满足： 

   - 净收益 $(r_i - p_i)x_i$ 最大化 
   - 总体风险 $\max(q_i x_i)$ 最小化 
     （需通过多目标优化方法求解）
     

**总结一下：**
$$
\text{目标函数}
\begin{cases} 
\max \sum\limits_{i=0}^n (r_i - p_i)x_i & \text{(最大化净收益)} \\ 
\min \max \{q_i x_i\} & \text{(最小化最大单项风险)}
\end{cases}
$$

$$
\text{约束条件}
\begin{cases} 
\sum\limits_{i=0}^n (1 + p_i)x_i = M & \text{(总资金约束)} \\ 
x_i \geq 0, & i = 0,1,\cdots,n
\end{cases}
$$

#### 转化为线性规划问题

**模型一：** 固定风险水平下的收益优化模型

通过引入风险承受界限 $a$，将多目标规划转化为**单目标线性规划**：
- 限定最大风险：$\max \frac{q_i x_i}{M} \leq a$
- 单一优化目标：最大化净收益

**目标函数** 
$$
\max \sum_{i=0}^n (r_i - p_i)x_i
$$

**约束条件** 
$$
\begin{cases}
\frac{q_i x_i}{M} \leq a, & i=1,\ldots,n \quad \text{(单项风险控制)} \\
\sum\limits_{i=0}^n (1 + p_i)x_i = M, & \text{(资金总量约束)} \\
x_i \geq 0, & i=0,1,\ldots,n \quad \text{(非负投资)}
\end{cases}
$$

***

**模型二：** 固定收益下的风险最小化

**目标函数** 
$$
\min \{\max \{ q_i x_i \}\}
$$

**约束条件** 
$$
\begin{cases}
\sum\limits_{i=0}^n (r_i - p_i)x_i \geq k & \text{(最低收益要求)} \\
\sum\limits_{i=0}^n (1 + p_i)x_i = M & \text{(资金总量约束)} \\
x_i \geq 0, & i=0,1,\ldots,n
\end{cases}
$$

***

**模型三：** 风险-收益加权优化

投资者在权衡资产风险和预期收益两方面时，希望选择一个令自己满意的投资组合。因此对风险、收益分别赋予权重 $s$（$0 < s \leq 1$）和 $(1-s)$，$s$称为投资偏好系数

**目标函数** 
$$
\min \left[ s \cdot \max \{ q_i x_i \} - (1-s) \sum\limits_{i=0}^n (r_i - p_i)x_i \right]
$$

**约束条件** 
$$
\begin{cases}
\sum\limits_{i=0}^n (1 + p_i)x_i = M \\
x_i \geq 0, & i=0,1,\ldots,n
\end{cases}
$$