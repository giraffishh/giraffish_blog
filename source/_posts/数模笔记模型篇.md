---
index_img: 'https://cdn.giraffish.me/blog/25-05-31-1748685017800.webp'
banner_img: 'https://cdn.giraffish.me/blog/25-05-31-1748684560329.webp'
title: æ•°æ¨¡ç¬”è®°æ¨¡å‹ç¯‡
categories:
  - å­¦ä¹ ç¬”è®°
tags:
  - æ•°å­¦å»ºæ¨¡
comments: true
abbrlink: 51e2c075
date: 2025-05-31 20:12:39
updated: 2025-07-16 23:58:16
---
## çº¿æ€§è§„åˆ’ï¼ˆLPï¼‰

### ä¸€èˆ¬å½¢å¼

![](https://cdn.giraffish.me/blog/25-05-31-1748681029505.png)

**å¯è¡Œè§£ï¼š** æ»¡è¶³çº¦æŸæ¡ä»¶ï¼ˆ4ï¼‰çš„è§£ $x = [x_1, \ldots, x_n]^T$ï¼Œç§°ä¸ºçº¿æ€§è§„åˆ’é—®é¢˜çš„å¯è¡Œè§£ï¼Œè€Œä½¿ç›®æ ‡å‡½æ•°ï¼ˆ3ï¼‰è¾¾åˆ°æœ€å¤§å€¼çš„å¯è¡Œè§£å«æœ€ä¼˜è§£ã€‚  

**å¯è¡ŒåŸŸï¼š** å¯è¡Œè§£æ„æˆçš„é›†åˆç§°ä¸ºé—®é¢˜çš„å¯è¡ŒåŸŸï¼Œè®°ä¸º $R$

ä½¿ç”¨ `scipy.optimize.linprog` è§£ LP çš„ä»£ç æ¨¡æ¿

> 25.6.25æ›´æ–°ï¼š`scipy.optimize.linprog`ç‹—éƒ½ä¸ç”¨ï¼Œç›´æ¥ç”¨PuLPåº“å¤ªé¦™äº†

```python
from scipy.optimize import linprog

# ç›®æ ‡å‡½æ•°ç³»æ•° cï¼ˆæ³¨æ„æ˜¯æœ€å°åŒ–ï¼‰
c = [cost1, cost2, ..., costn]  # è¦æ±‚æœ€å°åŒ– c^T x

# ä¸ç­‰å¼çº¦æŸï¼šAx â‰¤ b, è‹¥Ax â‰¥ båˆ™ä¸¤è¾¹åŒæ—¶å–è´Ÿå·âˆ’Ax â‰¤ âˆ’b
A = [
    [a11, a12, ..., a1n],
    [a21, a22, ..., a2n],
    ...
]
b = [b1, b2, ..., bm]

# ç­‰å¼çº¦æŸï¼šAeq x = beqï¼ˆå¯é€‰ï¼‰
A_eq = [
    [aeq11, aeq12, ..., aeq1n],
    ...
]
b_eq = [beq1, beq2, ...]

# å˜é‡èŒƒå›´ï¼šæ¯ä¸ªå˜é‡ x_i çš„ (min, max)
bounds = [(lb1, ub1), (lb2, ub2), ..., (lbn, ubn)]

# æ±‚è§£
res = linprog(c, A_ub=A, b_ub=b, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method="highs")

# è¾“å‡ºç»“æœ
if res.success:
    print("æœ€å°å€¼:", res.fun)
    print("æœ€ä¼˜è§£ x:", res.x)
else:
    print("æ±‚è§£å¤±è´¥:", res.message)
```

> è‹¥æ±‚æœ€å¤§å€¼å°±åœ¨ç›®æ ‡å‡½æ•°cå¤„åŠ è´Ÿå·
>
> ä¾‹å¦‚ï¼šæœ€å¤§åŒ–åˆ©æ¶¦ 40x + 30y â†’ æœ€å°åŒ– -40x -30y
> åˆ™ `c = [-40, -30]`

éçº¿æ€§çš„æœ‰æ—¶å€™ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºçº¿æ€§è§„åˆ’çš„é—®é¢˜

![](https://cdn.giraffish.me/blog/25-05-31-1748683411323.webp)

***

### ä¾‹é¢˜

å¸‚åœºä¸Šæœ‰ $n$ ç§èµ„äº§ $S_i$ï¼ˆ$i = 1, 2, \ldots, n$ï¼‰å¯ä»¥é€‰æ‹©ï¼Œç°ç”¨æ•°é¢ä¸º $M$ çš„ç›¸å½“å¤§çš„èµ„é‡‘ä½œä¸€ä¸ªæ—¶æœŸçš„æŠ•èµ„ã€‚è¿™ $n$ ç§èµ„äº§åœ¨è¿™ä¸€æ—¶æœŸå†…è´­ä¹° $S_i$ çš„å¹³å‡æ”¶ç›Šç‡ä¸º $r_i$ï¼Œé£é™©æŸå¤±ç‡ä¸º $q_i$ã€‚æŠ•èµ„è¶Šåˆ†æ•£ï¼Œæ€»çš„é£é™©è¶Šå°‘ï¼Œæ€»ä½“é£é™©å¯ç”¨æŠ•èµ„çš„ $S_i$ ä¸­æœ€å¤§çš„ä¸€ä¸ªé£é™©æ¥åº¦é‡ã€‚

è´­ä¹° $S_i$ æ—¶è¦ä»˜äº¤æ˜“è´¹ï¼Œè´¹ç‡ä¸º $p_i$ï¼Œå½“è´­ä¹°é¢ä¸è¶…è¿‡ç»™å®šå€¼ $u_i$ æ—¶ï¼Œäº¤æ˜“è´¹æŒ‰è´­ä¹° $u_i$ è®¡ç®—ã€‚å¦å¤–ï¼Œå‡å®šåŒæœŸé“¶è¡Œå­˜æ¬¾åˆ©ç‡æ˜¯ $r_0$ï¼ˆ$r_0 = 5\%$ï¼‰ï¼Œæ—¢æ— äº¤æ˜“è´¹åˆæ— é£é™©ã€‚

å·²çŸ¥ $n = 4$ æ—¶ç›¸å…³æ•°æ®å¦‚ä¸‹ï¼š

| èµ„äº§ $S_i$ | æ”¶ç›Šç‡ $r_i(\%)$ | é£é™©ç‡ $q_i(\%)$ | äº¤æ˜“è´¹ç‡ $p_i(\%)$ | äº¤æ˜“è´¹é˜ˆå€¼ $u_i$(å…ƒ) |
|------------|------------------|------------------|--------------------|-----------------------|
| $S_1$      | 28               | 2.5              | 1                  | 103                   |
| $S_2$      | 21               | 1.5              | 2                  | 198                   |
| $S_3$      | 23               | 5.5              | 4.5                | 52                    |
| $S_4$      | 25               | 2.6              | 6.5                | 40                    |

**æŠ•èµ„ç›®æ ‡** 
ç”¨ç»™å®šèµ„é‡‘ $M$ï¼Œæœ‰é€‰æ‹©åœ°è´­ä¹°è‹¥å¹²ç§èµ„äº§æˆ–å­˜é“¶è¡Œç”Ÿæ¯ï¼ˆæ— é£é™©åˆ©ç‡ $r_0=5\%$ï¼‰ï¼Œè¦æ±‚ï¼š

1. å‡€æ”¶ç›Šå°½å¯èƒ½å¤§
2. æ€»ä½“é£é™©ï¼ˆå®šä¹‰ä¸ºæ‰€æŠ•èµ„èµ„äº§ä¸­æœ€å¤§å•ä¸ªé£é™©ï¼‰å°½å¯èƒ½å°

### è§£ç­”

#### ç¬¦å·è§„å®š

| ç¬¦å· | è¯´æ˜ |
|------|------|
| $s_i$ | ç¬¬ $i$ ç§æŠ•èµ„é¡¹ç›®ï¼ˆ$i = 0,1,\ldots,n$ï¼‰ï¼Œå…¶ä¸­ $s_0$ è¡¨ç¤ºå­˜å…¥é“¶è¡Œ |
| $r_i$ | $s_i$ çš„å¹³å‡æ”¶ç›Šç‡ï¼ˆ$i = 0,\ldots,n$ï¼‰ |
| $p_i$ | $s_i$ çš„äº¤æ˜“è´¹ç‡ï¼ˆ$i = 0,\ldots,n$ï¼‰ï¼Œå…¶ä¸­ $p_0 = 0$ |
| $q_i$ | $s_i$ çš„é£é™©æŸå¤±ç‡ï¼ˆ$i = 0,\ldots,n$ï¼‰ï¼Œå…¶ä¸­ $q_0 = 0$ |
| $u_i$ | $s_i$ çš„äº¤æ˜“å®šé¢ï¼ˆ$i = 1,\ldots,n$ï¼‰ |
| $x_i$ | æŠ•èµ„é¡¹ç›® $s_i$ çš„èµ„é‡‘ï¼ˆ$i = 0,1,\ldots,n$ï¼‰ |
| $a$   | æŠ•èµ„é£é™©åº¦ |
| $Q$   | æ€»ä½“æ”¶ç›Š |

#### åŸºæœ¬å‡è®¾

* æŠ•èµ„è§„æ¨¡
   æŠ•èµ„æ•°é¢ $M$ ç›¸å½“å¤§ï¼Œä¸ºä¾¿äºè®¡ç®—ï¼Œè®¾ $M = 1$ï¼ˆå•ä½åŒ–å¤„ç†ï¼‰

* é£é™©åˆ†æ•£æ€§
   æŠ•èµ„è¶Šåˆ†æ•£ï¼Œæ€»é£é™©è¶Šå°

* é£é™©åº¦é‡
   æ€»ä½“é£é™©å®šä¹‰ä¸ºæ‰€æœ‰æŠ•èµ„é¡¹ç›® $s_i$ ä¸­æœ€å¤§çš„å•ä¸ªé£é™©ï¼Œå³ $\max(q_i x_i)$ï¼Œå…¶ä¸­ $x_i$ ä¸ºæŠ•èµ„æ¯”ä¾‹

* èµ„äº§ç‹¬ç«‹æ€§
   $n + 1$ ç§èµ„äº§ $s_i$ï¼ˆå«é“¶è¡Œå­˜æ¬¾ï¼‰ä¹‹é—´ç›¸äº’ç‹¬ç«‹

* å‚æ•°ç¨³å®šæ€§
   åœ¨æŠ•èµ„æœŸå†…ï¼Œå„èµ„äº§çš„å‚æ•°ä¸ºå®šå€¼ï¼Œä¸å—å…¶ä»–æ„å¤–å› ç´ å½±å“ï¼š 
   - æ”¶ç›Šç‡ $r_i$ 
   - äº¤æ˜“è´¹ç‡ $p_i$ 
   - é£é™©æŸå¤±ç‡ $q_i$ 

* æ”¶ç›Šä¸é£é™©çš„å†³å®šæ€§
   å‡€æ”¶ç›Šå’Œæ€»ä½“é£é™©ä»…ç”± $r_i, p_i, q_i$ å†³å®šï¼Œä¸å—å…¶ä»–å› ç´ å¹²æ‰°

#### æ¨¡å‹å…³é”®å®šä¹‰

* æ€»ä½“é£é™©åº¦é‡
   æ€»ä½“é£é™©å®šä¹‰ä¸ºæ‰€æŠ•èµ„èµ„äº§ä¸­æœ€å¤§å•é¡¹é£é™©ï¼š
   $$\max \{ q_i x_i \mid i = 1, 2, \ldots, n \}.$$

* äº¤æ˜“è´¹åˆ†æ®µå‡½æ•°
   è´­ä¹°èµ„äº§ $s_i$ ($i = 1, \ldots, n$) çš„äº¤æ˜“è´¹è®¡ç®—è§„åˆ™ï¼š 
   $$
   \text{äº¤æ˜“è´¹} = 
   \begin{cases} 
   p_i x_i, & x_i > u_i; \\ 
   p_i u_i, & x_i \leq u_i.
   \end{cases}
   $$
   > ç®€åŒ–å‡è®¾ï¼šç”±äº $u_i$ å’Œ $p_i u_i$ ç›¸å¯¹æ€»æŠ•èµ„ $M$ æå°ï¼Œå‡€æ”¶ç›Šå¯è¿‘ä¼¼ä¸º $(r_i - p_i)x_i$

* å¤šç›®æ ‡è§„åˆ’æ€§è´¨
   ç›®æ ‡å‡½æ•°éœ€åŒæ—¶æ»¡è¶³ï¼š 

   - å‡€æ”¶ç›Š $(r_i - p_i)x_i$ æœ€å¤§åŒ– 
   - æ€»ä½“é£é™© $\max(q_i x_i)$ æœ€å°åŒ– 
     ï¼ˆéœ€é€šè¿‡å¤šç›®æ ‡ä¼˜åŒ–æ–¹æ³•æ±‚è§£ï¼‰
     

**æ€»ç»“ä¸€ä¸‹ï¼š**
$$
\text{ç›®æ ‡å‡½æ•°}
\begin{cases} 
\max \sum\limits_{i=0}^n (r_i - p_i)x_i & \text{(æœ€å¤§åŒ–å‡€æ”¶ç›Š)} \\ 
\min \max \{q_i x_i\} & \text{(æœ€å°åŒ–æœ€å¤§å•é¡¹é£é™©)}
\end{cases}
$$

$$
\text{çº¦æŸæ¡ä»¶}
\begin{cases} 
\sum\limits_{i=0}^n (1 + p_i)x_i = M & \text{(æ€»èµ„é‡‘çº¦æŸ)} \\ 
x_i \geq 0, & i = 0,1,\cdots,n
\end{cases}
$$

#### å¤šç›®æ ‡è½¬å•ç›®æ ‡

**æ¨¡å‹ä¸€ï¼š** å›ºå®šé£é™©æ°´å¹³ä¸‹çš„æ”¶ç›Šä¼˜åŒ–æ¨¡å‹

é€šè¿‡å¼•å…¥é£é™©æ‰¿å—ç•Œé™ $a$ï¼Œå°†å¤šç›®æ ‡è§„åˆ’è½¬åŒ–ä¸º**å•ç›®æ ‡çº¿æ€§è§„åˆ’**ï¼š
- é™å®šæœ€å¤§é£é™©ï¼š$\max \frac{q_i x_i}{M} \leq a$
- å•ä¸€ä¼˜åŒ–ç›®æ ‡ï¼šæœ€å¤§åŒ–å‡€æ”¶ç›Š

**ç›®æ ‡å‡½æ•°** 
$$
\max \sum_{i=0}^n (r_i - p_i)x_i
$$

**çº¦æŸæ¡ä»¶** 
$$
\begin{cases}
\frac{q_i x_i}{M} \leq a, & i=1,\ldots,n \quad \text{(å•é¡¹é£é™©æ§åˆ¶)} \\
\sum\limits_{i=0}^n (1 + p_i)x_i = M, & \text{(èµ„é‡‘æ€»é‡çº¦æŸ)} \\
x_i \geq 0, & i=0,1,\ldots,n \quad \text{(éè´ŸæŠ•èµ„)}
\end{cases}
$$

***

**æ¨¡å‹äºŒï¼š** å›ºå®šæ”¶ç›Šä¸‹çš„é£é™©æœ€å°åŒ–

**ç›®æ ‡å‡½æ•°** 
$$
\min \{\max \{ q_i x_i \}\}
$$

**çº¦æŸæ¡ä»¶** 
$$
\begin{cases}
\sum\limits_{i=0}^n (r_i - p_i)x_i \geq k & \text{(æœ€ä½æ”¶ç›Šè¦æ±‚)} \\
\sum\limits_{i=0}^n (1 + p_i)x_i = M & \text{(èµ„é‡‘æ€»é‡çº¦æŸ)} \\
x_i \geq 0, & i=0,1,\ldots,n
\end{cases}
$$

***

**æ¨¡å‹ä¸‰ï¼š** é£é™©-æ”¶ç›ŠåŠ æƒä¼˜åŒ–

æŠ•èµ„è€…åœ¨æƒè¡¡èµ„äº§é£é™©å’Œé¢„æœŸæ”¶ç›Šä¸¤æ–¹é¢æ—¶ï¼Œå¸Œæœ›é€‰æ‹©ä¸€ä¸ªä»¤è‡ªå·±æ»¡æ„çš„æŠ•èµ„ç»„åˆã€‚å› æ­¤å¯¹é£é™©ã€æ”¶ç›Šåˆ†åˆ«èµ‹äºˆæƒé‡ $s$ï¼ˆ$0 < s \leq 1$ï¼‰å’Œ $(1-s)$ï¼Œ$s$ç§°ä¸ºæŠ•èµ„åå¥½ç³»æ•°

**ç›®æ ‡å‡½æ•°** 
$$
\min \left[ s \cdot \max \{ q_i x_i \} - (1-s) \sum\limits_{i=0}^n (r_i - p_i)x_i \right]
$$

**çº¦æŸæ¡ä»¶** 
$$
\begin{cases}
\sum\limits_{i=0}^n (1 + p_i)x_i = M \\
x_i \geq 0, & i=0,1,\ldots,n
\end{cases}
$$

## æ•´æ•°è§„åˆ’ï¼ˆILPï¼‰

### æ•´æ•°è§„åˆ’ç‰¹ç‚¹

åŸçº¿æ€§è§„åˆ’æœ‰æœ€ä¼˜è§£ï¼Œå½“è‡ªå˜é‡é™åˆ¶ä¸ºæ•´æ•°åï¼Œå…¶æ•´æ•°è§„åˆ’è§£å‡ºç°ä¸‹è¿°æƒ…å†µ

1. åŸçº¿æ€§è§„åˆ’æœ€ä¼˜è§£å…¨æ˜¯æ•´æ•°ï¼Œåˆ™æ•´æ•°è§„åˆ’æœ€ä¼˜è§£ä¸çº¿æ€§è§„åˆ’æœ€ä¼˜è§£ä¸€è‡´
2. æ•´æ•°è§„åˆ’æ— å¯è¡Œè§£
3. æœ‰å¯è¡Œè§£ï¼ˆå½“ç„¶å°±å­˜åœ¨æœ€ä¼˜è§£ï¼‰ï¼Œä½†æœ€ä¼˜è§£å€¼å˜å·®

> æ•´æ•°è§„åˆ’æœ€ä¼˜è§£ä¸èƒ½æŒ‰ç…§å®æ•°æœ€ä¼˜è§£ç®€å•å–æ•´è€Œè·å¾—ï¼Œå¯èƒ½ä¼šè¶…å‡ºå¯è¡ŒåŸŸ

**æ•´æ•°è§„åˆ’åˆ†ç±»:**

* çº¯æ•´æ•°è§„åˆ’ï¼šæ‰€æœ‰å†³ç­–å˜é‡è¦æ±‚å–éè´Ÿæ•´æ•°ï¼ˆè¿™æ—¶å¼•è¿›çš„æ¾å¼›å˜é‡å’Œå‰©ä½™å˜é‡å¯ä»¥ä¸è¦æ±‚å–æ•´æ•°ï¼‰
* å…¨æ•´æ•°è§„åˆ’ï¼šé™¤äº†æ‰€æœ‰å†³ç­–å˜é‡è¦æ±‚å–éè´Ÿæ•´æ•°å¤–ï¼Œç³»æ•°$a_{ij}$å’Œå¸¸æ•°$b_i$ä¹Ÿè¦æ±‚å–æ•´æ•°ï¼ˆè¿™æ—¶å¼•è¿›çš„æ¾å¼›å˜é‡å’Œå‰©ä½™å˜é‡ä¹Ÿå¿…é¡»æ˜¯æ•´æ•°ï¼‰
* æ··åˆæ•´æ•°è§„åˆ’ï¼šåªæœ‰ä¸€éƒ¨åˆ†çš„å†³ç­–å˜é‡è¦æ±‚å–éè´Ÿæ•´æ•°ï¼Œå¦ä¸€éƒ¨åˆ†å¯ä»¥å–éè´Ÿå®æ•°
* 0â€”1æ•´æ•°è§„åˆ’ï¼šæ‰€æœ‰å†³ç­–å˜é‡åªèƒ½å–0æˆ–1ä¸¤ä¸ªæ•´æ•°

> **æ¾å¼›å˜é‡:** $x_1 + x_2 \geq 10$ å¼•å…¥ $x_3$ â†’ $x_1 + x_2 + x_3 = 10$ï¼Œ$x_3 \geq 0$
> **å‰©ä½™å˜é‡:** $x_1 + x_2 \geq 10$ å¼•å…¥ $x_3$ â†’ $x_1 + x_2 - x_3 = 10$ï¼Œ$x_3 \leq 0$
> æ¾å¼›å˜é‡å’Œå‰©ä½™å˜é‡çš„ç›®çš„æ˜¯å°†**ä¸ç­‰å¼çº¦æŸ**è½¬åŒ–ä¸º**ç­‰å¼çº¦æŸ**

æ•´æ•°è§„åˆ’ä¸æ¾å¼›çš„çº¿æ€§è§„åˆ’çš„å…³ç³»ï¼š

* æ•´æ•°è§„åˆ’å¯è¡Œè§£æ˜¯æ¾å¼›é—®é¢˜å¯è¡ŒåŸŸä¸­çš„æ•´æ•°æ ¼ç‚¹æ¾å¼›é—®é¢˜æ— å¯è¡Œè§£ï¼Œåˆ™æ•´æ•°è§„åˆ’æ— å¯è¡Œè§£
* ILPæœ€ä¼˜å€¼å°äºæˆ–ç­‰äºæ¾å¼›é—®é¢˜çš„æœ€ä¼˜å€¼
* æ¾å¼›é—®é¢˜æœ€ä¼˜è§£æ»¡è¶³æ•´æ•°è¦æ±‚ï¼Œåˆ™è¯¥æœ€ä¼˜è§£ä¸ºæ•´æ•°è§„åˆ’æœ€ä¼˜è§£


### ä¸€èˆ¬å½¢å¼

$$
\max(\min) \, z = \sum_{j=1}^n c_j x_j
$$

$$
\begin{cases} 
\sum_{j=1}^n a_{ij} x_j \leq (=, \geq) b_i & (i = 1, 2, \ldots m) \\ 
x_j \geq 0, & x_j \text{ä¸ºæ•´æ•°} \, (j = 1, 2, \ldots n)
\end{cases}
$$

### åˆ†æ”¯å®šç•Œç®—æ³• (Deprecated)

1. ä¸è€ƒè™‘æ•´æ•°é™åˆ¶å…ˆæ±‚å‡ºç›¸åº”æ¾å¼›é—®é¢˜çš„æœ€ä¼˜è§£

è‹¥ä¸æ»¡è¶³æ•´æ•°æ¡ä»¶ï¼Œåˆ™ä»»é€‰ä¸€ä¸ªä¸æ»¡è¶³æ•´æ•°æ¡ä»¶çš„å˜é‡ $x_i^0$ æ¥æ„é€ æ–°çš„çº¦æŸæ·»åŠ åˆ°æ¾å¼›é—®é¢˜ä¸­å½¢æˆä¸¤ä¸ªå­é—®é¢˜ï¼š

$$
x_i \leq \left\lfloor x_i^0 \right\rfloor
$$
$$
x_i \geq \left\lfloor x_i^0 \right\rfloor + 1
$$

2. ç¼©å°çš„å¯è¡ŒåŸŸä¸­æ±‚è§£æ–°æ„é€ çš„çº¿æ€§è§„åˆ’çš„æœ€ä¼˜è§£ï¼Œå¹¶é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å­é—®é¢˜æ— è§£æˆ–æœ‰æ•´æ•°æœ€ä¼˜è§£ï¼ˆè¢«æŸ¥æ¸…ï¼‰

**ç¤ºä¾‹:**

$$
\max z = 3x_1 + 2x_2
$$

$$
\begin{cases} 
2x_1 + 3x_2 \leq 14 \\
2x_1 + x_2 \leq 9 \\ 
x_1, x_2 \geq 0 
\end{cases}
$$

```python
import numpy as np
from scipy.optimize import linprog
import matplotlib.pyplot as plt
from collections import deque


class BranchAndBoundSolver:
    """åˆ†æ”¯å®šç•Œæ³•æ±‚è§£å™¨ç±»"""

    def __init__(self):
        """åˆå§‹åŒ–æ±‚è§£å™¨"""
        self.best_solution = None  # æœ€ä¼˜è§£
        self.best_value = float('-inf')  # æœ€ä¼˜ç›®æ ‡å‡½æ•°å€¼
        self.nodes_explored = 0  # å·²æ¢ç´¢èŠ‚ç‚¹æ•°

    def solve_lp_relaxation(self, c, A_ub, b_ub, bounds):
        """
        æ±‚è§£çº¿æ€§è§„åˆ’æ¾å¼›é—®é¢˜
        å‚æ•°:
            c: ç›®æ ‡å‡½æ•°ç³»æ•°
            A_ub: ä¸ç­‰å¼çº¦æŸç³»æ•°çŸ©é˜µ
            b_ub: ä¸ç­‰å¼çº¦æŸå³ç«¯å‘é‡
            bounds: å˜é‡è¾¹ç•Œ
        è¿”å›:
            ç›®æ ‡å‡½æ•°å€¼, è§£å‘é‡
        """
        # scipyæ±‚æœ€å°å€¼ï¼Œç›®æ ‡å‡½æ•°ç³»æ•°å–è´Ÿæ•°è½¬æ¢ä¸ºæœ€å¤§å€¼é—®é¢˜
        result = linprog(-c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs')

        if result.success:
            return -result.fun, result.x  # è¿”å›æœ€å¤§å€¼å’Œè§£
        else:
            return None, None

    def is_integer_solution(self, x, tolerance=1e-6):
        """æ£€æŸ¥è§£æ˜¯å¦ä¸ºæ•´æ•°è§£"""
        return all(abs(xi - round(xi)) < tolerance for xi in x)

    def find_fractional_variable(self, x, tolerance=1e-6):
        """æ‰¾åˆ°ç¬¬ä¸€ä¸ªéæ•´æ•°å˜é‡çš„ç´¢å¼•"""
        for i, xi in enumerate(x):
            if abs(xi - round(xi)) >= tolerance:
                return i
        return None

    def solve(self, c, A_ub, b_ub, initial_bounds):
        """
        ä¸»æ±‚è§£å‡½æ•° - åˆ†æ”¯å®šç•Œæ³•
        å‚æ•°:
            c: ç›®æ ‡å‡½æ•°ç³»æ•°
            A_ub: çº¦æŸçŸ©é˜µ
            b_ub: çº¦æŸå³ç«¯å‘é‡
            initial_bounds: åˆå§‹å˜é‡è¾¹ç•Œ
        """
        # ç”¨é˜Ÿåˆ—å­˜å‚¨å¾…å¤„ç†çš„èŠ‚ç‚¹ (è¾¹ç•Œ, æ·±åº¦)
        queue = deque([(initial_bounds, 0)])

        print("å¼€å§‹åˆ†æ”¯å®šç•Œæ³•æ±‚è§£...")
        print("=" * 50)

        while queue:
            current_bounds, depth = queue.popleft()
            self.nodes_explored += 1

            print(f"\nèŠ‚ç‚¹ {self.nodes_explored}:")
            print(f"è¾¹ç•Œ: x1âˆˆ{current_bounds[0]}, x2âˆˆ{current_bounds[1]}")

            # æ±‚è§£å½“å‰èŠ‚ç‚¹çš„LPæ¾å¼›
            obj_value, solution = self.solve_lp_relaxation(c, A_ub, b_ub, current_bounds)

            if obj_value is None:
                print("  æ— å¯è¡Œè§£")
                continue

            print(f"  LPè§£: x1={solution[0]:.3f}, x2={solution[1]:.3f}, z={obj_value:.3f}")

            # å‰ªæï¼šå¦‚æœä¸Šç•Œä¸èƒ½æ”¹è¿›å½“å‰æœ€ä¼˜è§£
            if obj_value <= self.best_value:
                print(f"  å‰ªæ: {obj_value:.3f} â‰¤ {self.best_value}")
                continue

            # æ£€æŸ¥æ˜¯å¦ä¸ºæ•´æ•°è§£
            if self.is_integer_solution(solution):
                print("  *** æ‰¾åˆ°æ•´æ•°è§£! ***")
                if obj_value > self.best_value:
                    self.best_value = obj_value
                    self.best_solution = solution.copy()
                    print(f"  *** æ›´æ–°æœ€ä¼˜è§£: z={obj_value} ***")
                continue

            # åˆ†æ”¯ï¼šé€‰æ‹©ç¬¬ä¸€ä¸ªéæ•´æ•°å˜é‡
            branch_var = self.find_fractional_variable(solution)
            if branch_var is not None:
                branch_value = solution[branch_var]
                print(f"  åˆ†æ”¯å˜é‡: x{branch_var + 1}={branch_value:.3f}")

                # åˆ›å»ºå·¦å³ä¸¤ä¸ªå­é—®é¢˜
                left_bounds = [list(bound) if isinstance(bound, tuple) else bound for bound in current_bounds]
                right_bounds = [list(bound) if isinstance(bound, tuple) else bound for bound in current_bounds]

                # å·¦åˆ†æ”¯: x[branch_var] <= floor(branch_value)
                left_bounds[branch_var] = (left_bounds[branch_var][0], int(branch_value))
                # å³åˆ†æ”¯: x[branch_var] >= ceil(branch_value)
                right_bounds[branch_var] = (int(branch_value) + 1, right_bounds[branch_var][1])

                # æ·»åŠ å­é—®é¢˜åˆ°é˜Ÿåˆ—
                queue.append((left_bounds, depth + 1))
                queue.append((right_bounds, depth + 1))

        # è¾“å‡ºæœ€ç»ˆç»“æœ
        print("\n" + "=" * 50)
        print("æ±‚è§£å®Œæˆ!")
        print(f"æ¢ç´¢èŠ‚ç‚¹æ•°: {self.nodes_explored}")

        if self.best_solution is not None:
            print(f"æœ€ä¼˜è§£: x1={int(self.best_solution[0])}, x2={int(self.best_solution[1])}")
            print(f"æœ€ä¼˜å€¼: z={self.best_value}")
        else:
            print("æœªæ‰¾åˆ°å¯è¡Œè§£")

    def visualize_problem(self, c, A_ub, b_ub):
        """
        å¯è§†åŒ–é—®é¢˜çš„å¯è¡ŒåŸŸå’Œè§£
        å‚æ•°:
            c: ç›®æ ‡å‡½æ•°ç³»æ•°
            A_ub: çº¦æŸçŸ©é˜µ
            b_ub: çº¦æŸå³ç«¯å‘é‡
        """
        # åˆ›å»ºå›¾å½¢
        plt.figure(figsize=(10, 8))

        # å®šä¹‰x1çš„èŒƒå›´
        x1 = np.linspace(0, 6, 100)

        # ç»˜åˆ¶çº¦æŸçº¿
        # çº¦æŸ1: 2x1 + 3x2 <= 14
        x2_1 = (14 - 2 * x1) / 3
        plt.plot(x1, x2_1, 'b-', label='2xâ‚ + 3xâ‚‚ â‰¤ 14', linewidth=2)

        # çº¦æŸ2: 2x1 + x2 <= 9
        x2_2 = 9 - 2 * x1
        plt.plot(x1, x2_2, 'r-', label='2xâ‚ + xâ‚‚ â‰¤ 9', linewidth=2)

        # å¡«å……å¯è¡ŒåŸŸ
        x1_fill = np.linspace(0, 4.5, 100)
        x2_fill1 = np.minimum((14 - 2 * x1_fill) / 3, 9 - 2 * x1_fill)
        x2_fill2 = np.zeros_like(x1_fill)
        plt.fill_between(x1_fill, x2_fill2, np.maximum(x2_fill1, 0),
                         alpha=0.3, color='lightblue', label='Feasible Region')

        # ç»˜åˆ¶ç›®æ ‡å‡½æ•°ç­‰å€¼çº¿
        X1, X2 = np.meshgrid(np.linspace(0, 6, 50), np.linspace(0, 6, 50))
        Z = 3 * X1 + 2 * X2
        contours = plt.contour(X1, X2, Z, levels=8, colors='green', alpha=0.6)
        plt.clabel(contours, inline=True, fontsize=8)

        # æ ‡è®°æ‰€æœ‰æ•´æ•°ç‚¹
        for i in range(6):
            for j in range(6):
                if 2 * i + 3 * j <= 14 and 2 * i + j <= 9 and i >= 0 and j >= 0:
                    plt.plot(i, j, 'ko', markersize=6)

        # æ ‡è®°æœ€ä¼˜è§£
        if self.best_solution is not None:
            x1_opt, x2_opt = int(self.best_solution[0]), int(self.best_solution[1])
            plt.plot(x1_opt, x2_opt, 'ro', markersize=12,
                     label=f'Optimal Solution ({x1_opt}, {x2_opt})')

        # è®¾ç½®å›¾å½¢å±æ€§
        plt.xlim(0, 6)
        plt.ylim(0, 6)
        plt.xlabel('xâ‚')
        plt.ylabel('xâ‚‚')
        plt.title('Integer Linear Programming Problem\nmax z = 3xâ‚ + 2xâ‚‚')
        plt.legend()
        plt.grid(True, alpha=0.3)
        plt.show()


def main():
    """ä¸»å‡½æ•° - å®šä¹‰é—®é¢˜å¹¶æ±‚è§£"""

    # 1. å®šä¹‰é—®é¢˜å‚æ•°
    print("çº¿æ€§æ•´æ•°è§„åˆ’é—®é¢˜:")
    print("ç›®æ ‡å‡½æ•°: max z = 3xâ‚ + 2xâ‚‚")
    print("çº¦æŸæ¡ä»¶:")
    print("  2xâ‚ + 3xâ‚‚ â‰¤ 14")
    print("  2xâ‚ + xâ‚‚ â‰¤ 9")
    print("  xâ‚, xâ‚‚ â‰¥ 0 ä¸”ä¸ºæ•´æ•°")

    # ç›®æ ‡å‡½æ•°ç³»æ•°
    c = np.array([3, 2])

    # çº¦æŸçŸ©é˜µå’Œå³ç«¯å‘é‡
    A_ub = np.array([
        [2, 3],  # ç¬¬ä¸€ä¸ªçº¦æŸ: 2xâ‚ + 3xâ‚‚ â‰¤ 14
        [2, 1]  # ç¬¬äºŒä¸ªçº¦æŸ: 2xâ‚ + xâ‚‚ â‰¤ 9
    ])
    b_ub = np.array([14, 9])

    # å˜é‡è¾¹ç•Œ (ä¸‹ç•Œ, ä¸Šç•Œ)
    initial_bounds = [(0, 10), (0, 10)]

    # 2. åˆ›å»ºæ±‚è§£å™¨å¹¶æ±‚è§£
    solver = BranchAndBoundSolver()
    solver.solve(c, A_ub, b_ub, initial_bounds)

    # 3. å¯è§†åŒ–ç»“æœ
    solver.visualize_problem(c, A_ub, b_ub)

    # 4. éªŒè¯è§£çš„æ­£ç¡®æ€§
    if solver.best_solution is not None:
        x1, x2 = int(solver.best_solution[0]), int(solver.best_solution[1])
        print(f"\nè§£çš„éªŒè¯:")

        # æ£€æŸ¥çº¦æŸæ¡ä»¶
        constraint1 = 2 * x1 + 3 * x2
        constraint2 = 2 * x1 + x2
        objective = 3 * x1 + 2 * x2

        print(f"çº¦æŸ1: 2Ã—{x1} + 3Ã—{x2} = {constraint1} â‰¤ 14 âœ“" if constraint1 <= 14 else "çº¦æŸ1è¿å!")
        print(f"çº¦æŸ2: 2Ã—{x1} + 1Ã—{x2} = {constraint2} â‰¤ 9 âœ“" if constraint2 <= 9 else "çº¦æŸ2è¿å!")
        print(f"ç›®æ ‡å‡½æ•°: 3Ã—{x1} + 2Ã—{x2} = {objective}")

        # 5. ä¸LPæ¾å¼›è§£æ¯”è¾ƒ
        print(f"\nä¸LPæ¾å¼›è§£çš„æ¯”è¾ƒ:")
        result = linprog(-c, A_ub=A_ub, b_ub=b_ub, bounds=[(0, None), (0, None)], method='highs')
        if result.success:
            lp_solution = result.x
            lp_value = -result.fun
            print(f"LPæ¾å¼›è§£: xâ‚={lp_solution[0]:.3f}, xâ‚‚={lp_solution[1]:.3f}")
            print(f"LPæ¾å¼›å€¼: z={lp_value:.3f}")
            print(f"æ•´æ•°è§£å€¼: z={objective}")
            print(f"æœ€ä¼˜æ€§é—´éš™: {lp_value - objective:.3f}")


if __name__ == "__main__":
    main()
```

è¾“å‡ºï¼š
```
çº¿æ€§æ•´æ•°è§„åˆ’é—®é¢˜:
ç›®æ ‡å‡½æ•°: max z = 3xâ‚ + 2xâ‚‚
çº¦æŸæ¡ä»¶:
  2xâ‚ + 3xâ‚‚ â‰¤ 14
  2xâ‚ + xâ‚‚ â‰¤ 9
  xâ‚, xâ‚‚ â‰¥ 0 ä¸”ä¸ºæ•´æ•°
å¼€å§‹åˆ†æ”¯å®šç•Œæ³•æ±‚è§£...
==================================================

èŠ‚ç‚¹ 1:
è¾¹ç•Œ: x1âˆˆ(0, 10), x2âˆˆ(0, 10)
  LPè§£: x1=3.250, x2=2.500, z=14.750
  åˆ†æ”¯å˜é‡: x1=3.250

èŠ‚ç‚¹ 2:
è¾¹ç•Œ: x1âˆˆ(0, 3), x2âˆˆ[0, 10]
  LPè§£: x1=3.000, x2=2.667, z=14.333
  åˆ†æ”¯å˜é‡: x2=2.667

èŠ‚ç‚¹ 3:
è¾¹ç•Œ: x1âˆˆ(4, 10), x2âˆˆ[0, 10]
  LPè§£: x1=4.000, x2=1.000, z=14.000
  *** æ‰¾åˆ°æ•´æ•°è§£! ***
  *** æ›´æ–°æœ€ä¼˜è§£: z=14.0 ***

èŠ‚ç‚¹ 4:
è¾¹ç•Œ: x1âˆˆ[0, 3], x2âˆˆ(0, 2)
  LPè§£: x1=3.000, x2=2.000, z=13.000
  å‰ªæ: 13.000 â‰¤ 14.0

èŠ‚ç‚¹ 5:
è¾¹ç•Œ: x1âˆˆ[0, 3], x2âˆˆ(3, 10)
  LPè§£: x1=2.500, x2=3.000, z=13.500
  å‰ªæ: 13.500 â‰¤ 14.0

==================================================
æ±‚è§£å®Œæˆ!
æ¢ç´¢èŠ‚ç‚¹æ•°: 5
æœ€ä¼˜è§£: x1=4, x2=1
æœ€ä¼˜å€¼: z=14.0

è§£çš„éªŒè¯:
çº¦æŸ1: 2Ã—4 + 3Ã—1 = 11 â‰¤ 14 âœ“
çº¦æŸ2: 2Ã—4 + 1Ã—1 = 9 â‰¤ 9 âœ“
ç›®æ ‡å‡½æ•°: 3Ã—4 + 2Ã—1 = 14

ä¸LPæ¾å¼›è§£çš„æ¯”è¾ƒ:
LPæ¾å¼›è§£: xâ‚=3.250, xâ‚‚=2.500
LPæ¾å¼›å€¼: z=14.750
æ•´æ•°è§£å€¼: z=14
æœ€ä¼˜æ€§é—´éš™: 0.750
```

![](https://cdn.giraffish.me/blog/25-06-16-1750045145904.webp)

### PuLPåº“

PuLPæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Pythonåº“ï¼Œä¸“é—¨ç”¨äºè§£å†³çº¿æ€§è§„åˆ’ã€æ•´æ•°è§„åˆ’å’Œæ··åˆæ•´æ•°è§„åˆ’é—®é¢˜

**ç¤ºä¾‹:**
```python
import pulp


def solve_integer_programming_with_pulp():
    """
    ä½¿ç”¨PuLPæ±‚è§£æ•´æ•°çº¿æ€§è§„åˆ’é—®é¢˜

    é—®é¢˜æè¿°:
    æœ€å¤§åŒ–: z = 3xâ‚ + 2xâ‚‚
    çº¦æŸæ¡ä»¶:
        2xâ‚ + 3xâ‚‚ â‰¤ 14
        2xâ‚ + xâ‚‚ â‰¤ 9
        xâ‚, xâ‚‚ â‰¥ 0 ä¸”ä¸ºæ•´æ•°
    """

    # æ­¥éª¤1: åˆ›å»ºé—®é¢˜å®ä¾‹
    prob = pulp.LpProblem("Integer_Linear_Programming", pulp.LpMaximize)

    # æ­¥éª¤2: å®šä¹‰å†³ç­–å˜é‡ï¼ˆæ•´æ•°å˜é‡ï¼‰
    x1 = pulp.LpVariable("x1", lowBound=0, cat='Integer')
    x2 = pulp.LpVariable("x2", lowBound=0, cat='Integer')

    # æ­¥éª¤3: æ·»åŠ ç›®æ ‡å‡½æ•°
    prob += 3 * x1 + 2 * x2, "Objective_Function"

    # æ­¥éª¤4: æ·»åŠ çº¦æŸæ¡ä»¶
    prob += 2 * x1 + 3 * x2 <= 14, "Material_Constraint"
    prob += 2 * x1 + x2 <= 9, "Time_Constraint"

    # æ­¥éª¤5: æ±‚è§£é—®é¢˜
    print("Solving the problem...")
    prob.solve(pulp.PULP_CBC_CMD(msg=0))  # msg=0 éšè—æ±‚è§£å™¨è¯¦ç»†è¾“å‡º

    # æ­¥éª¤6: æ£€æŸ¥æ±‚è§£çŠ¶æ€
    print(f"Status: {pulp.LpStatus[prob.status]}")

    # æ­¥éª¤7: è¾“å‡ºç»“æœ
    if prob.status == pulp.LpStatusOptimal:
        print("\nOptimal Solution Found!")
        print(f"xâ‚ = {int(x1.varValue)}")
        print(f"xâ‚‚ = {int(x2.varValue)}")
        print(f"Maximum objective value z = {int(pulp.value(prob.objective))}")

        # éªŒè¯çº¦æŸæ¡ä»¶
        print("\nConstraint Verification:")
        x1_val = int(x1.varValue)
        x2_val = int(x2.varValue)

        constraint1_value = 2 * x1_val + 3 * x2_val
        constraint2_value = 2 * x1_val + x2_val

        print(f"Constraint 1: 2Ã—{x1_val} + 3Ã—{x2_val} = {constraint1_value} â‰¤ 14 âœ“")
        print(f"Constraint 2: 2Ã—{x1_val} + 1Ã—{x2_val} = {constraint2_value} â‰¤ 9 âœ“")

        return x1_val, x2_val, int(pulp.value(prob.objective))
    else:
        print("No optimal solution found!")
        return None

def main():
    solve_integer_programming_with_pulp()

if __name__ == "__main__":
    main()
```

## éçº¿æ€§è§„åˆ’ï¼ˆNPï¼‰

### ä¸€èˆ¬å½¢å¼

$$
\min f(x)
$$

$$
\begin{cases}
A \cdot x \leq b \\
Aeq \cdot x = beq \\
c(x) \leq 0 \\
ceq(x) = 0 \\
lb \leq x \leq ub
\end{cases}
$$


å…¶ä¸­ï¼š
- $f(x)$ æ˜¯æ ‡é‡ç›®æ ‡å‡½æ•°
- $A$, $b$, $Aeq$, $beq$ æ˜¯çº¿æ€§çº¦æŸçš„çŸ©é˜µå’Œå‘é‡
- $c(x)$, $ceq(x)$ æ˜¯éçº¿æ€§çº¦æŸå‡½æ•°
- $lb$, $ub$ æ˜¯å˜é‡çš„ä¸‹ç•Œå’Œä¸Šç•Œ

### Pyomoåº“

[Pyomo](https://pyomo.readthedocs.io/en/stable/)ä½œä¸ºä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Pythonä¼˜åŒ–å»ºæ¨¡è¯­è¨€ï¼Œèƒ½å¤Ÿå¤„ç†å¹¿æ³›çš„æ•°å­¦è§„åˆ’é—®é¢˜

å…·ä½“åŒ…æ‹¬ï¼š

**çº¿æ€§è§„åˆ’é—®é¢˜**

- æ ‡å‡†çº¿æ€§è§„åˆ’ï¼ˆLPï¼‰
- æ··åˆæ•´æ•°çº¿æ€§è§„åˆ’ï¼ˆMILPï¼‰

**éçº¿æ€§è§„åˆ’é—®é¢˜**

- éçº¿æ€§è§„åˆ’ï¼ˆNLPï¼‰
- æ··åˆæ•´æ•°éçº¿æ€§è§„åˆ’ï¼ˆMINLPï¼‰
- æ··åˆæ•´æ•°äºŒæ¬¡è§„åˆ’ï¼ˆMIQPï¼‰

**ç‰¹æ®Šé—®é¢˜ç±»å‹**

- äºŒæ¬¡è§„åˆ’ï¼ˆQPï¼‰
- éšæœºè§„åˆ’
- åŒå±‚è§„åˆ’é—®é¢˜
- å¹¿ä¹‰æå–è§„åˆ’
- å¸¦å¹³è¡¡çº¦æŸçš„æ•°å­¦è§„åˆ’
- å¾®åˆ†ä»£æ•°æ–¹ç¨‹ä¼˜åŒ–é—®é¢˜

**å®‰è£…:**

```cmd
pip install pyomo
conda install -c conda-forge ipopt
```

> Pyomoå’Œæ±‚è§£å™¨çš„å®‰è£…å»ºè®®ç”¨condaè€Œä¸æ˜¯æ™®é€šçš„è™šæ‹Ÿç¯å¢ƒï¼Œä¸ç„¶ä¼šé‡åˆ°å¥‡å¦™bugï¼ˆ

**ç¤ºä¾‹ä»£ç :**

> `unified_optimization.py`

```python
import pyomo.environ as pyo
import numpy as np
import matplotlib.pyplot as plt
from pyomo.opt import SolverStatus, TerminationCondition
import warnings

warnings.filterwarnings('ignore')

# English font setup for all plots
plt.rcParams['font.family'] = 'sans-serif'
plt.rcParams['axes.unicode_minus'] = False
plt.rcParams['font.size'] = 10


class OptimizationSolver:

    def __init__(self, name="Problem"):
        self.model = None
        self.solver = None
        self.results = None
        self.name = name
        self.problem_type = "LP"
        self.var_names = []
        self.var_types = []
        self.constraint_counter = 0
        self.has_integer_vars = False
        self.has_continuous_vars = False
        self.has_quadratic_terms = False
        self.has_nonlinear_terms = False

    def create_model(self, n_vars, var_names=None, var_types=None, lb=None, ub=None):
        """Create optimization model with mixed variable types"""
        self.model = pyo.ConcreteModel(self.name)
        self.model.I = pyo.RangeSet(1, n_vars)

        # Handle variable names
        if var_names is None:
            self.var_names = [f"x{i}" for i in range(1, n_vars + 1)]
        else:
            self.var_names = list(var_names[:n_vars])
            while len(self.var_names) < n_vars:
                self.var_names.append(f"x{len(self.var_names) + 1}")

        # Handle variable types
        if var_types is None:
            self.var_types = ['continuous'] * n_vars
        elif isinstance(var_types, str):
            self.var_types = [var_types] * n_vars
        else:
            self.var_types = list(var_types[:n_vars])
            while len(self.var_types) < n_vars:
                self.var_types.append('continuous')

        # Track variable types
        self.has_integer_vars = any(vtype in ['integer', 'binary'] for vtype in self.var_types)
        self.has_continuous_vars = any(vtype == 'continuous' for vtype in self.var_types)

        # Create variables with individual domains
        self.model.x = pyo.Var(self.model.I)

        for i, var_type in enumerate(self.var_types, 1):
            if var_type == 'continuous':
                self.model.x[i].domain = pyo.Reals
            elif var_type == 'integer':
                self.model.x[i].domain = pyo.Integers
            elif var_type == 'binary':
                self.model.x[i].domain = pyo.Binary
            else:
                self.model.x[i].domain = pyo.Reals

        # Set bounds with safety for nonlinear functions
        if lb is not None:
            if isinstance(lb, (int, float)):
                lb = [lb] * n_vars
            for i, lower in enumerate(lb, 1):
                if lower is not None and i <= n_vars:
                    # Safe bounds for sqrt and other nonlinear functions
                    safe_lower = max(lower, 1e-6) if lower >= 0 else lower
                    self.model.x[i].setlb(safe_lower)

        if ub is not None:
            if isinstance(ub, (int, float)):
                ub = [ub] * n_vars
            for i, upper in enumerate(ub, 1):
                if upper is not None and i <= n_vars:
                    self.model.x[i].setub(upper)

        return self

    def set_objective(self, objective_func, sense='minimize'):
        """Set objective function with type detection"""
        if sense.lower() in ['minimize', 'min']:
            self.model.obj = pyo.Objective(expr=objective_func(self.model), sense=pyo.minimize)
        else:
            self.model.obj = pyo.Objective(expr=objective_func(self.model), sense=pyo.maximize)

        self._detect_problem_type()
        return self

    def _detect_problem_type(self):
        """Detect problem type based on objective and variables"""
        self.has_quadratic_terms = False
        self.has_nonlinear_terms = False

        try:
            obj_str = str(self.model.obj.expr).lower()

            # Check for quadratic terms
            import re
            if (re.search(r'x\[\d+\]\*\*2', obj_str) or
                    re.search(r'x\[\d+\]\s*\*\s*x\[\d+\]', obj_str)):
                self.has_quadratic_terms = True

            # Check for nonlinear terms (sqrt, exp, log, higher powers)
            nonlinear_keywords = ['exp', 'log', 'sin', 'cos', 'sqrt']
            higher_powers = [f'**{i}' for i in range(3, 10)] + ['**0.5', '**1.5']

            if (any(keyword in obj_str for keyword in nonlinear_keywords) or
                    any(power in obj_str for power in higher_powers)):
                self.has_nonlinear_terms = True

        except:
            pass

        # Determine problem type
        if self.has_integer_vars and self.has_continuous_vars:
            # Mixed integer problem
            if self.has_nonlinear_terms:
                self.problem_type = "MINLP"
            elif self.has_quadratic_terms:
                self.problem_type = "MIQP"
            else:
                self.problem_type = "MILP"
        elif self.has_integer_vars:
            # Pure integer problem
            if self.has_nonlinear_terms:
                self.problem_type = "INLP"
            elif self.has_quadratic_terms:
                self.problem_type = "IQP"
            else:
                self.problem_type = "ILP"
        else:
            # Pure continuous problem
            if self.has_nonlinear_terms:
                self.problem_type = "NLP"
            elif self.has_quadratic_terms:
                self.problem_type = "QP"
            else:
                self.problem_type = "LP"

    def add_constraint(self, constraint_func, sense='<=', name=None):
        """Add single constraint"""
        self.constraint_counter += 1
        if name is None:
            name = f"constraint_{self.constraint_counter}"

        if sense == '<=':
            expr = constraint_func(self.model) <= 0
        elif sense == '>=':
            expr = constraint_func(self.model) >= 0
        else:  # '='
            expr = constraint_func(self.model) == 0

        setattr(self.model, name, pyo.Constraint(expr=expr))
        return self

    def add_linear_constraints(self, A, b, sense='<='):
        """Add multiple linear constraints"""
        A = np.array(A)
        b = np.array(b)

        if A.ndim == 1:
            A = A.reshape(1, -1)

        self.constraint_counter += 1
        constraint_name = f'linear_constraints_{self.constraint_counter}'

        if sense == '<=':
            def rule(model, i):
                return sum(A[i - 1, j - 1] * model.x[j] for j in model.I) <= b[i - 1]
        elif sense == '>=':
            def rule(model, i):
                return sum(A[i - 1, j - 1] * model.x[j] for j in model.I) >= b[i - 1]
        else:  # '='
            def rule(model, i):
                return sum(A[i - 1, j - 1] * model.x[j] for j in model.I) == b[i - 1]

        setattr(self.model, constraint_name,
                pyo.Constraint(pyo.RangeSet(1, len(b)), rule=rule))

        return self

    def solve(self, solver=None, options=None, verbose=False):
        """Solve optimization problem"""
        if self.model is None:
            print("âŒ No model created!")
            return False

        # Auto-select solver
        if solver is None:
            if self.problem_type in ["LP", "QP", "NLP"]:
                solver = "ipopt" if self.problem_type == "NLP" else "gurobi"
            else:
                solver = "gurobi" if pyo.SolverFactory('gurobi').available() else "ipopt"

        if not pyo.SolverFactory(solver).available():
            print(f"âŒ Solver {solver} not available!")
            return False

        # Create solver
        self.solver = pyo.SolverFactory(solver)

        # Set solver options
        if solver == 'ipopt':
            clean_options = {
                'print_level': 0,  # Silent IPOPT
                'max_iter': 3000,
                'tol': 1e-6,
                'linear_solver': 'mumps'
            }
            if options:
                clean_options.update(options)

            for key, value in clean_options.items():
                self.solver.options[key] = value
        elif options:
            for key, value in options.items():
                self.solver.options[key] = value

        # Set safe initial point for nonlinear problems
        if self.has_nonlinear_terms:
            try:
                for i in self.model.I:
                    if self.model.x[i].value is None:
                        lb = self.model.x[i].lb if self.model.x[i].lb is not None else 0
                        ub = self.model.x[i].ub if self.model.x[i].ub is not None else 10
                        initial_val = max((lb + ub) / 2, 0.1)
                        self.model.x[i].set_value(initial_val)
            except:
                pass

        # Solve
        try:
            self.results = self.solver.solve(self.model, tee=verbose)

            if (self.results.solver.status == SolverStatus.ok and
                    self.results.solver.termination_condition in [TerminationCondition.optimal,
                                                                  TerminationCondition.locallyOptimal,
                                                                  TerminationCondition.feasible]):
                return True
            else:
                return False

        except:
            return False

    def get_solution(self):
        """Get solution information"""
        if not self.results:
            return None

        try:
            solution = {
                'objective_value': pyo.value(self.model.obj),
                'variables': {},
                'variable_types': {},
                'problem_type': self.problem_type,
                'solver_status': str(self.results.solver.status),
                'termination_condition': str(self.results.solver.termination_condition),
                'has_mixed_variables': self.has_integer_vars and self.has_continuous_vars
            }

            for i in self.model.I:
                var_name = self.var_names[i - 1]
                var_type = self.var_types[i - 1]
                value = pyo.value(self.model.x[i])
                solution['variables'][var_name] = value if value is not None else 0.0
                solution['variable_types'][var_name] = var_type

            return solution
        except:
            return None

    def print_solution(self):
        solution = self.get_solution()
        if not solution:
            print("âŒ No solution available")
            return

        print(f"\nğŸ“Š {solution['problem_type']} SOLUTION")
        print("=" * 50)
        print(f"Objective Value: {solution['objective_value']:.6f}")

        # Show variable types for mixed problems
        if solution['has_mixed_variables']:
            print("Variable Types:")
            continuous_vars = [name for name, vtype in solution['variable_types'].items()
                               if vtype == 'continuous']
            integer_vars = [name for name, vtype in solution['variable_types'].items()
                            if vtype == 'integer']
            binary_vars = [name for name, vtype in solution['variable_types'].items()
                           if vtype == 'binary']

            if continuous_vars:
                print(f"  Continuous: {', '.join(continuous_vars)}")
            if integer_vars:
                print(f"  Integer: {', '.join(integer_vars)}")
            if binary_vars:
                print(f"  Binary: {', '.join(binary_vars)}")

        print("Variable Values:")
        for name, value in solution['variables'].items():
            var_type = solution['variable_types'][name]
            if var_type in ['integer', 'binary'] and abs(value - round(value)) < 1e-6:
                print(f"  {name} = {int(round(value))} ({var_type})")
            else:
                print(f"  {name} = {value:.6f} ({var_type})")

    def plot_solution_2d(self, x_range=None, y_range=None, title=None, figsize=(10, 7)):
        """Plot 2D solution with ALL ENGLISH LABELS"""
        solution = self.get_solution()
        if not solution or len(solution['variables']) != 2:
            print(
                f"âš ï¸ Cannot plot: Problem has {len(solution['variables']) if solution else 0} variables (need exactly 2 for 2D plot)")
            return

        if x_range is None:
            x_range = (0, 10)
        if y_range is None:
            y_range = (0, 10)
        if title is None:
            title = f"{self.name}"

        # Get solution point and variable types
        vars_list = list(solution['variables'].items())
        x_opt, y_opt = vars_list[0][1], vars_list[1][1]
        x_name, y_name = vars_list[0][0], vars_list[1][0]
        x_type = solution['variable_types'][x_name]
        y_type = solution['variable_types'][y_name]

        # Create plot with ALL ENGLISH LABELS
        fig, ax = plt.subplots(figsize=figsize)

        # Plot optimal point with markers based on variable types
        if x_type in ['integer', 'binary'] or y_type in ['integer', 'binary']:
            ax.plot(x_opt, y_opt, 'rs', markersize=14, zorder=5,
                    label=f'Optimal Solution\n({x_opt:.3f}, {y_opt:.3f})')
        else:
            ax.plot(x_opt, y_opt, 'ro', markersize=14, zorder=5,
                    label=f'Optimal Solution\n({x_opt:.3f}, {y_opt:.3f})')

        # Annotation with ENGLISH TEXT and variable types
        annotation_text = (f'Optimal Point\n'
                           f'{x_name}: {x_opt:.3f} ({x_type})\n'
                           f'{y_name}: {y_opt:.3f} ({y_type})\n'
                           f'Objective Value: {solution["objective_value"]:.3f}')

        ax.annotate(annotation_text,
                    xy=(x_opt, y_opt),
                    xytext=(x_opt + (x_range[1] - x_range[0]) * 0.15,
                            y_opt + (y_range[1] - y_range[0]) * 0.15),
                    arrowprops=dict(arrowstyle='->', color='red', lw=2),
                    bbox=dict(boxstyle="round,pad=0.5", facecolor="yellow", alpha=0.8),
                    fontsize=12, ha='left')

        # Set ALL ENGLISH AXIS LABELS
        ax.set_xlim(x_range)
        ax.set_ylim(y_range)
        ax.set_xlabel(f'{x_name} ({x_type})', fontsize=14, fontweight='bold')
        ax.set_ylabel(f'{y_name} ({y_type})', fontsize=14, fontweight='bold')
        ax.set_title(f'{title} ({solution["problem_type"]} Problem)',
                     fontsize=16, fontweight='bold')

        ax.grid(True, alpha=0.3)
        ax.legend(fontsize=12, loc='best')

        # Add variable information box in ENGLISH
        if solution['has_mixed_variables']:
            info_text = "Mixed Variable Types:\n"
            for name, vtype in solution['variable_types'].items():
                info_text += f"{name}: {vtype}\n"

            ax.text(0.02, 0.98, info_text.strip(), transform=ax.transAxes,
                    bbox=dict(boxstyle="round,pad=0.3", facecolor="lightblue", alpha=0.7),
                    fontsize=10, verticalalignment='top')

        # ENGLISH TIMESTAMP
        timestamp_text = f"Generated: 2025-06-20 10:58:07 UTC | User: giraffishh"
        fig.text(0.99, 0.01, timestamp_text, ha='right', va='bottom',
                 fontsize=9, alpha=0.6)

        plt.tight_layout()
        plt.show()
        print(f"âœ… Plot created for {solution['problem_type']} problem with ALL ENGLISH LABELS")


# Example 1: LP - x,y (continuous, continuous)
def example_linear_programming():
    """Example 1: Linear Programming - All continuous variables"""
    print("ğŸ¯Example 1: Linear Programming (LP)")
    print("Variables: x,y (continuous, continuous)")
    print("Maximize: 3x + 2y")
    print("Subject to: x + y â‰¤ 4, 2x + y â‰¤ 6, x,y â‰¥ 0")

    solver = OptimizationSolver("Linear_Programming")
    solver.create_model(n_vars=2, var_names=['x', 'y'],
                        var_types=['continuous', 'continuous'], lb=[0, 0])

    # Linear objective
    def objective(model):
        return 3 * model.x[1] + 2 * model.x[2]

    solver.set_objective(objective, 'maximize')
    solver.add_linear_constraints(A=[[1, 1], [2, 1]], b=[4, 6], sense='<=')

    if solver.solve():
        solver.print_solution()
        solver.plot_solution_2d(x_range=(0, 5), y_range=(0, 5), title="Linear Programming")
        return solver.get_solution()
    return None


# Example 2: MILP - x,y (continuous, integer)
def example_mixed_integer_programming():
    """Example 2: Mixed Integer Linear Programming - Mixed variables"""
    print("\nğŸ¯Example 2: Mixed Integer Linear Programming (MILP)")
    print("Variables: x,y (continuous, integer)")
    print("Minimize: 2x + 3y")
    print("Subject to: x + 2y â‰¥ 5, x â‰¥ 0 (continuous), y âˆˆ Z+ (integer)")

    solver = OptimizationSolver("Mixed_Integer_Programming")
    solver.create_model(n_vars=2, var_names=['x', 'y'],
                        var_types=['continuous', 'integer'], lb=[0, 0])

    # Linear objective with mixed variables
    def objective(model):
        return 2 * model.x[1] + 3 * model.x[2]

    solver.set_objective(objective, 'minimize')
    solver.add_linear_constraints(A=[[1, 2]], b=[5], sense='>=')

    if solver.solve():
        solver.print_solution()
        solver.plot_solution_2d(x_range=(0, 6), y_range=(0, 4), title="Mixed Integer Programming")
        return solver.get_solution()
    return None


# Example 3: NLP - x,y (continuous, continuous) with sqrt and cubic
def example_nonlinear_programming():
    """Example 3: Nonlinear Programming - sqrt and cubic terms"""
    print("\nğŸ¯Example 3: Nonlinear Programming (NLP)")
    print("Variables: x,y (continuous, continuous)")
    print("Minimize: sqrt(x) + yÂ³ + 0.1x + 0.1y")
    print("Subject to: x + y â‰¥ 2, x â‰¥ 0.01, y â‰¥ 0.01")

    solver = OptimizationSolver("Nonlinear_Programming")
    solver.create_model(n_vars=2, var_names=['x', 'y'],
                        var_types=['continuous', 'continuous'],
                        lb=[0.01, 0.01], ub=[10, 10])

    # Nonlinear objective with sqrt(x) and yÂ³
    def objective(model):
        return (pyo.sqrt(model.x[1]) + model.x[2] ** 3 +
                0.1 * model.x[1] + 0.1 * model.x[2])

    solver.set_objective(objective, 'minimize')

    # Linear constraint
    def constraint(model):
        return model.x[1] + model.x[2] - 2

    solver.add_constraint(constraint, '>=')

    if solver.solve():
        solver.print_solution()
        solver.plot_solution_2d(x_range=(0, 5), y_range=(0, 3), title="Nonlinear Programming")
        return solver.get_solution()
    return None


# Example 4: QP - x,y (continuous, continuous)
def example_quadratic_programming():
    """Example 4: Quadratic Programming - Quadratic terms"""
    print("\nğŸ¯Example 4: Quadratic Programming (QP)")
    print("Variables: x,y (continuous, continuous)")
    print("Minimize: xÂ² + yÂ² - 4x - 6y")
    print("Subject to: x + y â‰¤ 5, x,y â‰¥ 0")
    solver = OptimizationSolver("Quadratic_Programming")

    # Quadratic objective
    def objective(model):
        return model.x[1] ** 2 + model.x[2] ** 2 - 4 * model.x[1] - 6 * model.x[2]

    # Support chain calls
    solver.create_model(n_vars=2, var_names=['x', 'y'],
                        var_types=['continuous', 'continuous'], lb=[0, 0]) \
        .set_objective(objective, 'minimize') \
        .add_linear_constraints(A=[[1, 1]], b=[5], sense='<=')

    if solver.solve():
        solver.print_solution()
        solver.plot_solution_2d(x_range=(0, 6), y_range=(0, 6), title="Quadratic Programming")
        return solver.get_solution()
    return None


def main():
    """Main function with updated examples"""

    # Run 4 updated examples
    results = []

    try:
        results.append(example_linear_programming())  # LP - x,y (continuous, continuous)
        results.append(example_mixed_integer_programming())  # MILP - x,y (continuous, integer)
        results.append(example_nonlinear_programming())  # NLP - x,y (continuous, continuous) with sqrt and cubic
        results.append(example_quadratic_programming())  # QP - x,y (continuous, continuous)

    except Exception as e:
        print(f"âŒ Error: {e}")

    # Summary with ALL ENGLISH labels
    print(f"\nğŸ“Š SUMMARY")
    print("=" * 70)

    examples = [
        ("Linear Programming", "LP", "x,y (continuous, continuous)"),
        ("Mixed Integer Linear Programming", "MILP", "x,y (continuous, integer)"),
        ("Nonlinear Programming", "NLP", "x,y (continuous, continuous) - sqrt & cubic"),
        ("Quadratic Programming", "QP", "x,y (continuous, continuous)")
    ]

    successful = sum(1 for r in results if r is not None)

    for i, (name, expected_type, description) in enumerate(examples):
        if i < len(results) and results[i] is not None:
            actual_type = results[i]['problem_type']
            has_mixed = results[i].get('has_mixed_variables', False)
            mixed_info = " (Mixed Variables)" if has_mixed else ""
            print(f"âœ… {name}: {actual_type}{mixed_info} - {description}")
        else:
            print(f"âŒ {name}: Failed")

    print(f"\nSolved: {successful}/4 problems")

if __name__ == "__main__":
    main()
```

**è¯´æ˜:**

| æ–¹æ³•                                                 | åŠŸèƒ½         | ç¤ºä¾‹                                                        |
| ---------------------------------------------------- | ------------ | ----------------------------------------------------------- |
| `create_model(n_vars, var_names, var_types, lb, ub)` | åˆ›å»ºæ¨¡å‹     | `solver.create_model(2, ['x','y'], 'continuous', lb=[0,0])` |
| `set_objective(objective_func, sense)`               | è®¾ç½®ç›®æ ‡å‡½æ•° | `solver.set_objective(obj_func, 'maximize')`                |
| `add_linear_constraints(A, b, sense)`                | æ·»åŠ çº¿æ€§çº¦æŸ | `solver.add_linear_constraints([[1,1]], [5], '<=')`         |
| `add_constraint(constraint_func, sense)`             | æ·»åŠ å•ä¸ªçº¦æŸ | `solver.add_constraint(constraint, '>=')`                   |
| `solve(solver, options, verbose)`                    | æ±‚è§£é—®é¢˜     | `solver.solve()`                                            |
| `print_solution()`                                   | æ‰“å°è§£       | `solver.print_solution()`                                   |
| `plot_solution_2d()`                                 | 2Då›¾è¡¨       | `solver.plot_solution_2d()`                                 |

æ”¯æŒæ–¹æ³•é“¾å¼è°ƒç”¨

```python
solver.create_model(2, ['x','y'], lb=[0,0]) \
      .set_objective(obj_func, 'maximize') \
      .add_linear_constraints(A, b, '<=') \
      .solve()
```

æ³¨æ„ï¼šåœ¨æ„é€ ç¬¦å·è¡¨è¾¾å¼åº”ä½¿ç”¨Pyomoä¸­çš„æ–¹æ³•è€Œä¸æ˜¯Pythonçš„`math`åº“

```python
# ç¤ºä¾‹
import pyomo.environ as pyo

pyo.sqrt(model.x[1])
```

- `exp(x)`ï¼šæŒ‡æ•°å‡½æ•° $e^x$
- `log(x)`ï¼šè‡ªç„¶å¯¹æ•° $\ln(x)$ï¼ˆè¦æ±‚ $x > 0$ï¼‰
- `log10(x)`ï¼šä»¥ 10 ä¸ºåº•çš„å¯¹æ•° $\log_{10}(x)$
- `sqrt(x)`ï¼šå¹³æ–¹æ ¹ $\sqrt{x}$
- `x ** n`ï¼šå¹‚å‡½æ•°ï¼ˆæ”¯æŒå˜é‡æˆ–è¡¨è¾¾å¼çš„å¹‚ï¼‰
- `sin(x)`ï¼šæ­£å¼¦å‡½æ•°
- `cos(x)`ï¼šä½™å¼¦å‡½æ•°
- `tan(x)`ï¼šæ­£åˆ‡å‡½æ•°
- `asin(x)`ï¼šåæ­£å¼¦ï¼ˆå€¼åŸŸä¸º [-Ï€/2, Ï€/2]ï¼‰
- `acos(x)`ï¼šåä½™å¼¦ï¼ˆå€¼åŸŸä¸º [0, Ï€]ï¼‰
- `atan(x)`ï¼šåæ­£åˆ‡ï¼ˆå€¼åŸŸä¸º [-Ï€/2, Ï€/2]ï¼‰
- `sinh(x)`ï¼šåŒæ›²æ­£å¼¦
- `cosh(x)`ï¼šåŒæ›²ä½™å¼¦
- `tanh(x)`ï¼šåŒæ›²æ­£åˆ‡
- `abs(x)`ï¼šç»å¯¹å€¼ï¼ˆè‡ªåŠ¨å¼•å…¥çº¦æŸï¼‰
- `ceil(x)`ï¼šå‘ä¸Šå–æ•´ï¼ˆæ•´æ•°è§„åˆ’ä¸­æ…ç”¨ï¼‰
- `floor(x)`ï¼šå‘ä¸‹å–æ•´ï¼ˆåŒä¸Šï¼‰
- `max_(x, y)`ï¼šæœ€å¤§å€¼ï¼ˆæ³¨æ„æœ«å°¾æ˜¯ä¸‹åˆ’çº¿ï¼Œé¿å…ä¸ Python ä¿ç•™å­—å†²çªï¼‰
- `min_(x, y)`ï¼šæœ€å°å€¼

> æ³¨æ„æŸäº›å‡½æ•°ï¼ˆå¦‚ logã€sqrtï¼‰åœ¨è¾¹ç•Œç‚¹ï¼ˆå¦‚ 0ï¼‰æ±‚å¯¼ä¼šå‡ºé”™ï¼Œåº”è®¾ç½®åˆç†çš„å˜é‡ä¸‹é™

## å±‚æåˆ†ææ³•ï¼ˆAHPï¼‰

â€œå±‚æ¬¡åˆ†ææ³•â€ï¼ˆAnalytic Hierarchy Processï¼Œç®€ç§° AHPï¼‰æ˜¯ä¸€ç§**å¤šå‡†åˆ™å†³ç­–åˆ†ææ–¹æ³•**ï¼Œç”±ç¾å›½è¿ç­¹å­¦å®¶æ‰˜é©¬æ–¯Â·è¨è’‚ï¼ˆThomas L. Saatyï¼‰åœ¨20ä¸–çºª70å¹´ä»£æå‡ºçš„ã€‚å®ƒç”¨äºå°†å¤æ‚çš„å†³ç­–é—®é¢˜åˆ†è§£æˆå¤šä¸ªå±‚æ¬¡ç»“æ„ï¼Œå¹¶é€šè¿‡æˆå¯¹æ¯”è¾ƒå’Œä¸€è‡´æ€§æ£€éªŒæ¥ç¡®å®šå„å› ç´ çš„ç›¸å¯¹é‡è¦æ€§

å±‚æ¬¡åˆ†ææ³•çš„ä¸‰å¤§å…¸å‹åº”ç”¨

1. ç”¨äºæœ€ä½³æ–¹æ¡ˆçš„é€‰å–ï¼ˆé€‰æ‹©åœ°å€ï¼‰
2. ç”¨äºè¯„ä»·ç±»é—®é¢˜ï¼ˆè¯„ä»·æ°´è´¨çŠ¶å†µã€è¯„ä»·ç¯å¢ƒï¼‰
3. ç”¨äºæŒ‡æ ‡ä½“ç³»çš„ä¼˜é€‰ï¼ˆå…¼é¡¾ç§‘å­¦å’Œæ•ˆç‡ï¼‰

### æ ¸å¿ƒæ­¥éª¤

1. **å»ºç«‹å±‚æ¬¡ç»“æ„æ¨¡å‹** 
   å°†é—®é¢˜æŠ½è±¡æˆç›®æ ‡ã€å‡†åˆ™å’Œæ–¹æ¡ˆä¸‰ä¸ªå±‚æ¬¡ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚

2. **æ„é€ åˆ¤æ–­çŸ©é˜µ**
   é‡‡ç”¨æˆå¯¹æ¯”è¾ƒçš„æ–¹æ³•ï¼Œä¸“å®¶å¯¹æ¯ä¸€å±‚å› ç´ è¿›è¡Œä¸¤ä¸¤æ¯”è¾ƒï¼Œä½¿ç”¨ 1~9 æ ‡åº¦æ³•å¡«å†™åˆ¤æ–­çŸ©é˜µã€‚ä¾‹å¦‚ï¼Œâ€œå› ç´  A æ¯”å› ç´  B é‡è¦â€å¯ç”¨æ•°å€¼è¡¨ç¤ºã€‚

3. **è®¡ç®—æƒé‡å‘é‡**
   æ±‚è§£åˆ¤æ–­çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œå¾—åˆ°æ¯ä¸ªå› ç´ çš„ç›¸å¯¹æƒé‡ï¼ˆå³é‡è¦æ€§ï¼‰ã€‚

4. **ä¸€è‡´æ€§æ£€éªŒ**
   åˆ¤æ–­ä¸“å®¶æ‰“åˆ†æ˜¯å¦é€»è¾‘ä¸€è‡´ã€‚å¦‚æœä¸ä¸€è‡´ï¼ˆCI å€¼è¶…è¿‡é˜ˆå€¼ï¼‰ï¼Œéœ€è¦é‡æ–°æ‰“åˆ†ã€‚

5. **ç»¼åˆæƒé‡è®¡ç®—**
   é€å±‚è®¡ç®—å‡ºæœ€ç»ˆæ¯ä¸ªæ–¹æ¡ˆçš„ç»¼åˆå¾—åˆ†ï¼Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„æ–¹æ¡ˆã€‚

#### 1. å»ºç«‹å±‚æ¬¡ç»“æ„æ¨¡å‹

AHP é€šè¿‡å°†å¤æ‚é—®é¢˜ç»“æ„åŒ–ï¼Œåˆ†æˆä¸‰ä¸ªä¸»è¦å±‚æ¬¡ï¼š

1. **ç›®æ ‡å±‚ï¼ˆç›®æ ‡ï¼‰**ï¼šå†³ç­–çš„æœ€ç»ˆç›®æ ‡ï¼Œæ¯”å¦‚â€œé€‰å‡ºæœ€ä¼˜æ–¹æ¡ˆâ€
2. **å‡†åˆ™å±‚ï¼ˆæˆ–å«æ ‡å‡†å±‚ï¼‰**ï¼šå½±å“ç›®æ ‡å®ç°çš„å‡†åˆ™æˆ–æŒ‡æ ‡
3. **æ–¹æ¡ˆå±‚**ï¼šå¤‡é€‰çš„å†³ç­–æ–¹æ¡ˆ

**ç¤ºä¾‹:**

![](https://cdn.giraffish.me/blog/25-06-24-1750745008263.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750745017254.webp)

#### 2. æ„é€ åˆ¤æ–­ï¼ˆæˆå¯¹æ¯”è¾ƒï¼‰çŸ©é˜µ

åœ¨ç¡®å®šå„å±‚æ¬¡å„å› ç´ ä¹‹é—´çš„æƒé‡æ—¶ï¼Œå¦‚æœåªæ˜¯å®šæ€§çš„ç»“æœï¼Œå¸¸å¸¸ä¸å®¹æ˜“è¢«ä»–äººæ¥å—ã€‚å› æ­¤ï¼ŒSaaty ç­‰äººæå‡ºâ€œä¸€è‡´çŸ©é˜µæ³•â€ï¼Œå…¶ä¸»è¦æ€æƒ³åŒ…æ‹¬ï¼š

1. ä¸æŠŠæ‰€æœ‰å› ç´ æ”¾åœ¨ä¸€èµ·æ¯”è¾ƒï¼Œè€Œæ˜¯**ä¸¤ä¸¤ç›¸äº’æ¯”è¾ƒ**ï¼›
2. é‡‡ç”¨**ç›¸å¯¹å°ºåº¦**ï¼Œå°½å¯èƒ½å‡å°‘æ€§è´¨ä¸åŒçš„å› ç´ ç›´æ¥æ¯”è¾ƒçš„å›°éš¾ï¼Œä»¥æé«˜åˆ¤æ–­çš„å‡†ç¡®åº¦ã€‚

åˆ¤æ–­çŸ©é˜µç”¨äºè¡¨ç¤ºæœ¬å±‚æ‰€æœ‰å› ç´ **é’ˆå¯¹ä¸Šä¸€å±‚æŸä¸€ä¸ªå› ç´ **çš„ç›¸å¯¹é‡è¦æ€§ã€‚åˆ¤æ–­çŸ©é˜µä¸­çš„å…ƒç´  $a_{ij}$ ç”± Saaty æå‡ºçš„ **1â€”9 æ ‡åº¦æ³•**ç»™å‡ºï¼Œç”¨æ¥é‡åŒ–â€œå› ç´  $i$ ç›¸å¯¹äºå› ç´  $j$ çš„é‡è¦æ€§â€

å¿ƒç†å­¦ç ”ç©¶è¡¨æ˜ï¼Œ**æˆå¯¹æ¯”è¾ƒçš„å› ç´ ä¸å®œè¶…è¿‡ 9 ä¸ª**ï¼Œå› æ­¤æ¯ä¸€å±‚çš„å› ç´ æ•°é‡é€šå¸¸æ§åˆ¶åœ¨ 9 ä¸ªä»¥å†…

**åˆ¤æ–­çŸ©é˜µå…ƒç´  $a_{ij}$ çš„æ ‡åº¦æ–¹æ³•**

| æ ‡åº¦       | å«ä¹‰                                                         |
| ---------- | ------------------------------------------------------------ |
| 1          | è¡¨ç¤ºä¸¤ä¸ªå› ç´ ç›¸æ¯”ï¼Œå…·æœ‰åŒæ ·é‡è¦æ€§                             |
| 3          | è¡¨ç¤ºä¸¤ä¸ªå› ç´ ç›¸æ¯”ï¼Œä¸€ä¸ªå› ç´ æ¯”å¦ä¸€ä¸ªå› ç´ ç¨å¾®é‡è¦               |
| 5          | è¡¨ç¤ºä¸¤ä¸ªå› ç´ ç›¸æ¯”ï¼Œä¸€ä¸ªå› ç´ æ¯”å¦ä¸€ä¸ªå› ç´ æ˜æ˜¾é‡è¦               |
| 7          | è¡¨ç¤ºä¸¤ä¸ªå› ç´ ç›¸æ¯”ï¼Œä¸€ä¸ªå› ç´ æ¯”å¦ä¸€ä¸ªå› ç´ å¼ºçƒˆé‡è¦               |
| 9          | è¡¨ç¤ºä¸¤ä¸ªå› ç´ ç›¸æ¯”ï¼Œä¸€ä¸ªå› ç´ æ¯”å¦ä¸€ä¸ªå› ç´ æç«¯é‡è¦               |
| 2, 4, 6, 8 | ä¸Šè¿°ä¸¤ç›¸é‚»åˆ¤æ–­çš„ä¸­å€¼                                         |
| å€’æ•°       | å› ç´  $i$ ä¸ $j$ æ¯”è¾ƒçš„åˆ¤æ–­ $a_{ij}$ï¼Œåˆ™å› ç´  $j$ ä¸ $i$ æ¯”è¾ƒçš„åˆ¤æ–­ $a_{ji} = 1/a_{ij}$ |

![](https://cdn.giraffish.me/blog/25-06-24-1750745981093.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750745989626.webp)

#### 3. è®¡ç®—æƒé‡å‘é‡

![](https://cdn.giraffish.me/blog/25-06-24-1750745999875.webp)

#### 4. ä¸€è‡´æ€§æ£€éªŒ

![](https://cdn.giraffish.me/blog/25-06-24-1750750945258.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750750974635.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750750960270.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750751627685.webp)

#### 5. ç»¼åˆæƒé‡è®¡ç®—

ä¸Šè¿°æ­¥éª¤2-4å®Œæˆäº†**å‡†åˆ™å±‚åˆ°ç›®æ ‡å±‚**çš„æƒé‡å‘é‡ï¼ˆå±‚æ¬¡å•æ’åºï¼‰ï¼Œç°åœ¨éœ€è¦é‡å¤2-4çš„æ­¥éª¤ï¼Œå®Œæˆ**æ–¹æ¡ˆå±‚å¯¹æ¯ä¸€ä¸ªå‡†åˆ™å±‚**çš„æƒé‡å‘é‡ï¼Œå³**æ–¹æ¡ˆ**åœ¨æ¯ä¸€ä¸ª**è¯„åˆ¤å‡†åˆ™**ä¸Šçš„â€œå¾—åˆ†â€ï¼Œ$\sum (\text{å¾—åˆ†} \times \text{æƒé‡}) = \text{æ€»å¾—åˆ†}$ï¼Œå³å±‚æ¬¡æ€»æ’åº

![](https://cdn.giraffish.me/blog/25-06-24-1750751345690.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750751709182.webp)

**å±‚æ¬¡æ€»æ’åºçš„ä¸€è‡´æ€§æ£€éªŒ**

![](https://cdn.giraffish.me/blog/25-06-24-1750751764758.webp)

**ç¤ºä¾‹**

![](https://cdn.giraffish.me/blog/25-06-24-1750751801319.webp)

![](https://cdn.giraffish.me/blog/25-06-24-1750751821557.webp)

### ç¤ºä¾‹ä»£ç 

```python
import numpy as np
from scipy.linalg import eig


class AHP:
    """
    A class to implement the Analytic Hierarchy Process.
    """

    def __init__(self, criteria_matrix, alternatives_matrices):
        """
        Initialize the AHP model.
        :param criteria_matrix: The pairwise comparison matrix for the criteria.
        :param alternatives_matrices: A list of pairwise comparison matrices for the alternatives,
                                      one for each criterion.
        """
        self.criteria_matrix = np.array(criteria_matrix, dtype=float)
        self.alternatives_matrices = [np.array(m, dtype=float) for m in alternatives_matrices]

        self.num_criteria = self.criteria_matrix.shape[0]
        self.num_alternatives = self.alternatives_matrices[0].shape[0]

        # Predefined Random Index (RI) for matrices of size 1 to 10
        # Saaty's 1980 RI values
        self.RI = {
            1: 0, 2: 0, 3: 0.58, 4: 0.90, 5: 1.12,
            6: 1.24, 7: 1.32, 8: 1.41, 9: 1.45, 10: 1.49
        }

    def _calculate_weights(self, matrix):
        """
        Calculate the priority vector (weights) from a pairwise comparison matrix.
        This uses the principal eigenvalue method.
        """
        # Calculate eigenvalues and eigenvectors
        eigenvalues, eigenvectors = eig(matrix)

        # Find the index of the largest real eigenvalue
        max_eigenvalue_index = np.argmax(np.real(eigenvalues))

        # Get the corresponding eigenvector
        principal_eigenvector = np.real(eigenvectors[:, max_eigenvalue_index])

        # Normalize the eigenvector to get weights (ensure positive values)
        if np.sum(principal_eigenvector) < 0:
            principal_eigenvector = -principal_eigenvector

        weights = principal_eigenvector / np.sum(principal_eigenvector)

        return weights

    def _check_consistency(self, matrix):
        """
        Check the consistency of a pairwise comparison matrix.
        Returns the Consistency Ratio (CR). A CR of 0.10 or less is considered acceptable.
        """
        n = matrix.shape[0]
        if n <= 2:
            return 0.0  # Matrices of size 1 or 2 are always consistent

        weights = self._calculate_weights(matrix)

        # Calculate lambda_max
        weighted_sum_vector = np.dot(matrix, weights)
        lambda_max = np.mean(weighted_sum_vector / weights)

        # Calculate Consistency Index (CI)
        CI = (lambda_max - n) / (n - 1)

        # Get Random Index (RI)
        RI = self.RI.get(n)
        if RI is None or RI == 0:
            return float('inf')  # Should not happen for n > 2 with the given RI table

        # Calculate Consistency Ratio (CR)
        CR = CI / RI
        return CR

    def calculate_final_scores(self):
        """
        Calculate the final scores for each alternative.
        """
        # 1. Calculate criteria weights and check consistency
        criteria_weights = self._calculate_weights(self.criteria_matrix)
        criteria_cr = self._check_consistency(self.criteria_matrix)

        print("--- Criteria Analysis ---")
        print(f"Criteria Weights: {np.round(criteria_weights, 4)}")
        print(f"Criteria Consistency Ratio (CR): {criteria_cr:.4f}")
        if criteria_cr > 0.1:
            print("Warning: The criteria comparison matrix is inconsistent (CR > 0.1).")
        print("-" * 25)

        # 2. Calculate alternative weights for each criterion
        alternative_weights_matrix = []
        for i, alt_matrix in enumerate(self.alternatives_matrices):
            alt_weights = self._calculate_weights(alt_matrix)
            alt_cr = self._check_consistency(alt_matrix)
            alternative_weights_matrix.append(alt_weights)

            print(f"\n--- Analysis for Criterion {i + 1} ---")
            print(f"Alternative Weights: {np.round(alt_weights, 4)}")
            print(f"Consistency Ratio (CR): {alt_cr:.4f}")
            if alt_cr > 0.1:
                print(f"Warning: The alternative comparison matrix for criterion {i + 1} is inconsistent (CR > 0.1).")
            print("-" * 25)

        # 3. Synthesize the results to get final scores
        alternative_weights_matrix = np.array(alternative_weights_matrix).T
        final_scores = np.dot(alternative_weights_matrix, criteria_weights)

        return final_scores

if __name__ == '__main__':
    # --- Step 1: Define your problem ---
    # Goal: Choose the best car

    criteria_labels = ["Price", "Safety", "Performance"]
    alternatives_labels = ["Car A", "Car B", "Car C"]

    # --- Step 2: Create pairwise comparison matrices ---
    # These matrices represent subjective judgments.
    # The scale typically ranges from 1 (equal importance) to 9 (extreme importance).
    # If criterion A is '3' times more important than B, then B is '1/3' as important as A.

    # 2.1. Pairwise comparison matrix for the criteria
    #       Price   Safety  Performance
    # Price   1        3         5
    # Safety 1/3       1         2
    # Perf.  1/5      1/2        1
    criteria_matrix = [
        [1, 3, 5],
        [1 / 3, 1, 2],
        [1 / 5, 1 / 2, 1]
    ]

    # 2.2. Pairwise comparison matrices for alternatives for each criterion
    # For "Price" (lower is better, so a cheaper car gets a higher score)
    #       Car A   Car B   Car C
    # Car A   1        5       2
    # Car B  1/5       1      1/3
    # Car C  1/2       3       1
    alternatives_price = [
        [1, 5, 2],
        [1 / 5, 1, 1 / 3],
        [1 / 2, 3, 1]
    ]

    # For "Safety"
    #       Car A   Car B   Car C
    # Car A   1      1/5     1/2
    # Car B   5       1       3
    # Car C   2      1/3      1
    alternatives_safety = [
        [1, 1 / 5, 1 / 2],
        [5, 1, 3],
        [2, 1 / 3, 1]
    ]

    # For "Performance"
    #       Car A   Car B   Car C
    # Car A   1      1/3     1/7
    # Car B   3       1      1/3
    # Car C   7       3       1
    alternatives_performance = [
        [1, 1 / 3, 1 / 7],
        [3, 1, 1 / 3],
        [7, 3, 1]
    ]

    alternatives_matrices = [alternatives_price, alternatives_safety, alternatives_performance]

    # --- Step 3: Run the AHP calculation ---
    ahp_model = AHP(criteria_matrix, alternatives_matrices)
    final_scores = ahp_model.calculate_final_scores()

    # --- Step 4: Display the final results ---
    print("\n\n--- Final Results ---")
    for i, score in enumerate(final_scores):
        print(f"Final Score for {alternatives_labels[i]}: {score:.4f}")

    best_alternative_index = np.argmax(final_scores)
    print(f"\nBased on the AHP model, the best choice is: {alternatives_labels[best_alternative_index]}")
```
## TOPSIS + ç†µæƒæ³•

**TOPSIS**ï¼ˆTechnique for Order Preference by Similarity to Ideal Solutionï¼Œä¼˜åŠ£è§£è·ç¦»æ³•ï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„ç»¼åˆè¯„ä»·æ–¹æ³•ï¼Œèƒ½å……åˆ†åˆ©ç”¨åŸå§‹æ•°æ®çš„ä¿¡æ¯ï¼Œå…¶ç»“æœèƒ½ç²¾ç¡®åœ°åæ˜ å„è¯„ä»·æ–¹æ¡ˆä¹‹é—´çš„å·®è·

TOPSISæ³•å¼•å…¥äº†ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µï¼š
**ç†æƒ³è§£**ï¼šè®¾æƒ³çš„æœ€ä¼˜çš„è§£ï¼ˆæ–¹æ¡ˆï¼‰ï¼Œå®ƒçš„å„ä¸ªå±æ€§å€¼éƒ½è¾¾åˆ°å„å¤‡é€‰æ–¹æ¡ˆä¸­çš„æœ€å¥½çš„å€¼
**è´Ÿç†æƒ³è§£**ï¼šè®¾æƒ³çš„æœ€åŠ£çš„è§£ï¼ˆæ–¹æ¡ˆï¼‰ï¼Œå®ƒçš„å„ä¸ªå±æ€§å€¼éƒ½è¾¾åˆ°å„å¤‡é€‰æ–¹æ¡ˆä¸­çš„æœ€åçš„å€¼

æ–¹æ¡ˆæ’åºçš„è§„åˆ™æ˜¯æŠŠå„å¤‡é€‰æ–¹æ¡ˆä¸ç†æƒ³è§£å’Œè´Ÿç†æƒ³è§£åšæ¯”è¾ƒï¼Œè‹¥å…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ¡ˆ**æœ€æ¥è¿‘ç†æƒ³è§£**ï¼Œè€ŒåŒæ—¶åˆ**è¿œç¦»è´Ÿç†æƒ³è§£**ï¼Œåˆ™è¯¥æ–¹æ¡ˆæ˜¯å¤‡é€‰æ–¹æ¡ˆä¸­æœ€å¥½çš„æ–¹æ¡ˆã€‚TOPSISé€šè¿‡æœ€æ¥è¿‘ç†æƒ³è§£ä¸”æœ€è¿œç¦»è´Ÿç†æƒ³è§£æ¥**ç¡®å®šæœ€ä¼˜é€‰æ‹©**

**ç†µæƒæ³•**æ˜¯ä¸€ç§**å®¢è§‚èµ‹æƒæ–¹æ³•**ï¼ŒåŸºäºä¿¡æ¯ç†µç†è®ºç¡®å®šå„è¯„ä»·æŒ‡æ ‡çš„æƒé‡ï¼Œå¯ç”¨äºå¤šç§å¤šæŒ‡æ ‡ç»¼åˆè¯„ä»·æ–¹æ³•ä¸­çš„æƒé‡è®¡ç®—ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¸ºï¼š

- æŒ‡æ ‡å€¼å·®å¼‚è¶Šå¤§ï¼ŒåŒ…å«çš„ä¿¡æ¯è¶Šå¤šï¼Œæƒé‡åº”è¶Šå¤§
- æŒ‡æ ‡å€¼è¶Šæ¥è¿‘ï¼Œè¯´æ˜ä¿¡æ¯è¶Šå°‘ï¼Œæƒé‡åº”è¶Šå°

### æ ¸å¿ƒæ­¥éª¤

#### 1. æ„å»º**å†³ç­–çŸ©é˜µ**

æ„å»ºå†³ç­–çŸ©é˜µ $X = [x_{ij}]$ï¼Œå…¶ä¸­ $x_{ij}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªæ–¹æ¡ˆåœ¨ç¬¬ $j$ ä¸ªæŒ‡æ ‡ä¸Šçš„æ•°å€¼ï¼Œ$i=1,2,\dots,m$ï¼Œ$j=1,2,\dots,n$

#### 2. **æ ‡å‡†åŒ–**å†³ç­–çŸ©é˜µ

| æŒ‡æ ‡ç±»å‹             | æŒ‡æ ‡ç‰¹ç‚¹               | ä¾‹å­                          |
|----------------------|------------------------|-------------------------------|
| æå¤§å‹ï¼ˆæ•ˆç›Šå‹ï¼‰æŒ‡æ ‡ | è¶Šå¤§ï¼ˆå¤šï¼‰è¶Šå¥½         | é¢œå€¼ã€æˆç»©ã€GDPå¢é€Ÿ           |
| æå°å‹ï¼ˆæˆæœ¬å‹ï¼‰æŒ‡æ ‡ | è¶Šå°ï¼ˆå°‘ï¼‰è¶Šå¥½         | è„¾æ°”ã€è´¹ç”¨ã€ç¯å“ç‡ã€æ±¡æŸ“ç¨‹åº¦  |
| ä¸­é—´å‹æŒ‡æ ‡           | è¶Šæ¥è¿‘æŸä¸ªå€¼è¶Šå¥½       | èº«é«˜ã€æ°´è´¨é‡è¯„ä¼°æ—¶çš„PHå€¼      |
| åŒºé—´å‹æŒ‡æ ‡           | è½åœ¨æŸä¸ªåŒºé—´æœ€å¥½       | ä½“é‡ã€ä½“æ¸©                    |

- å°†åŸå§‹çŸ©é˜µ**æ­£å‘åŒ–** 
  å°†åŸå§‹çŸ©é˜µæ­£å‘åŒ–ï¼Œå°±æ˜¯è¦å°†æ‰€æœ‰çš„æŒ‡æ ‡ç±»å‹ç»Ÿä¸€è½¬åŒ–ä¸º**æå¤§å‹æŒ‡æ ‡**

| **æŒ‡æ ‡åç§°**         | **å…¬å¼**                                                     | **è¯´æ˜**                                                   |
| -------------------- | ------------------------------------------------------------ | ---------------------------------------------------------- |
| æå¤§å‹ï¼ˆæ•ˆç›Šå‹ï¼‰æŒ‡æ ‡ | /                                                            | /                                                          |
| æå°å‹ï¼ˆæˆæœ¬å‹ï¼‰æŒ‡æ ‡ | $\hat{x} = \max - x$                                         | $\hat{x}$ä¸ºè½¬åŒ–åæŒ‡æ ‡ï¼Œ$\max$ä¸ºæŒ‡æ ‡æœ€å¤§å€¼ï¼Œ$x$ä¸ºåŸå§‹æŒ‡æ ‡å€¼ |
| ä¸­é—´å‹æŒ‡æ ‡           | $\hat{x}_i = 1 - \frac{|x_i - x_{\text{best}}|}{M}$ï¼Œ$M = \max \{|x_i - x_{\text{best}}|\}$ | $\{x_i\}$ æ˜¯ä¸€ç»„ä¸­é—´å‹åºåˆ—ï¼Œ$x_{\text{best}}$ æ˜¯æœ€ä¼˜å€¼     |
| åŒºé—´å‹æŒ‡æ ‡           | $\hat{x}_i = \begin{cases} 1 - \frac{a - x_i}{M}, & x_i < a \\ 1, & a \le x_i \le b \\ 1 - \frac{x_i - b}{M}, & x_i > b \end{cases}$ $M = \max\{a - \min\{x_i\}, \max\{x_i\} - b\}$ | $\{x_i\}$ æ˜¯ä¸€ç»„åŒºé—´å‹åºåˆ—ï¼Œæœ€ä¼˜åŒºé—´ä¸º $[a, b]$            |

- æ­£å‘çŸ©é˜µ**æ ‡å‡†åŒ–** 
  æ ‡å‡†åŒ–çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸»è¦ç›®çš„å°±æ˜¯**å»é™¤é‡çº²çš„å½±å“**ï¼Œä¿è¯ä¸åŒè¯„ä»·æŒ‡æ ‡åœ¨åŒä¸€æ•°é‡çº§ï¼Œä¸”æ•°æ®å¤§å°æ’åºä¸å˜

å‡è®¾æœ‰ $n$ ä¸ªè¦è¯„ä»·çš„å¯¹è±¡ï¼Œ$m$ ä¸ªè¯„ä»·æŒ‡æ ‡ï¼ˆå·²æ­£å‘åŒ–ï¼‰æ„æˆçš„æ­£å‘åŒ–çŸ©é˜µå¦‚ä¸‹ï¼š

$$
X = 
\begin{bmatrix}
x_{11} & \cdots & x_{1m} \\
\vdots & \ddots & \vdots \\
x_{n1} & \cdots & x_{nm}
\end{bmatrix}
$$

é‚£ä¹ˆï¼Œå¯¹å…¶æ ‡å‡†åŒ–çš„çŸ©é˜µè®°ä¸º $Z$ï¼Œ$Z$ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼š

$$
Z_{ij} = \frac{x_{ij}}{\sqrt{\sum_{i=1}^n x_{ij}^2}}
$$

å³ï¼šæ¯ä¸€ä¸ªå…ƒç´ é™¤ä»¥å…¶æ‰€åœ¨åˆ—çš„å…ƒç´ çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹

#### 3. **ç†µæƒæ³•**åŠ æƒæ ‡å‡†åŒ–çŸ©é˜µ

1. è®¡ç®—æ¦‚ç‡çŸ©é˜µ

$$
p_{ij} = \frac{x_{ij}}{\sum_{i=1}^m x_{ij}}
$$

2. è®¡ç®—ä¿¡æ¯ç†µ

$$
e_j = -\frac{1}{\ln n} \sum_{i=1}^n p_{ij} \ln p_{ij}
$$

> æ³¨æ„ï¼šå½“ $p_{ij} = 0$ æ—¶ï¼Œå®šä¹‰ $p_{ij} \ln p_{ij} = 0$

3. è®¡ç®—ä¿¡æ¯æ•ˆç”¨å€¼

$$
d_j = 1 - e_j
$$

4. è®¡ç®—æŒ‡æ ‡æƒé‡ï¼š

$$
w_j = \frac{d_j}{\sum_{j=1}^m d_j}
$$

5. åˆ©ç”¨æƒé‡åŠ æƒ

å¯¹äºæ ‡å‡†åŒ–çŸ©é˜µ $Z = [z_{ij}]$ï¼Œæ¯åˆ—æ˜¯å½’ä¸€åŒ–çš„å€¼ï¼Œæ¯åˆ—çš„æƒé‡ä¸º $w_j$ï¼Œåˆ™åŠ æƒåçš„çŸ©é˜µ $V = [v_{ij}]$ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸ºï¼š

$$
v_{ij} = w_j \cdot z_{ij}
$$

#### 4. ç¡®å®šæ­£ç†æƒ³è§£ä¸è´Ÿç†æƒ³è§£

- æ­£ç†æƒ³è§£ï¼ˆæœ€ä¼˜ï¼‰ï¼š$Z^+ = \{v_1^+, v_2^+, \dots, v_n^+\}$
- è´Ÿç†æƒ³è§£ï¼ˆæœ€åŠ£ï¼‰ï¼š$Z^- = \{v_1^-, v_2^-, \dots, v_n^-\}$

å¯¹äºæ¯ä¸ªæŒ‡æ ‡ $j$ï¼š

$$
v_j^+ = \max_i v_{ij}, \quad v_j^- = \min_i v_{ij}
$$

#### 5. è®¡ç®—å„æ–¹æ¡ˆåˆ°ç†æƒ³è§£çš„è·ç¦»

- åˆ°æ­£ç†æƒ³è§£çš„è·ç¦»ï¼š
$$
D_i^+ = \sqrt{\sum_{j=1}^m (v_{ij} - Z_j^+)^2}
$$
- åˆ°è´Ÿç†æƒ³è§£çš„è·ç¦»ï¼š
$$
D_i^- = \sqrt{\sum_{j=1}^m (v_{ij} - Z_j^-)^2}
$$

#### 6. è®¡ç®—è´´è¿‘åº¦ï¼ˆæœ€ç»ˆå¾—åˆ†ï¼‰

$$
S_i = \frac{D_i^+}{D_i^+ + D_i^-}
$$

å…¶ä¸­ $0 \le S_i \le 1$ï¼Œ$S_i$ è¶Šå¤§è¡¨ç¤ºæ–¹æ¡ˆè¶Šä¼˜

å¦å¤–æˆ‘ä»¬å¯ä»¥å°†å¾—åˆ†å½’ä¸€åŒ–å¹¶æ¢æˆç™¾åˆ†åˆ¶

$$
\tilde{S_i} = \frac{S_i}{\sum_{i=1}^{n} S_i} \times 100
$$

#### ç¤ºä¾‹

æ˜æ˜ŸKunåœ¨é€‰npyï¼Œæ„å»ºå†³ç­–çŸ©é˜µ

| å€™é€‰äºº | é¢œå€¼ | è„¾æ°”ï¼ˆäº‰åµæ¬¡æ•°ï¼‰ | èº«é«˜ | ä½“é‡ |
| ------ | ---- | ---------------- | ---- | ---- |
| A      | 9    | 10               | 175  | 120  |
| B      | 8    | 7                | 164  | 80   |
| C      | 6    | 3                | 157  | 90   |

> å…¶ä¸­é¢œå€¼ä¸ºæå¤§å‹æŒ‡æ ‡ï¼Œè„¾æ°”æå°å‹æŒ‡æ ‡ï¼Œèº«é«˜ä¸­é—´å‹æŒ‡æ ‡(165)ï¼Œä½“é‡åŒºé—´å‹æŒ‡æ ‡ï¼ˆ90-100ï¼‰

æ­£å‘åŒ–

| å€™é€‰äºº | é¢œå€¼ | è„¾æ°”ï¼ˆäº‰åµæ¬¡æ•°ï¼‰ | èº«é«˜ | ä½“é‡ |
| ------ | ---- | ---------------- | ---- | ---- |
| A      | 9    | 0                | 0    | 0    |
| B      | 8    | 3                | 0.9  | 0.5  |
| C      | 6    | 7                | 0.2  | 1    |

æ ‡å‡†åŒ–

| å€™é€‰äºº | é¢œå€¼  | è„¾æ°”ï¼ˆäº‰åµæ¬¡æ•°ï¼‰ | èº«é«˜  | ä½“é‡  |
| ------ | ----- | ---------------- | ----- | ----- |
| A      | 0.669 | 0.000            | 0.000 | 0.000 |
| B      | 0.595 | 0.394            | 0.976 | 0.447 |
| C      | 0.446 | 0.919            | 0.217 | 0.894 |

ç†µæƒæ³•è®¡ç®—æƒé‡

| é¢œå€¼  | è„¾æ°”ï¼ˆäº‰åµæ¬¡æ•°ï¼‰ | èº«é«˜  | ä½“é‡  |
| ----- | ---------------- | ----- | ----- |
| 0.008 | 0.307            | 0.393 | 0.291 |

åŠ æƒåçŸ©é˜µ

| å€™é€‰äºº | é¢œå€¼   | è„¾æ°”   | èº«é«˜   | ä½“é‡   |
| ------ | ------ | ------ | ------ | ------ |
| A      | 0.0057 | 0.0000 | 0.0000 | 0.0000 |
| B      | 0.0051 | 0.1210 | 0.3839 | 0.1301 |
| C      | 0.0038 | 0.2823 | 0.0853 | 0.2603 |

ç¡®å®šæ­£ç†æƒ³è§£ä¸è´Ÿç†æƒ³è§£ï¼š

| å±æ€§ | Z+ (æœ€å¤§) | Z- (æœ€å°) |
| ---- | --------- | --------- |
| é¢œå€¼ | 0.0057    | 0.0038    |
| è„¾æ°” | 0.2823    | 0.0000    |
| èº«é«˜ | 0.3839    | 0.0000    |
| ä½“é‡ | 0.2603    | 0.0000    |

**æ­£ç†æƒ³è§£ Z+**: `[0.0057, 0.2823, 0.3839, 0.2603]` 
**è´Ÿç†æƒ³è§£ Z-**: `[0.0038, 0.0000, 0.0000, 0.0000]`

è®¡ç®—å„æ–¹æ¡ˆåˆ°ç†æƒ³è§£çš„è·ç¦»

| å€™é€‰äºº | D+     | D-     |
| ------ | ------ | ------ |
| A      | 0.5430 | 0.0019 |
| B      | 0.2073 | 0.4230 |
| C      | 0.2986 | 0.3934 |

è®¡ç®—è´´è¿‘åº¦ï¼ˆæœ€ç»ˆå¾—åˆ†ï¼‰

| å€™é€‰äºº | å¾—åˆ†   |
| ------ | ------ |
| A      | 0.0035 |
| B      | 0.6711 |
| C      | 0.5685 |

å½’ä¸€åŒ–æ¢æˆç™¾åˆ†åˆ¶

| å€™é€‰äºº | å¾—åˆ†   |
| ------ | ------ |
| B      | 53.99% |
| C      | 45.73% |
| A      | 0.28%  |

### ç¤ºä¾‹ä»£ç 

```python
import numpy as np
import matplotlib.pyplot as plt

def topsis(decision_matrix, weights, criteria_specs, alternatives_labels):
    """
    Advanced TOPSIS method that handles multiple criteria types and prints intermediate steps.

    Args:
        decision_matrix (np.ndarray): A 2D numpy array of the decision matrix.
                                      Rows are alternatives, columns are criteria.
        weights (np.ndarray): A 1D numpy array of weights for each criterion.
        criteria_specs (list): A list of tuples specifying the type and parameters for each criterion.
        alternatives_labels (list): A list of strings for labeling the alternatives.

    Returns:
        tuple: A tuple containing:
            - np.ndarray: The closeness coefficient (Si) for each alternative.
            - np.ndarray: The rank of each alternative.
    """
    # Step 1: Forwardization (Convert all criteria to benefit type)
    positive_matrix = np.zeros_like(decision_matrix, dtype=float)

    for i, spec in enumerate(criteria_specs):
        col = decision_matrix[:, i]
        criterion_type = spec[0]

        if criterion_type == 'benefit':
            positive_matrix[:, i] = col
        elif criterion_type == 'cost':
            positive_matrix[:, i] = np.max(col) - col
        elif criterion_type == 'mid':
            best_value = spec[1]
            m = np.max(np.abs(col - best_value))
            if m == 0:
                positive_matrix[:, i] = 1.0
            else:
                positive_matrix[:, i] = 1 - (np.abs(col - best_value) / m)
        elif criterion_type == 'interval':
            lower_bound, upper_bound = spec[1], spec[2]
            m = np.max([lower_bound - np.min(col), np.max(col) - upper_bound])
            transformed_col = np.zeros_like(col, dtype=float)
            if m == 0:
                 for j, val in enumerate(col):
                    if lower_bound <= val <= upper_bound:
                        transformed_col[j] = 1
                    else:
                        transformed_col[j] = 0
            else:
                for j, val in enumerate(col):
                    if val < lower_bound:
                        transformed_col[j] = 1 - (lower_bound - val) / m
                    elif val > upper_bound:
                        transformed_col[j] = 1 - (val - upper_bound) / m
                    else:
                        transformed_col[j] = 1
            positive_matrix[:, i] = transformed_col
        else:
            raise ValueError(f"Unknown criterion type: {criterion_type}")

    # Step 2: Normalize the positive decision matrix
    norm_matrix = positive_matrix / np.sqrt(np.sum(positive_matrix ** 2, axis=0))

    # Step 3: Calculate weights using Entropy Weight Method if not provided
    if weights is None:
        # Calculate probability matrix
        prob_matrix = norm_matrix / np.sum(norm_matrix, axis=0, keepdims=True)

        # Calculate entropy for each criterion
        entropy = np.zeros(prob_matrix.shape[1])
        for j in range(prob_matrix.shape[1]):
            for i in range(prob_matrix.shape[0]):
                if prob_matrix[i, j] == 0:
                    continue
                entropy[j] += prob_matrix[i, j] * np.log(prob_matrix[i, j])
        entropy = -entropy / np.log(norm_matrix.shape[0])

        # Calculate redundancy (utility) for each criterion
        redundancy = 1 - entropy

        # Calculate weights for each criterion
        weights = redundancy / np.sum(redundancy)

    # Step 4: Create the weighted normalized decision matrix
    weighted_matrix = norm_matrix * weights

    print("--- Intermediate Steps ---")
    print("\nStep 1: Forwardized Matrix (Positive Matrix):\n", positive_matrix)
    print("\nStep 2: Normalized Matrix:\n", norm_matrix)
    print("\nStep 3: Calculated Weights (or provided weights):\n", weights)
    print("\nStep 4: Weighted Normalized Matrix:\n", weighted_matrix)
    print("\n" + "=" * 50 + "\n")

    # Step 5: Determine the ideal and negative-ideal solutions
    ideal_solution = np.max(weighted_matrix, axis=0)  # Z+
    negative_ideal_solution = np.min(weighted_matrix, axis=0)  # Z-

    print("--- Ideal and Negative-Ideal Solutions ---")
    print("\nIdeal Solution (Z+):\n", ideal_solution)
    print("\nNegative-Ideal Solution (Z-):\n", negative_ideal_solution)
    print("Ideal Solution (Z+):")
    print(ideal_solution)
    print("\nNegative-Ideal Solution (Z-):")
    print(negative_ideal_solution)
    print("\n" + "="*50 + "\n")


    print("--- Intermediate Step 5: Distances to Ideal Solutions ---")
    # Step 5: Calculate the separation measures
    distance_to_ideal = np.sqrt(np.sum((weighted_matrix - ideal_solution)**2, axis=1))
    distance_to_negative_ideal = np.sqrt(np.sum((weighted_matrix - negative_ideal_solution)**2, axis=1))
    for i, label in enumerate(alternatives_labels):
        print(f"{label} -> Distance to Ideal (D+): {distance_to_ideal[i]:.4f}, Distance to Negative-Ideal (D-): {distance_to_negative_ideal[i]:.4f}")
    print("\n" + "="*50 + "\n")

    # Step 6: Calculate the relative closeness to the ideal solution
    epsilon = 1e-6
    closeness_coefficient = distance_to_negative_ideal / (distance_to_ideal + distance_to_negative_ideal + epsilon)

    # Step 7: Rank the alternatives
    rank = len(closeness_coefficient) - np.argsort(np.argsort(closeness_coefficient))

    return closeness_coefficient, rank

if __name__ == '__main__':
    # --- Example Usage: Candidate Selection ---

    # Alternatives: Candidate A, Candidate B, Candidate C
    alternatives = [f'Candidate {chr(65+i)}' for i in range(3)]

    # Criteria:
    # 1. Appearance (Score) - 'benefit' type
    # 2. Temper (Number of quarrels) - 'cost' type
    # 3. Height (cm) - 'mid' type (best is 165cm)
    # 4. Weight (kg) - 'interval' type (best is between 90-100kg)
    decision_matrix = np.array([
    # Appearance, Temper, Height, Weight
        [9, 10, 175, 120],  # Candidate A
        [8,  7, 164,  80],  # Candidate B
        [6,  3, 157,  90],  # Candidate C
    ])

    # Weights for each criterion. Assuming equal importance.
    weights = None # Use None to calculate weights using entropy method

    # Specifications for each criterion
    criteria_specs = [
        ('benefit',),
        ('cost',),
        ('mid', 165),
        ('interval', 90, 100)
    ]

    # --- Run TOPSIS ---
    closeness_coefficient, rank = topsis(decision_matrix, weights, criteria_specs, alternatives)

    # --- Final Results ---
    print("--- Final Results ---")
    print(f"{'Alternative':<12} | {'Closeness (Si)':<15} | {'Rank':<5}")
    print("-" * 40)
    results_to_display = sorted(zip(alternatives, closeness_coefficient, rank), key=lambda x: x[2])
    for alt, closeness, r in results_to_display:
        print(f"{alt:<12} | {closeness:<15.4f} | {r:<5}")

    # Calculate percentage score
    percentage_score = (closeness_coefficient / np.sum(closeness_coefficient)) * 100
    print("\n--- Final Percentage Scores (Normalized) ---")
    print(f"{'Alternative':<12} | {'Percentage Score':<20}")
    print("-" * 40)
    results_to_display_percent = sorted(zip(alternatives, percentage_score, rank), key=lambda x: x[2])
    for alt, percent_score, r in results_to_display_percent:
        print(f"{alt:<12} | {percent_score:<20.2f}%")

    best_alternative_index = np.argmax(closeness_coefficient)
    print(f"\nBest Alternative based on TOPSIS: {alternatives[best_alternative_index]}")

    # --- Visualize the Results ---
    plt.figure(figsize=(10, 6))
    sorted_indices = np.argsort(rank)
    sorted_alternatives = [alternatives[i] for i in sorted_indices]
    sorted_closeness = closeness_coefficient[sorted_indices]

    bars = plt.bar(sorted_alternatives, sorted_closeness, color='teal')
    plt.xlabel('Alternatives (Sorted by Rank)')
    plt.ylabel('Closeness Coefficient (Si)')
    plt.title('TOPSIS Results: Closeness Coefficient of Candidates')
    plt.ylim(0, max(closeness_coefficient) * 1.2)

    for bar in bars:
        yval = bar.get_height()
        plt.text(bar.get_x() + bar.get_width()/2.0, yval, f'{yval:.4f}', va='bottom', ha='center')

    plt.tight_layout()
    plt.show()
```

## ç°è‰²å…³è”åˆ†æ

ç°è‰²å…³è”åˆ†ææ˜¯ä¸€ç§å¤šå› ç´ ç»Ÿè®¡åˆ†ææ–¹æ³•ï¼Œéš¶å±äº**ç°è‰²ç³»ç»Ÿç†è®º**ã€‚å®ƒé€šè¿‡åˆ†æå’Œæ¯”è¾ƒæ•°æ®åºåˆ—çš„å‡ ä½•å½¢çŠ¶ç›¸ä¼¼åº¦ï¼Œæ¥åˆ¤æ–­ä¸åŒåºåˆ—ä¹‹é—´çš„**å…³è”ç¨‹åº¦**ã€‚å½“ä¸¤ä¸ªåºåˆ—çš„æ›²çº¿å˜åŒ–è¶‹åŠ¿è¶Šä¸€è‡´ï¼Œå®ƒä»¬çš„å…³è”åº¦å°±è¶Šé«˜ï¼Œåä¹‹åˆ™è¶Šä½

è¯¥æ–¹æ³•å°¤å…¶é€‚ç”¨äº**æ ·æœ¬é‡å°ã€ä¿¡æ¯ä¸å®Œå…¨**çš„ç³»ç»Ÿï¼Œä»¥åŠ**å› ç´ ä¹‹é—´å…³ç³»ä¸æ˜ç¡®**çš„æƒ…å†µã€‚ä¸ä¼ ç»Ÿçš„å›å½’åˆ†æç­‰æ–¹æ³•ç›¸æ¯”ï¼Œç°è‰²å…³è”åˆ†æå¯¹æ•°æ®åˆ†å¸ƒæ²¡æœ‰ä¸¥æ ¼è¦æ±‚ï¼Œè®¡ç®—ç®€ä¾¿ï¼Œç»“æœç›´è§‚æ˜“æ‡‚

### ç°è‰²ç³»ç»Ÿ

ç°è‰²ç³»ç»Ÿç†è®ºæ˜¯ä¸€ç§ç ”ç©¶å’Œè§£å†³**ä¿¡æ¯ä¸å®Œå…¨ã€æ•°æ®é‡å°**é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚å®ƒæŠŠæ‰€æœ‰ä¿¡æ¯éƒ½å·²çŸ¥çš„ç³»ç»Ÿçœ‹ä½œâ€œç™½è‰²â€ï¼ˆå¦‚å®éªŒå®¤ç¯å¢ƒï¼‰ï¼ŒæŠŠä¿¡æ¯å®Œå…¨æœªçŸ¥çš„ç³»ç»Ÿçœ‹ä½œâ€œé»‘è‰²â€ï¼ˆå¦‚é»‘ç®±ï¼‰ï¼Œè€ŒæŠŠä»‹äºä¸¤è€…ä¹‹é—´ã€ä¿¡æ¯éƒ¨åˆ†æ˜ç¡®ã€éƒ¨åˆ†ä¸æ˜ç¡®çš„ç³»ç»Ÿï¼Œå°±ç§°ä¸ºâ€œç°è‰²ç³»ç»Ÿâ€

ç°è‰²ç³»ç»Ÿç†è®ºä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªåˆ†æ”¯ï¼š

1. ç°è‰²å…³è”åˆ†æ
2. ç°è‰²é¢„æµ‹
3. ç°è‰²å†³ç­–
4. ç°è‰²èšç±»

### æ ¸å¿ƒæ­¥éª¤

#### 1. ç¡®å®šåˆ†æåºåˆ—ï¼ˆæ¯åºåˆ—å’Œå­åºåˆ—ï¼‰

é¦–å…ˆï¼Œéœ€è¦æ˜ç¡®ç ”ç©¶çš„ç›®æ ‡ã€‚åœ¨ç°è‰²å…³è”åˆ†æä¸­ï¼Œæˆ‘ä»¬å°†åæ˜ ç³»ç»Ÿè¡Œä¸ºç‰¹å¾çš„æ•°æ®åºåˆ—ç§°ä¸ºå‚è€ƒåºåˆ—æˆ–æ¯åºåˆ—ï¼Œè®°ä¸º $X_0$ã€‚è€Œå½±å“ç³»ç»Ÿè¡Œä¸ºçš„å› ç´ ç»„æˆçš„æ•°æ®åºåˆ—åˆ™ç§°ä¸ºæ¯”è¾ƒåºåˆ—æˆ–å­åºåˆ—ï¼Œè®°ä¸º $X_i$ (i=1, 2, ..., n)

- **æ¯åºåˆ—** $X_0$ï¼šé€šå¸¸æ˜¯ä»£è¡¨æˆ‘ä»¬æœ€å…³å¿ƒçš„ä¸€ä¸ªæŒ‡æ ‡çš„åºåˆ—ï¼Œä¾‹å¦‚ï¼Œç ”ç©¶äº§å“è´¨é‡æ—¶ï¼Œæ¯åºåˆ—å°±æ˜¯äº§å“åˆæ ¼ç‡åºåˆ—

- **å­åºåˆ—** $X_i$ï¼šæ˜¯å¯èƒ½å½±å“æ¯åºåˆ—çš„å„ä¸ªå› ç´ æ‰€æ„æˆçš„æ•°æ®åºåˆ—ï¼Œä¾‹å¦‚ï¼Œå½±å“äº§å“åˆæ ¼ç‡çš„å¯èƒ½æ˜¯åŸææ–™çº¯åº¦ã€ç”Ÿäº§æ¸©åº¦ã€å·¥äººç†Ÿç»ƒåº¦ç­‰

> åœ¨æ–¹æ³•è¯„ä»·é—®é¢˜ä¸­ï¼Œå¯ä»¥å…ˆå°†æ•°æ®æ­£å‘åŒ–ï¼ˆåŒTOPSISï¼‰ï¼Œå†é€‰å–æ¯ä¸€è¯„ä»·é¡¹åœ¨æ‰€æœ‰è¯„ä»·å¯¹è±¡ä¸­æœ€å¤§å€¼ç»„æˆæ¯åºåˆ—ï¼Œå­åºåˆ—ä¸æ¯åºåˆ—çš„å…³è”åº¦è¶Šé«˜ï¼Œåˆ™è¯¥è¯„ä»·å¯¹è±¡è¶Šä¼˜

#### 2. æ•°æ®æ— é‡çº²åŒ–å¤„ç†

ç”±äºå„ä¸ªå­åºåˆ—çš„å•ä½å’Œé‡çº²å¯èƒ½ä¸åŒï¼Œä¸ºäº†æ¶ˆé™¤è¿™ç§å·®å¼‚å¯¹ç»“æœçš„å½±å“ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œå³æ— é‡çº²åŒ–ï¼Œæ–¹æ³•æ˜¯å°†åºåˆ—ä¸­çš„æ¯ä¸ªæ•°æ®éƒ½é™¤ä»¥è¯¥åºåˆ—çš„å¹³å‡å€¼

$$
x_i^l(k) = \frac{x_i(k)}{\bar{x_i}}
$$

   å…¶ä¸­ $\bar{x_i} = \frac{1}{m} \sum_{k=1}^m x_i(k)$ï¼Œ$m$ ä¸ºåºåˆ—çš„é•¿åº¦

> æ¯åºåˆ—å’Œæ‰€æœ‰å­åºåˆ—éƒ½å¿…é¡»è¿›è¡Œç›¸åŒçš„æ— é‡çº²åŒ–å¤„ç†

#### 3. è®¡ç®—ç°è‰²å…³è”ç³»æ•°

ç°è‰²å…³è”ç³»æ•°ç”¨äºè¡¨ç¤ºåœ¨æ¯ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œå­åºåˆ—ä¸æ¯åºåˆ—çš„å…³è”ç¨‹åº¦ã€‚å…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

$$
\xi_i(k) = \frac{\min\limits_i \min\limits_k |x_0'(k) - x_i'(k)| + \rho \cdot \max\limits_i \max\limits_k |x_0'(k) - x_i'(k)|}{|x_0'(k) - x_i'(k)| + \rho \cdot \max\limits_i \max\limits_k |x_0'(k) - x_i'(k)|}
$$

å…¶ä¸­ï¼š

- $x_0'(k)$ æ˜¯æ¯åºåˆ—åœ¨ç¬¬$k$ä¸ªç‚¹çš„å€¼
- $x_i'(k)$ æ˜¯ç¬¬$i$ä¸ªå­åºåˆ—åœ¨ç¬¬$k$ä¸ªç‚¹çš„å€¼
- $|x_0'(k) - x_i'(k)|$ æ˜¯æ¯åºåˆ—ä¸å­åºåˆ—åœ¨ç¬¬$k$ç‚¹çš„ç»å¯¹å·®
- $\min\limits_i \min\limits_k |x_0'(k) - x_i'(k)|$ æ˜¯æ‰€æœ‰åºåˆ—åœ¨æ‰€æœ‰ç‚¹çš„ç»å¯¹å·®ä¸­çš„æœ€å°å€¼ï¼ˆä¸¤çº§æœ€å°å·®ï¼‰
- $\max\limits_i \max\limits_k |x_0'(k) - x_i'(k)|$ æ˜¯æ‰€æœ‰åºåˆ—åœ¨æ‰€æœ‰ç‚¹çš„ç»å¯¹å·®ä¸­çš„æœ€å¤§å€¼ï¼ˆä¸¤çº§æœ€å¤§å·®ï¼‰
- $\rho$æ˜¯åˆ†è¾¨ç³»æ•°ï¼Œå–å€¼èŒƒå›´ä¸º$(0, 1)$ã€‚$\rho$ çš„ä½œç”¨æ˜¯æé«˜å…³è”ç³»æ•°ä¹‹é—´çš„å·®å¼‚æ€§ã€‚$\rho$è¶Šå°ï¼Œåˆ†è¾¨èƒ½åŠ›è¶Šå¼ºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œ$\rho$å–å€¼ä¸º**0.5**

#### 4.  è®¡ç®—è®¡ç®—ç°è‰²å…³è”åº¦

ç°è‰²å…³è”åº¦æ˜¯æ‰€æœ‰æ—¶é—´ç‚¹ä¸Šå…³è”ç³»æ•°çš„å¹³å‡å€¼ï¼Œå®ƒç»¼åˆåœ°åæ˜ äº†å­åºåˆ—ä¸æ¯åºåˆ—çš„å…³è”ç¨‹åº¦ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š

$$
\gamma_i = \frac{1}{m} \sum_{k=1}^m \xi_i(k)
$$

å…¶ä¸­ï¼š
- $\gamma_i$ æ˜¯ç¬¬$i$ä¸ªå­åºåˆ—å¯¹æ¯åºåˆ—çš„ç°è‰²å…³è”åº¦
- $m$ æ˜¯åºåˆ—çš„é•¿åº¦

#### 5. å…³è”åº¦æ’åºä¸ç»“è®º

è®¡ç®—å‡ºæ‰€æœ‰å­åºåˆ—çš„ç°è‰²å…³è”åº¦åï¼š
1. æ ¹æ®å…³è”åº¦å¤§å°è¿›è¡Œæ’åº
2. å…³è”åº¦å€¼è¶Šå¤§ï¼Œè¯´æ˜è¯¥å­åºåˆ—ï¼ˆå› ç´ ï¼‰å¯¹æ¯åºåˆ—ï¼ˆç›®æ ‡ï¼‰çš„å½±å“è¶Šå¤§
3. é€šè¿‡æ’åºå¯ä»¥æ‰¾å‡ºå½±å“ç›®æ ‡çš„å…³é”®å› ç´ 

#### ç¤ºä¾‹

![](https://img.picgo.net/2025/07/08/25-07-08-1751965826387453101a95f74a853.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-175196583585965b401d520ecc70c.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751965842793bb361de149f3cabc.webp)

### ç¤ºä¾‹ä»£ç 

```python
import pandas as pd
import numpy as np


def grey_relational_analysis(data, rho=0.5, method='mean'):
    """
    ç°è‰²å…³è”åˆ†æ (Grey Relational Analysis, GRA) å‡½æ•°

    è¯¥å‡½æ•°å®ç°äº†ç°è‰²å…³è”åˆ†ææ–¹æ³•ï¼Œç”¨äºè¡¡é‡å¤šä¸ªå­åºåˆ—ä¸ä¸€ä¸ªæ¯åºåˆ—ä¹‹é—´çš„å…³è”ç¨‹åº¦ã€‚
    é€‚ç”¨äºæ•°å­¦å»ºæ¨¡ä¸­è¿›è¡Œå¤šå› ç´ å½±å“ç¨‹åº¦çš„åˆ†æã€‚

    å‚æ•° (Args):
        data (pd.DataFrame):
            è¾“å…¥çš„æ•°æ®æ¡†ã€‚
            æ ¼å¼è¦æ±‚ï¼š
            - ç¬¬ä¸€åˆ— (index 0) åº”ä¸ºå‚è€ƒåºåˆ— (æ¯åºåˆ—)ã€‚
            - åç»­åˆ— (index 1, 2, ...) åº”ä¸ºæ¯”è¾ƒåºåˆ— (å­åºåˆ—)ã€‚
            - æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªè§‚å¯Ÿç‚¹ (ä¾‹å¦‚ï¼Œå¹´ä»½ã€å®éªŒæ‰¹æ¬¡)ã€‚

        rho (float, optional):
            åˆ†è¾¨ç³»æ•°ï¼Œå–å€¼èŒƒå›´ (0, 1)ï¼Œé€šå¸¸å– 0.5ã€‚
            åˆ†è¾¨ç³»æ•°è¶Šå°ï¼Œå…³è”ç³»æ•°ä¹‹é—´çš„å·®å¼‚è¶Šå¤§ï¼ŒåŒºåˆ†èƒ½åŠ›è¶Šå¼ºã€‚é»˜è®¤ä¸º 0.5ã€‚

        method (str, optional):
            æ•°æ®æ— é‡çº²åŒ–çš„æ–¹æ³•ã€‚
            - 'initial': åˆå€¼åŒ–å¤„ç† (åºåˆ—çš„æ¯ä¸ªå€¼é™¤ä»¥ç¬¬ä¸€ä¸ªå€¼)ã€‚é€‚ç”¨äºæ•°æ®æœ‰æ˜æ˜¾å¢å‡è¶‹åŠ¿çš„æƒ…å†µã€‚
            - 'mean': å‡å€¼åŒ–å¤„ç† (åºåˆ—çš„æ¯ä¸ªå€¼é™¤ä»¥å‡å€¼)ã€‚é€‚ç”¨äºæ•°æ®æ³¢åŠ¨å¹³ç¨³çš„æƒ…å†µã€‚
            é»˜è®¤ä¸º 'initial'ã€‚

    è¿”å› (Returns):
        pd.DataFrame:
            ä¸€ä¸ªåŒ…å«åˆ†æç»“æœçš„æ•°æ®æ¡†ï¼ŒåŒ…æ‹¬ï¼š
            - 'GreyRelationalGrade': æ¯ä¸ªå­åºåˆ—çš„ç°è‰²å…³è”åº¦ã€‚
            - 'Rank': æ ¹æ®å…³è”åº¦é™åºæ’åˆ—çš„æ’åã€‚
    """

    # 1. æ•°æ®é¢„å¤„ç† (æ— é‡çº²åŒ–)
    # ---------------------------------
    # æ£€æŸ¥è¾“å…¥æ•°æ®æ˜¯å¦ä¸ºDataFrame
    if not isinstance(data, pd.DataFrame):
        raise ValueError("è¾“å…¥æ•°æ®å¿…é¡»æ˜¯ pandas DataFrame æ ¼å¼ã€‚")

    # æå–æ¯åºåˆ—å’Œå­åºåˆ—
    ref_series = data.iloc[:, 0]
    comp_series = data.iloc[:, 1:]

    # æ— é‡çº²åŒ–
    if method == 'initial':
        # åˆå€¼åŒ–
        normalized_ref = ref_series / ref_series.iloc[0]
        normalized_comp = comp_series / comp_series.iloc[0, :]
    elif method == 'mean':
        # å‡å€¼åŒ–
        normalized_ref = ref_series / ref_series.mean()
        normalized_comp = comp_series / comp_series.mean()
    else:
        raise ValueError("æ— é‡çº²åŒ–æ–¹æ³• 'method' åªèƒ½æ˜¯ 'initial' æˆ– 'mean'ã€‚")

    # 2. è®¡ç®—æ¯åºåˆ—ä¸å­åºåˆ—çš„å·®å€¼åºåˆ—
    # ---------------------------------
    # ä½¿ç”¨numpyçš„å¹¿æ’­æœºåˆ¶æ¥è®¡ç®—å·®çš„ç»å¯¹å€¼
    diff_series = np.abs(normalized_comp.values - normalized_ref.values.reshape(-1, 1))

    # 3. è®¡ç®—ä¸¤çº§æœ€å°å·®å’Œæœ€å¤§å·®
    # ---------------------------------
    min_diff = np.min(diff_series)
    max_diff = np.max(diff_series)

    # 4. è®¡ç®—ç°è‰²å…³è”ç³»æ•°
    # ---------------------------------
    # æ ¹æ®å…¬å¼è®¡ç®—å…³è”ç³»æ•°çŸ©é˜µ
    relational_coeffs = (min_diff + rho * max_diff) / (diff_series + rho * max_diff)

    # 5. è®¡ç®—ç°è‰²å…³è”åº¦
    # ---------------------------------
    # å¯¹æ¯ä¸ªå­åºåˆ—çš„å…³è”ç³»æ•°æ±‚å‡å€¼ï¼Œå¾—åˆ°å…³è”åº¦
    grey_relational_grade = relational_coeffs.mean(axis=0)

    # 6. ç»“æœæ•´ç†ä¸è¾“å‡º
    # ---------------------------------
    # åˆ›å»ºç»“æœDataFrame
    result_df = pd.DataFrame({
        'Factor': comp_series.columns,
        'GreyRelationalGrade': grey_relational_grade
    })

    # æŒ‰å…³è”åº¦é™åºæ’åº
    result_df = result_df.sort_values(by='GreyRelationalGrade', ascending=False)

    # æ·»åŠ æ’å
    result_df['Rank'] = range(1, len(result_df) + 1)

    # å°†Factoråˆ—è®¾ä¸ºç´¢å¼•ï¼Œæ–¹ä¾¿æŸ¥çœ‹
    result_df = result_df.set_index('Factor')

    return result_df


# --- ä½¿ç”¨ç¤ºä¾‹ ---
if __name__ == '__main__':
    # å‡è®¾æˆ‘ä»¬ç ”ç©¶å½±å“åœ°åŒºç”Ÿäº§æ€»å€¼(GDP)çš„å› ç´ 
    # æ•°æ®æ¥æºä¸ºè™šæ„ï¼Œä»…ç”¨äºæ¼”ç¤º

    # åˆ›å»ºä¸€ä¸ªDataFrame
    # ç¬¬ä¸€åˆ—æ˜¯æ¯åºåˆ— (GDP)
    # åç»­åˆ—æ˜¯å­åºåˆ— (å½±å“å› ç´ )
    example_data = pd.DataFrame({
        'åœ°åŒºç”Ÿäº§æ€»å€¼ (äº¿å…ƒ)': [100, 110, 125, 145, 170, 200],
        'å…¨ç¤¾ä¼šå›ºå®šèµ„äº§æŠ•èµ„ (äº¿å…ƒ)': [30, 35, 42, 50, 60, 75],
        'ç¤¾ä¼šæ¶ˆè´¹å“é›¶å”®æ€»é¢ (äº¿å…ƒ)': [50, 55, 60, 70, 80, 95],
        'åœ°æ–¹è´¢æ”¿æ”¶å…¥ (äº¿å…ƒ)': [20, 22, 26, 30, 35, 42],
        'å¹´æœ«æ€»äººå£ (ä¸‡äºº)': [200, 202, 205, 208, 212, 215]
    }, index=['2018å¹´', '2019å¹´', '2020å¹´', '2021å¹´', '2022å¹´', '2023å¹´'])

    print("--- åŸå§‹æ•°æ® ---")
    print(example_data)
    print("\n" + "=" * 40 + "\n")

    # è°ƒç”¨å‡½æ•°è¿›è¡Œç°è‰²å…³è”åˆ†æ
    # ä½¿ç”¨é»˜è®¤çš„ rho=0.5 å’Œ method='mean'
    try:
        analysis_result = grey_relational_analysis(example_data)

        print("--- ç°è‰²å…³è”åˆ†æç»“æœ ---")
        print(analysis_result)

        # ç»“æœè§£è¯»
        print("\n--- ç»“æœè§£è¯» ---")
        best_factor = analysis_result.index[0]
        print(f"æ ¹æ®ç°è‰²å…³è”åº¦åˆ†æï¼Œä¸'{example_data.columns[0]}'å…³è”åº¦æœ€é«˜çš„å› ç´ æ˜¯'{best_factor}'ã€‚")
        print("å„å› ç´ çš„å½±å“ç¨‹åº¦æ’åºå¦‚ä¸‹ï¼š")
        ranked_factors = " > ".join(analysis_result.index)
        print(ranked_factors)

    except ValueError as e:
        print(f"å‘ç”Ÿé”™è¯¯: {e}")
```

## æ¨¡ç³Šç»¼åˆè¯„ä»·æ³•

### æ¨¡ç³Šé›†åˆä¸éš¶å±å‡½æ•°

![](https://img.picgo.net/2025/07/08/25-07-08-175195847939970b6bcd71b1dfca6.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751958501060d1e95ed6d2bacb1d.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-175195851373399655e903b0c83a1.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751958526821acceb3d14e5840fc.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-17519585662431d800ff4b2021bcc.webp)

### éš¶å±å‡½æ•°çš„ç¡®å®šæ–¹æ³•

![](https://img.picgo.net/2025/07/08/25-07-08-17519585925694b1d23dccb9a9259.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751958642917849ea3dfbbe8fff3.webp)

### è¯„ä»·æ­¥éª¤

![](https://img.picgo.net/2025/07/08/25-07-08-175195865360823fb398c6d6066e8.webp)

### ç¤ºä¾‹

#### ç¤ºä¾‹ä¸€

![](https://img.picgo.net/2025/07/08/25-07-08-1751958666175c9c2f187803783c7.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-17519586880960c27bef291e31057.webp)

#### ç¤ºä¾‹äºŒ

![](https://img.picgo.net/2025/07/08/25-07-08-175195872133727a8722b3e7e5a97.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751958889962fa0b4577a37d7078.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-17519589067458df0e2ce6766bf83.webp)

![](https://img.picgo.net/2025/07/08/25-07-08-1751958928762333e7741a4ab8ec2.webp)

### å¤šå±‚æ¬¡æ¨¡ç³Šç»¼åˆè¯„ä»·

ç¤ºä¾‹

![](https://img.picgo.net/2025/07/08/25-07-08-1751958991476d510bf4d9595587f.webp)

## PCA ä¸»æˆåˆ†åˆ†æ

<iframe src="https://www.youtube.com/embed/o_cAOa5fMhE?si=22TFQYqdtT-ZSKHF" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen style="width: 100%; max-width: 1120px; aspect-ratio: 16/9; height: auto;"></iframe>

ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰æ˜¯ä¸€ç§è¢«å¹¿æ³›åº”ç”¨çš„æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¿ç•™æ•°æ®ä¸»è¦ä¿¡æ¯çš„å‰æä¸‹ï¼Œå¯¹æ•°æ®è¿›è¡Œ**é™ç»´**

ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯å¯»æ‰¾æ•°æ®ä¸­æ–¹å·®æœ€å¤§çš„æ–¹å‘ï¼Œå¹¶å°†åŸå§‹æ•°æ®æŠ•å½±åˆ°è¿™äº›æ–¹å‘ä¸Šï¼Œå½¢æˆæ–°çš„ã€ä¸ç›¸å…³çš„ç‰¹å¾ï¼Œå³ä¸»æˆåˆ†ã€‚è¿™äº›ä¸»æˆåˆ†æ˜¯åŸå§‹ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œå¹¶ä¸”æŒ‰ç…§å…¶æ‰€èƒ½è§£é‡Šçš„åŸå§‹æ•°æ®æ–¹å·®çš„å¤§å°è¿›è¡Œæ’åºã€‚ç¬¬ä¸€ä¸ªä¸»æˆåˆ†æ•æ‰äº†æ•°æ®ä¸­æœ€å¤§çš„æ–¹å·®ï¼Œç¬¬äºŒä¸ªä¸»æˆåˆ†åœ¨ä¸ç¬¬ä¸€ä¸ªä¸»æˆåˆ†æ­£äº¤ï¼ˆä¸ç›¸å…³ï¼‰çš„å‰æä¸‹æ•æ‰äº†å‰©ä½™æ–¹å·®ä¸­æœ€å¤§çš„éƒ¨åˆ†ï¼Œä»¥æ­¤ç±»æ¨ã€‚

é€šè¿‡ä¿ç•™æ–¹å·®æœ€å¤§çš„å‰å‡ ä¸ªä¸»æˆåˆ†ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æŸå¤±æœ€å°‘ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå®ç°æ•°æ®çš„é™ç»´

![](https://img.picgo.net/2025/07/05/25-07-05-1751710276334173464e102fc04f5.webp)

![](https://img.picgo.net/2025/07/05/25-07-05-1751713183169618b7237805eff96.gif)

### æ ¸å¿ƒæ­¥éª¤

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«nä¸ªæ ·æœ¬å’Œmä¸ªç‰¹å¾çš„æ•°æ®é›† Xï¼š

#### 1. æ•°æ®é¢„å¤„ç†

å¯¹æ•°æ®é›† X è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œæ–¹æ³•å¯ä»¥æ˜¯è®¡ç®—æ¯ä¸ªå˜é‡çš„å¹³å‡å€¼ï¼Œç„¶åä»æ¯ä¸ªæ•°æ®ç‚¹ä¸­å‡å»è¯¥å¹³å‡å€¼

![](https://img.picgo.net/2025/07/05/25-07-05-17517102172484443114b420bf496.webp)

#### 2. è®¡ç®—åæ–¹å·®çŸ©é˜µ

åæ–¹å·®çŸ©é˜µè¡¡é‡äº†ä¸åŒç‰¹å¾ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚çŸ©é˜µçš„å¯¹è§’çº¿å…ƒç´ æ˜¯å„ä¸ªç‰¹å¾çš„æ–¹å·®ï¼Œéå¯¹è§’çº¿å…ƒç´ æ˜¯ä¸åŒç‰¹å¾ä¹‹é—´çš„åæ–¹å·®

![](https://img.picgo.net/2025/07/05/25-07-05-17517103294117caf7d03bf42cc41.webp)

å½“æ•°æ®ä¸ºäºŒç»´æ—¶

![](https://img.picgo.net/2025/07/05/25-07-05-1751713188639eed431b950b1580c.gif)

> ä¸ºä»€ä¹ˆæ ·æœ¬æ–¹å·®/åæ–¹å·®çš„åˆ†æ¯æ˜¯ n-1ï¼Ÿ
>
> åœ¨ç»Ÿè®¡å­¦å’Œæ•°æ®åˆ†æä¸­ï¼Œå½“æˆ‘ä»¬è®¡ç®—ä¸€ä¸ªæ ·æœ¬çš„æ–¹å·®æˆ–åæ–¹å·®çŸ©é˜µæ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼šä¸ºä»€ä¹ˆå…¬å¼çš„åˆ†æ¯æ˜¯æ ·æœ¬æ•°é‡ `n` å‡ 1 (`n-1`)ï¼Œè€Œä¸æ˜¯ `n`ï¼Ÿ
>
> ç®€è€Œè¨€ä¹‹ï¼Œç­”æ¡ˆæ˜¯ï¼š**ä½¿ç”¨ `n-1` æ˜¯ä¸ºäº†å¾—åˆ°å¯¹æ€»ä½“æ–¹å·®çš„â€œæ— åä¼°è®¡â€**
>
> è¿™ä¸ªä¿®æ­£æ–¹æ³•åœ¨ç»Ÿè®¡å­¦ä¸Šè¢«ç§°ä¸º**è´å¡å°”æ ¡æ­£ (Bessel's Correction)**ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†æ‹†è§£è¿™ä¸ªæ¦‚å¿µ
>
> 1. æ ¸å¿ƒé—®é¢˜ï¼šç”¨æ ·æœ¬ä¼°è®¡æ€»ä½“
>
> é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»æ˜ç¡®æˆ‘ä»¬åœ¨åšä»€ä¹ˆã€‚åœ¨ç»å¤§å¤šæ•°æ•°æ®åˆ†æåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æ‰‹å¤´çš„æ•°æ®åªæ˜¯ä¸€ä¸ª**æ ·æœ¬ (Sample)**ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªæ›´å¤§çš„**æ€»ä½“ (Population)** ä¸­æŠ½å–å‡ºæ¥çš„ã€‚æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„ï¼Œæ˜¯å¸Œæœ›é€šè¿‡åˆ†æè¿™ä¸ªæ ·æœ¬æ¥æ¨æ–­æ•´ä¸ªæ€»ä½“çš„ç‰¹å¾
>
> * **æ€»ä½“ (Population)**ï¼šæˆ‘ä»¬ç ”ç©¶çš„å…¨éƒ¨å¯¹è±¡çš„é›†åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå›½å®¶æ‰€æœ‰æˆå¹´äººçš„èº«é«˜ã€‚æ€»ä½“çš„å‚æ•°ï¼ˆå¦‚æ€»ä½“å‡å€¼ $\mu$ å’Œæ€»ä½“æ–¹å·® $\sigma^2$ï¼‰æ˜¯å›ºå®šä½†é€šå¸¸æœªçŸ¥çš„
> * **æ ·æœ¬ (Sample)**ï¼šæˆ‘ä»¬ä»æ€»ä½“ä¸­å®é™…è§‚æµ‹åˆ°çš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚ä¾‹å¦‚ï¼ŒéšæœºæŠ½å–çš„ 1000 åæˆå¹´äººçš„èº«é«˜ã€‚æˆ‘ä»¬é€šè¿‡è®¡ç®—æ ·æœ¬çš„ç»Ÿè®¡é‡ï¼ˆå¦‚æ ·æœ¬å‡å€¼ $\bar{x}$ å’Œæ ·æœ¬æ–¹å·® $s^2$ï¼‰æ¥**ä¼°è®¡**æ€»ä½“çš„å‚æ•°
>
> 2. åå·®çš„æ¥æºï¼šä¸ºä½•é™¤ä»¥ `n` ä¼šå‡ºé”™ï¼Ÿ
>
> å¦‚æœæˆ‘ä»¬æ‹¥æœ‰æ•´ä¸ªæ€»ä½“çš„æ•°æ®ï¼Œå¹¶ä¸”çŸ¥é“æ€»ä½“çš„çœŸå®å‡å€¼ $\mu$ï¼Œé‚£ä¹ˆè®¡ç®—æ€»ä½“æ–¹å·®çš„å…¬å¼ç¡®å®æ˜¯é™¤ä»¥ `n`ï¼š
>
> $$
> \sigma^2 = \frac{1}{n}\sum_{i=1}^{n}(x_i - \mu)^2
> $$
>
> ç„¶è€Œï¼Œåœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹æ°¸è¿œä¸å¯èƒ½çŸ¥é“æ€»ä½“çš„çœŸå®å‡å€¼ $\mu$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªèƒ½é€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨æˆ‘ä»¬èƒ½è®¡ç®—å‡ºçš„**æ ·æœ¬å‡å€¼ $\bar{x}$** æ¥æ›¿ä»£å®ƒ
>
> é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œã€‚**ä¸€ä¸ªæ ·æœ¬ä¸­çš„æ•°æ®ç‚¹ï¼Œç¦»å®ƒä»¬è‡ªèº«çš„å‡å€¼ ($\bar{x}$) çš„ç¦»å·®å¹³æ–¹å’Œï¼Œæ€»æ˜¯å°äºæˆ–ç­‰äºå®ƒä»¬ç¦»æ€»ä½“çœŸå®å‡å€¼ ($\mu$) çš„ç¦»å·®å¹³æ–¹å’Œã€‚**
>
> $$\sum_{i=1}^{n}(x_i - \bar{x})^2 \le \sum_{i=1}^{n}(x_i - \mu)^2$$
>
> è¿™æ˜¯å› ä¸ºæ ·æœ¬å‡å€¼ $\bar{x}$ æœ¬èº«å°±æ˜¯ä¸ºäº†è®©è¿™ä¸ªå¹³æ–¹å’Œæœ€å°è€Œè®¡ç®—å‡ºæ¥çš„â€œä¸­å¿ƒç‚¹â€ï¼Œå¦‚æœåŠ å…¥æ ·æœ¬å¤–çš„æ•°æ®ï¼Œæ€»ä½“å‡å€¼$\mu$ä¸ä¸€å®šè¿˜ç­‰äº $\bar{x}$ ã€‚å› æ­¤ï¼Œä»æ ·æœ¬æ•°æ®æ‰©å±•åˆ°æ€»ä½“æ•°æ®æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä»ç”¨ $\bar{x}$ æ¥è®¡ç®—æ–¹å·®ï¼Œå¹¶ä¸”ä»ç„¶é™¤ä»¥ `n`ï¼Œç¦»å·®å¹³æ–¹å’Œå°±åå°ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœä¼šç³»ç»Ÿæ€§åœ°ã€æŒç»­åœ°**ä½ä¼°**çœŸå®çš„æ€»ä½“æ–¹å·® $\sigma^2$ã€‚è¿™ç§ç³»ç»Ÿæ€§çš„è¯¯å·®ï¼Œåœ¨ç»Ÿè®¡å­¦ä¸Šå°±ç§°ä¸º**åå·® (Bias)**
>
> 3. è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ `n-1` è¿›è¡Œæ— åä¼°è®¡
>
> ä¸ºäº†ä¿®æ­£è¿™ç§ç³»ç»Ÿæ€§çš„ä½ä¼°ï¼Œç»Ÿè®¡å­¦å®¶è¯æ˜ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨ `n-1` æ¥ä»£æ›¿ `n` ä½œä¸ºåˆ†æ¯
>
> **æ ·æœ¬æ–¹å·®çš„æ— åä¼°è®¡å…¬å¼ï¼š**
> $$s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2$$
>
> **æ ·æœ¬åæ–¹å·®çš„æ— åä¼°è®¡å…¬å¼ï¼š**
> $$\text{Cov}(X, Y) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})$$
>
> é€šè¿‡å°†åˆ†æ¯å‡å°ï¼ˆä» `n` å˜ä¸º `n-1`ï¼‰ï¼Œæˆ‘ä»¬äººä¸ºåœ°å°†è®¡ç®—ç»“æœè°ƒå¤§äº†ä¸€ç‚¹ã€‚è¿™ä¸ªè°ƒæ•´çš„å¹…åº¦æ°å¥½å¯ä»¥æŠµæ¶ˆæ‰ç”±äºä½¿ç”¨æ ·æœ¬å‡å€¼ $\bar{x}$ æ‰€å¸¦æ¥çš„ä½ä¼°åå·®
>
> ç»è¿‡è¿™æ ·æ ¡æ­£åï¼Œå¾—åˆ°çš„æ ·æœ¬æ–¹å·® $s^2$ å°±æˆäº†ä¸€ä¸ª**æ— åä¼°è®¡é‡ (Unbiased Estimator)**ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬ä»åŒä¸€ä¸ªæ€»ä½“ä¸­åå¤æŠ½å–å¤§é‡æ ·æœ¬ï¼Œå¹¶ä¸ºæ¯ä¸ªæ ·æœ¬éƒ½ç”¨ `n-1` å…¬å¼è®¡ç®—æ–¹å·®ï¼Œé‚£ä¹ˆæ‰€æœ‰è¿™äº›æ ·æœ¬æ–¹å·®çš„å¹³å‡å€¼å°†ä¼šéå¸¸æ¥è¿‘çœŸå®çš„æ€»ä½“æ–¹å·® $\sigma^2$
>
> é€šè¿‡**è‡ªç”±åº¦**ç›´è§‚è§£é‡Šï¼š
>
> æœ€åˆï¼Œæˆ‘ä»¬æœ‰ `n` ä¸ªç‹¬ç«‹çš„æ ·æœ¬è§‚æµ‹å€¼ï¼Œå¯ä»¥è¯´æˆ‘ä»¬æœ‰ `n` ä¸ªâ€œè‡ªç”±åº¦â€ï¼Œä½†æ˜¯ï¼Œä¸ºäº†è®¡ç®—æ–¹å·®ï¼Œæˆ‘ä»¬å¿…é¡»**å…ˆè®¡ç®—å‡ºæ ·æœ¬å‡å€¼ $\bar{x}$**ï¼Œä¸€æ—¦æ ·æœ¬å‡å€¼ $\bar{x}$ è¢«ç¡®å®šä¸‹æ¥ï¼Œè¿™ `n` ä¸ªæ ·æœ¬å€¼å°±å¤±å»äº†ä¸€éƒ¨åˆ†â€œè‡ªç”±â€ï¼Œå®ƒä»¬å—åˆ°äº†ä¸€ä¸ªçº¦æŸï¼šå®ƒä»¬çš„æ€»å’Œå¿…é¡»ç­‰äº $n \times \bar{x}$
> è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“äº†å‰ `n-1` ä¸ªæ ·æœ¬å€¼ï¼Œå¯ä»¥é€šè¿‡æ ·æœ¬å‡å€¼è®¡ç®—å‡ºæœ€åä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªæ ·æœ¬å€¼å°±å®Œå…¨è¢«ç¡®å®šäº†ï¼Œä¸å†â€œè‡ªç”±â€
> å› æ­¤ï¼Œåœ¨ä¼°ç®—æ ·æœ¬çš„å†…éƒ¨å˜å¼‚ç¨‹åº¦ï¼ˆå³æ–¹å·®ï¼‰æ—¶ï¼ŒçœŸæ­£èƒ½å¤Ÿæä¾›ç‹¬ç«‹ä¿¡æ¯çš„æ•°æ®ç‚¹åªæœ‰ `n-1` ä¸ª
> 
>æ‰€æœ‰ä¸»æµçš„ç§‘å­¦è®¡ç®—åº“ï¼ˆå¦‚ Python çš„ `numpy.cov`, `pandas.DataFrame.cov` ç­‰ï¼‰é»˜è®¤éƒ½æ˜¯ä½¿ç”¨ n-1 æ¥è®¡ç®—åæ–¹å·®çš„ï¼Œæ­£æ˜¯å› ä¸ºå®ƒä»¬çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ»¡è¶³æ•°æ®åˆ†æå’Œæ¨æ–­æ€§ç»Ÿè®¡çš„éœ€æ±‚


#### 3. è®¡ç®—ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡

å¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œç‰¹å¾å€¼åˆ†è§£

ç‰¹å¾å‘é‡ä»£è¡¨äº†ä¸»æˆåˆ†çš„æ–¹å‘ï¼Œå³æ•°æ®æ–¹å·®æœ€å¤§çš„æ–¹å‘

![](https://img.picgo.net/2025/07/05/25-07-05-17517103745343b98e4a87935df6b.webp)

ç‰¹å¾å€¼åˆ™è¡¨ç¤ºåœ¨å¯¹åº”ç‰¹å¾å‘é‡æ–¹å‘ä¸Šæ•°æ®çš„æ–¹å·®å¤§å°ã€‚ç‰¹å¾å€¼è¶Šå¤§ï¼Œè¯´æ˜è¯¥æ–¹å‘ä¸Šçš„æ–¹å·®è¶Šå¤§ï¼ŒåŒ…å«çš„åŸå§‹ä¿¡æ¯è¶Šå¤š

![](https://img.picgo.net/2025/07/05/25-07-05-1751710421772e9317186f11304f1.webp)

> è¯¥å›¾æ•°æ®ä»…ä½œç¤ºä¾‹ï¼Œå®é™…è®¡ç®—å¾—åˆ°çš„ç‰¹å¾å‘é‡åº”è¯¥æ˜¯**å•ä½æ­£äº¤**çš„

#### 4. é€‰æ‹©ä¸»æˆåˆ†

å°†ç‰¹å¾å€¼ä»å¤§åˆ°å°æ’åºï¼Œå¹¶é€‰æ‹©å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©ç´¯è®¡è´¡çŒ®ç‡ï¼ˆå³æ‰€é€‰ç‰¹å¾å€¼ä¹‹å’Œå æ‰€æœ‰ç‰¹å¾å€¼ä¹‹å’Œçš„æ¯”ä¾‹ï¼‰è¾¾åˆ°ä¸€ä¸ªé˜ˆå€¼ï¼ˆå¦‚85%æˆ–95%ï¼‰çš„å‰kä¸ªç‰¹å¾å‘é‡ï¼Œé€‰æ‹©è¿™kä¸ªæœ€å¤§çš„ç‰¹å¾å€¼åŠå…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œæ„æˆä¸€ä¸ªæŠ•å½±çŸ©é˜µ P

#### 5. æ•°æ®æŠ•å½±

å°†é¢„å¤„ç†åçš„æ•°æ® $X'$ ä¸æŠ•å½±çŸ©é˜µ $P$ ç›¸ä¹˜ï¼Œ$Z = X'P$ï¼Œå¾—åˆ°é™ç»´åçš„æ–°æ•°æ®é›† $Z$ã€‚è¿™ä¸ªæ–°æ•°æ®é›†çš„ç»´åº¦ä¸ºkï¼Œè¿œå°äºåŸå§‹æ•°æ®çš„ç»´åº¦å°†åŸå§‹ä¸­å¿ƒåŒ–æ•°æ® X 

### å±€é™æ€§

è¯¥æ–¹æ³•ä¾èµ–çº¿æ€§æŠ•å½±ï¼Œå½“æ•°æ®æ˜¯éçº¿æ€§çš„æ—¶å€™ï¼ŒPCAéš¾ä»¥å¸¦æ¥è¾ƒå¥½çš„æ•ˆæœ

![](https://img.picgo.net/2025/07/05/25-07-05-17517131939279bd820f9c07ddd39.gif)

> æ­¤æ—¶åº”ä½¿ç”¨UMAPç­‰

### ç¤ºä¾‹ä»£ç 

```python
import numpy as np
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

class PCAModel:
    """
    ä¸€ä¸ªç”¨äºä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰çš„ç±»ã€‚

    è¿™ä¸ªç±»å°è£…äº†PCAçš„æ ¸å¿ƒæ­¥éª¤ï¼ŒåŒ…æ‹¬æ•°æ®æ ‡å‡†åŒ–ã€è®¡ç®—åæ–¹å·®çŸ©é˜µã€
    æ±‚è§£ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡ï¼Œä»¥åŠå°†æ•°æ®æŠ•å½±åˆ°ä¸»æˆåˆ†ä¸Šã€‚
    å®ƒçš„APIè®¾è®¡æ¨¡ä»¿äº†scikit-learnï¼Œä¾¿äºé›†æˆåˆ°æœºå™¨å­¦ä¹ å·¥ä½œæµä¸­ã€‚

    å‚æ•°:
    n_components (int): å¸Œæœ›ä¿ç•™çš„ä¸»æˆåˆ†æ•°é‡ï¼ˆå³é™ç»´åçš„ç»´åº¦ï¼‰ã€‚
    """

    def __init__(self, n_components):
        """åˆå§‹åŒ–PCAæ¨¡å‹"""
        self.n_components = n_components
        self.components_ = None  # å­˜å‚¨ä¸»æˆåˆ†ï¼ˆæŠ•å½±çŸ©é˜µï¼‰
        self.mean_ = None  # å­˜å‚¨è®­ç»ƒæ•°æ®çš„å‡å€¼ï¼Œç”¨äºè½¬æ¢æ–°æ•°æ®
        self.explained_variance_ratio_ = None  # å­˜å‚¨æ¯ä¸ªä¸»æˆåˆ†çš„æ–¹å·®è´¡çŒ®ç‡

    def fit(self, X):
        """
        æ ¹æ®è¾“å…¥æ•°æ®Xæ¥è®­ç»ƒPCAæ¨¡å‹ã€‚

        è¿™ä¸ªæ–¹æ³•ä¼šè®¡ç®—å‡ºä¸»æˆåˆ†ï¼Œå¹¶å­˜å‚¨å®ƒä»¬ä»¥å¤‡åç»­è½¬æ¢ä½¿ç”¨ã€‚

        å‚æ•°:
        X (np.ndarray): è®­ç»ƒæ•°æ®ï¼Œå½¢çŠ¶ä¸º (n_samples, n_features)ã€‚
                        n_samplesæ˜¯æ ·æœ¬æ•°é‡ï¼Œn_featuresæ˜¯ç‰¹å¾æ•°é‡ã€‚
        """
        print("--- å¼€å§‹PCAæ‹Ÿåˆè¿‡ç¨‹ ---")
        # 1. æ•°æ®ä¸­å¿ƒåŒ–
        self.mean_ = np.mean(X, axis=0)
        X_centered = X - self.mean_
        print("æ­¥éª¤1: æ•°æ®ä¸­å¿ƒåŒ–å®Œæˆã€‚")
        print("æ•°æ®å‡å€¼ (self.mean_):\n", self.mean_)
        # print("ä¸­å¿ƒåŒ–åçš„æ•°æ® (å‰5è¡Œ):\n", X_centered[:5])
        print("-" * 20)

        # 2. è®¡ç®—åæ–¹å·®çŸ©é˜µ
        # æ³¨æ„ï¼šå¦‚æœç‰¹å¾æ•°é‡ > æ ·æœ¬æ•°é‡ï¼Œç›´æ¥åœ¨X_centeredä¸ŠåšSVDä¼šæ›´é«˜æ•ˆã€‚
        # è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ ‡å‡†æ–¹æ³•ã€‚np.covçš„rowvar=Falseè¡¨ç¤ºåˆ—ä»£è¡¨å˜é‡ã€‚
        cov_matrix = np.cov(X_centered, rowvar=False)
        print("æ­¥éª¤2: åæ–¹å·®çŸ©é˜µè®¡ç®—å®Œæˆã€‚")
        print("åæ–¹å·®çŸ©é˜µ (shape: {}):\n".format(cov_matrix.shape), cov_matrix)
        print("-" * 20)

        # 3. è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
        eigenvalues, eigenvectors = np.linalg.eigh(cov_matrix)
        print("æ­¥éª¤3: ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡è®¡ç®—å®Œæˆã€‚")
        print("ç‰¹å¾å€¼ (Eigenvalues):\n", eigenvalues)
        print("ç‰¹å¾å‘é‡ (Eigenvectors):\n", eigenvectors)
        print("-" * 20)

        # 4. å¯¹ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡è¿›è¡Œæ’åº
        # ä»å¤§åˆ°å°æ’åºç‰¹å¾å€¼ï¼Œå¹¶è·å–å¯¹åº”çš„ç´¢å¼•
        sorted_indices = np.argsort(eigenvalues)[::-1]
        sorted_eigenvalues = eigenvalues[sorted_indices]
        sorted_eigenvectors = eigenvectors[:, sorted_indices]
        print("æ­¥éª¤4: ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡æ’åºå®Œæˆã€‚")
        print("æ’åºåçš„ç‰¹å¾å€¼:\n", sorted_eigenvalues)
        print("æ’åºåçš„ç‰¹å¾å‘é‡:\n", sorted_eigenvectors)
        print("-" * 20)

        # 5. é€‰æ‹©å‰kä¸ªä¸»æˆåˆ†
        self.components_ = sorted_eigenvectors[:, :self.n_components]
        print(f"æ­¥éª¤5: é€‰æ‹©å‰ {self.n_components} ä¸ªä¸»æˆåˆ†æ„æˆæŠ•å½±çŸ©é˜µã€‚")
        print("æŠ•å½±çŸ©é˜µ (self.components_):\n", self.components_)
        print("-" * 20)

        # (å¯é€‰) è®¡ç®—å¹¶å­˜å‚¨æ–¹å·®è´¡çŒ®ç‡
        total_variance = np.sum(sorted_eigenvalues)
        self.explained_variance_ratio_ = sorted_eigenvalues[:self.n_components] / total_variance
        print("--- PCAæ‹Ÿåˆè¿‡ç¨‹ç»“æŸ ---\n")
        return self

    def transform(self, X):
        """
        ä½¿ç”¨è®­ç»ƒå¥½çš„PCAæ¨¡å‹æ¥è½¬æ¢æ•°æ®Xã€‚

        å‚æ•°:
        X (np.ndarray): éœ€è¦è½¬æ¢çš„æ•°æ®ï¼Œå½¢çŠ¶ä¸º (n_samples, n_features)ã€‚

        è¿”å›:
        np.ndarray: é™ç»´åçš„æ•°æ®ï¼Œå½¢çŠ¶ä¸º (n_samples, n_components)ã€‚
        """
        if self.mean_ is None or self.components_ is None:
            raise RuntimeError("åœ¨è°ƒç”¨transformä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨fitæ–¹æ³•ã€‚")

        # ä½¿ç”¨è®­ç»ƒæ—¶è®¡ç®—çš„å‡å€¼æ¥ä¸­å¿ƒåŒ–æ–°æ•°æ®
        X_centered = X - self.mean_

        # 6. å°†æ•°æ®æŠ•å½±åˆ°ä¸»æˆåˆ†ä¸Š
        X_transformed = np.dot(X_centered, self.components_)

        return X_transformed

    def fit_transform(self, X):
        """
        è®­ç»ƒæ¨¡å‹å¹¶å¯¹åŒä¸€æ•°æ®è¿›è¡Œè½¬æ¢ã€‚

        å‚æ•°:
        X (np.ndarray): éœ€è¦è®­ç»ƒå’Œè½¬æ¢çš„æ•°æ®ã€‚

        è¿”å›:
        np.ndarray: é™ç»´åçš„æ•°æ®ã€‚
        """
        self.fit(X)
        return self.transform(X)


# --- å¦‚ä½•ä½¿ç”¨ PCAModel ç±»çš„ç¤ºä¾‹ ---
if __name__ == '__main__':
    # 1. ç”Ÿæˆåˆ†å¸ƒå‘ˆä¸‰è§’å½¢çš„ç¤ºä¾‹æ•°æ®
    print("--- ç”Ÿæˆç¤ºä¾‹æ•°æ® ---")
    np.random.seed(44)

    # *** ä¿®æ”¹ç‚¹ï¼šç”Ÿæˆåœ¨ä¸‰ç»´ç©ºé—´ä¸­å‘ˆä¸‰è§’å½¢åˆ†å¸ƒçš„æ•°æ® ***
    # a. åœ¨2Dæ½œåœ¨ç©ºé—´ä¸­å®šä¹‰ä¸€ä¸ªä¸‰è§’å½¢çš„é¡¶ç‚¹
    triangle_vertices = np.array([
        [0, 0],
        [15, 2],
        [7, 12]
    ])

    # b. ä½¿ç”¨é‡å¿ƒåæ ‡æ³•åœ¨ä¸‰è§’å½¢å†…éƒ¨ç”Ÿæˆå‡åŒ€åˆ†å¸ƒçš„ç‚¹
    n_samples = 250
    s = np.random.rand(n_samples, 1)
    t = np.random.rand(n_samples, 1)

    # ç¡®ä¿ç‚¹åœ¨ä¸‰è§’å½¢å†…
    outside = s + t > 1
    s[outside] = 1 - s[outside]
    t[outside] = 1 - t[outside]

    # è®¡ç®—2Dç‚¹çš„ä½ç½®ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æ½œåœ¨å˜é‡
    latent_vars = (1 - s - t) * triangle_vertices[0] + s * triangle_vertices[1] + t * triangle_vertices[2]

    # c. å°†2Dç‚¹æ˜ å°„åˆ°3Dç©ºé—´å¹¶æ·»åŠ å™ªå£°
    # å®šä¹‰ä¸€ä¸ªæ—‹è½¬/æ˜ å°„çŸ©é˜µ
    mapping_matrix = np.array([
        [0.6, 0.4],
        [-0.5, 0.8],
        [0.7, -0.2]
    ])

    noise = np.random.normal(0, 0.8, (n_samples, 3))  # å™ªå£°å¯ä»¥è°ƒå°ä¸€ç‚¹è®©å½¢çŠ¶æ›´æ˜æ˜¾
    original_data = latent_vars.dot(mapping_matrix.T) + noise

    print("åŸå§‹æ•°æ®å½¢çŠ¶:", original_data.shape)
    print("=" * 40, "\n")

    # 2. åˆå§‹åŒ–å¹¶ä½¿ç”¨PCAæ¨¡å‹
    # æˆ‘ä»¬å¸Œæœ›å°†æ•°æ®ä»3ç»´é™åˆ°2ç»´
    n_components = 2
    pca_model = PCAModel(n_components=n_components)

    # è®­ç»ƒæ¨¡å‹å¹¶è½¬æ¢æ•°æ®
    transformed_data = pca_model.fit_transform(original_data)

    print(f"\nå°†æ•°æ®ä»3ç»´é™è‡³{n_components}ç»´ã€‚")
    print("é™ç»´åæ•°æ®å½¢çŠ¶:", transformed_data.shape)

    # 3. æŸ¥çœ‹ç»“æœ
    print("\næ¯ä¸ªä¸»æˆåˆ†çš„æ–¹å·®è´¡çŒ®ç‡:", pca_model.explained_variance_ratio_)
    print(f"å‰ {n_components} ä¸ªä¸»æˆåˆ†ç´¯è®¡æ–¹å·®è´¡çŒ®ç‡: {np.sum(pca_model.explained_variance_ratio_):.4f}")

    # 4. å¯è§†åŒ–ç»“æœ
    fig = plt.figure(figsize=(12, 6))
    plt.suptitle("PCA é™ç»´ç¤ºä¾‹ (ä¸‰è§’å½¢æ•°æ®)", fontsize=16)

    # ç»˜åˆ¶åŸå§‹æ•°æ®ï¼ˆ3Dï¼‰
    ax1 = fig.add_subplot(121, projection='3d')
    ax1.scatter(original_data[:, 0], original_data[:, 1], original_data[:, 2], c='b', marker='o', alpha=0.6)
    ax1.set_title("åŸå§‹æ•°æ® (3D)")
    ax1.set_xlabel("ç‰¹å¾ 1")
    ax1.set_ylabel("ç‰¹å¾ 2")
    ax1.set_zlabel("ç‰¹å¾ 3")

    # ç»˜åˆ¶é™ç»´åçš„æ•°æ®ï¼ˆ2Dï¼‰
    ax2 = fig.add_subplot(122)
    ax2.scatter(transformed_data[:, 0], transformed_data[:, 1], c='r', marker='^', alpha=0.6)
    ax2.set_title(f"é™ç»´åçš„æ•°æ® ({n_components}D)")
    ax2.set_xlabel("ç¬¬ä¸€ä¸»æˆåˆ†")
    ax2.set_ylabel("ç¬¬äºŒä¸»æˆåˆ†")
    ax2.grid(True)
    ax2.axhline(0, color='grey', lw=0.5)
    ax2.axvline(0, color='grey', lw=0.5)
    ax2.set_aspect('equal', adjustable='box')  # ä¿æŒé•¿å®½æ¯”ï¼Œè®©å½¢çŠ¶æ›´çœŸå®

    plt.tight_layout(rect=[0, 0, 1, 0.96])
    plt.show()

```

## UMAP æ•°æ®é™ç»´

UMAP æ˜¯åŠ æ‹¿å¤§çš„Tutte Institute for Mathematics and Computingçš„Lelandç ”ç©¶å‘˜äº2018å¹´æå‡ºçš„ä¸€ç§å¯¹æ•°æ®éçº¿æ€§é™ç»´å¹¶å¯è§†åŒ–çš„æŠ€æœ¯ï¼Œå› å…¶å‡ºè‰²çš„å¯è§†åŒ–è´¨é‡å’Œè®¡ç®—é€Ÿåº¦è€Œå¤‡å—é’ç

### æ•°æ®é™ç»´é€‚ç”¨åœºæ™¯

#### æ ¸å¿ƒåº”ç”¨åœºæ™¯ä¸€ï¼šæ¢ç´¢æ€§æ•°æ®åˆ†æ (EDA) ä¸å¯è§†åŒ–æ´å¯Ÿ
è¿™æ˜¯UMAPæœ€å¼ºå¤§ã€æœ€ç›´æ¥çš„åº”ç”¨åœºæ™¯ã€‚å½“ä½ æ‹¿åˆ°ä¸€ä»½å¤æ‚çš„é«˜ç»´æ•°æ®æ—¶ï¼Œé¦–è¦ä»»åŠ¡å°±æ˜¯ç†è§£å®ƒ

* ç›®æ ‡ï¼š
    * å¿«é€Ÿç†è§£æ•°æ®çš„å†…åœ¨ç»“æ„å’Œåˆ†å¸ƒ
    * è¯†åˆ«æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨å¤©ç„¶çš„**ç°‡ç¾¤ (Clusters)**
    * å‘ç°**å¼‚å¸¸ç‚¹ (Outliers)**
    * ä¸ºåç»­çš„å»ºæ¨¡æ–¹å‘**æä¾›å‡è®¾å’Œçµæ„Ÿ**

* æ“ä½œæ–¹æ³•ï¼š
    1.  æå–æ•°æ®çš„ä¸»è¦ç‰¹å¾åˆ—
    2.  ä½¿ç”¨UMAPå°†å…¶é™è‡³2ç»´æˆ–3ç»´
    3.  ç»˜åˆ¶æ•£ç‚¹å›¾
    4.  **å…³é”®ä¸€æ­¥**ï¼šå¦‚æœæ•°æ®æœ‰æ ‡ç­¾ï¼ˆå¦‚å®¢æˆ·ç­‰çº§ã€äº§å“ç±»åˆ«ï¼‰æˆ–éœ€è¦é¢„æµ‹çš„ç›®æ ‡å€¼ï¼ˆå¦‚æˆ¿ä»·ã€æ»¡æ„åº¦ï¼‰ï¼Œç”¨è¿™äº›å€¼ç»™æ•£ç‚¹å›¾**ä¸Šè‰²**

* ç«èµ›ä»·å€¼ï¼šä¸€å¼ é«˜è´¨é‡çš„UMAPé™ç»´å›¾æœ¬èº«å°±æ˜¯è®ºæ–‡ä¸­ä¸€ä¸ªé‡è¦çš„åŠ åˆ†é¡¹ã€‚å®ƒå¯ä»¥ç›´è§‚åœ°å±•ç¤ºä½ å¯¹æ•°æ®çš„æ·±åˆ»ç†è§£ï¼Œå¹¶ä¸ºä½ åç»­çš„æ¨¡å‹é€‰æ‹©æä¾›å¼ºæœ‰åŠ›çš„æ”¯æ’‘ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‘ç°æ•°æ®æ¸…æ™°åœ°åˆ†æˆäº†ä¸‰ç°‡ï¼Œé‚£ä¹ˆåç»­é‡‡ç”¨åˆ†æ®µå»ºæ¨¡æˆ–èšç±»åˆ†æå°±å˜å¾—é¡ºç†æˆç« 

#### æ ¸å¿ƒåº”ç”¨åœºæ™¯äºŒï¼šèšç±»åˆ†æçš„é»„é‡‘æ­æ¡£
åœ¨æ— ç›‘ç£å­¦ä¹ é—®é¢˜ä¸­ï¼Œç›´æ¥åœ¨é«˜ç»´æ•°æ®ä¸Šè¿›è¡Œèšç±»ï¼Œæ•ˆæœå¾€å¾€ä¸ä½³ï¼Œå› ä¸ºâ€œç»´åº¦ç¾éš¾â€ä¼šä½¿å¾—è·ç¦»åº¦é‡å¤±æ•ˆ

* ç›®æ ‡ï¼š
    * æå‡èšç±»ç®—æ³•ï¼ˆå¦‚K-Means, DBSCAN, å±‚æ¬¡èšç±»ï¼‰çš„æ•ˆæœ
    * åœ¨å™ªå£°å’Œæ— å…³ç‰¹å¾ä¸­ï¼Œæç‚¼å‡ºæ•°æ®æœ€æœ¬è´¨çš„æµå½¢ç»“æ„

* æ“ä½œæ–¹æ³•ï¼š
    1.  **é¢„å¤„ç†**ï¼šä½¿ç”¨UMAPå°†åŸå§‹é«˜ç»´ç‰¹å¾é™åˆ°ä¸€ä¸ªé€‚ä¸­çš„ç»´åº¦ï¼ˆä¸ä¸€å®šæ˜¯2D/3Dï¼Œå¯ä»¥æ˜¯5~20ç»´ï¼‰
    2.  **èšç±»**ï¼šåœ¨é™ç»´åçš„æ•°æ®ä¸Šè¿è¡Œèšç±»ç®—æ³•
    3.  **éªŒè¯**ï¼šå¯ä»¥å°†èšç±»ç»“æœä½œä¸ºæ–°çš„æ ‡ç­¾ï¼Œåœ¨2D/3Dçš„UMAPå›¾ä¸Šè¿›è¡Œå¯è§†åŒ–ï¼ŒéªŒè¯èšç±»æ•ˆæœ

* ç«èµ›ä»·å€¼ï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸æˆç†Ÿä¸”æœ‰æ•ˆçš„æŠ€æœ¯æµç¨‹ã€‚å®ƒèƒ½å¸®ä½ æ‰¾åˆ°æ¯”ç›´æ¥èšç±»æ›´æœ‰æ„ä¹‰ã€æ›´ç¨³å¥çš„åˆ†ç¾¤ç»“æœï¼Œæ˜¯è§£å†³å„ç±»â€œå®¢æˆ·åˆ†ç¾¤â€ã€â€œç”¨æˆ·ç”»åƒâ€ã€â€œäº§å“å®šä½â€ç­‰é—®é¢˜çš„åˆ©å™¨

#### è¾…åŠ©åº”ç”¨åœºæ™¯ (è°¨æ…ä½¿ç”¨)ï¼šä½œä¸ºè¡¥å……ç‰¹å¾å¢å¼ºæ¨¡å‹
åœ¨æ„å»ºé¢„æµ‹æ¨¡å‹æ—¶ï¼ŒUMAPä¹Ÿå¯ä»¥æ‰®æ¼”ä¸€ä¸ªè¾…åŠ©è§’è‰²ï¼Œä¸ºæ¨¡å‹æä¾›é¢å¤–çš„éçº¿æ€§ä¿¡æ¯

* ç›®æ ‡ï¼š
    * åœ¨ä¸ç‰ºç‰²æ¨¡å‹å¯è§£é‡Šæ€§çš„å‰æä¸‹ï¼Œå¯èƒ½åœ°æå‡é¢„æµ‹ç²¾åº¦
    * å¸®åŠ©çº¿æ€§æ¨¡å‹æˆ–ç¥ç»ç½‘ç»œç­‰ä¸æ“…é•¿è‡ªåŠ¨æŒ–æ˜äº¤å‰ç‰¹å¾çš„æ¨¡å‹ï¼Œæ•æ‰åˆ°æ•°æ®çš„éçº¿æ€§å…³ç³»

* æ“ä½œæ–¹æ³•ï¼š
    1.  **ä¿ç•™æ‰€æœ‰åŸå§‹ç‰¹å¾**
    2.  è¿è¡ŒUMAPï¼Œç”Ÿæˆå°‘æ•°å‡ ä¸ªï¼ˆå¦‚2~5ä¸ªï¼‰UMAPåˆ†é‡
    3.  å°†è¿™äº›UMAPåˆ†é‡**ä½œä¸ºæ–°çš„ç‰¹å¾åˆ—ï¼Œè¿½åŠ åˆ°åŸå§‹æ•°æ®è¡¨çš„æœ«å°¾**
    4.  å°†è¿™ä¸ªå¢å¼ºåçš„æ•°æ®é›†å–‚ç»™ä½ çš„é¢„æµ‹æ¨¡å‹

* ç«èµ›ä»·å€¼ï¼šè¿™æ˜¯ä¸€ç§â€œé”¦ä¸Šæ·»èŠ±â€çš„ç­–ç•¥ã€‚å®ƒä¿ç•™äº†åŸå§‹ç‰¹å¾ï¼Œä¿è¯äº†æ¨¡å‹çš„åŸºæœ¬å¯è§£é‡Šæ€§ï¼ŒåŒæ—¶å¼•å…¥äº†æ•°æ®ç»“æ„çš„å®è§‚ä¿¡æ¯ã€‚è™½ç„¶å¯¹XGBoostè¿™ç±»å¼ºæ‚çš„æ ‘æ¨¡å‹æå‡å¯èƒ½æœ‰é™ï¼Œä½†æœ‰æ—¶èƒ½å¸¦æ¥æ„æƒ³ä¸åˆ°çš„å¾®å°æå‡ï¼Œåœ¨å®šç¨¿é˜¶æ®µå¯ä»¥å°è¯•

#### ä¸é€‚ç”¨åœºæ™¯ï¼ˆä¸¥ç¦ä½¿ç”¨ï¼‰ï¼šç›´æ¥æ›¿ä»£åŸå§‹ç‰¹å¾ç”¨äºé¢„æµ‹æ¨¡å‹
è¿™æ˜¯åˆå­¦è€…æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼Œå°¤å…¶æ˜¯åœ¨å›å½’æˆ–åˆ†ç±»é¢„æµ‹é—®é¢˜ä¸­

* ç›®æ ‡ï¼ˆé”™è¯¯åœ°è®¤ä¸ºï¼‰ï¼šé€šè¿‡é™ç»´æ¥ç®€åŒ–é¢„æµ‹æ¨¡å‹

* ä¸ºä»€ä¹ˆä¸å¯å–ï¼š
    1.  **ä¸§å¤±å¯è§£é‡Šæ€§ï¼ˆè‡´å‘½ç¼ºé™·ï¼‰**ï¼šä½ çš„æ¨¡å‹è¾“å…¥å˜æˆäº†æ— æ³•è§£é‡Šçš„â€œUMAPåˆ†é‡1â€ã€â€œUMAPåˆ†é‡2â€ã€‚ä½ æ— æ³•åœ¨è®ºæ–‡ä¸­è§£é‡Šâ€œé¢ç§¯â€ã€â€œå§å®¤æ•°â€ç­‰å…·ä½“å› ç´ å¯¹æˆ¿ä»·çš„å½±å“ï¼Œè¿™åœ¨æ•°å­¦å»ºæ¨¡ä¸­æ˜¯ä¸å¯æ¥å—çš„
    2.  **ä¸¢å¤±å…³é”®é¢„æµ‹ä¿¡æ¯**ï¼šUMAPä¸ºäº†ä¿æŒæ‹“æ‰‘ç»“æ„ï¼Œå¯èƒ½ä¼šä¸¢å¼ƒå¯¹é¢„æµ‹ç›®æ ‡è‡³å…³é‡è¦çš„ä¿¡æ¯ã€‚ä¸€ä¸ªç‰¹å¾å¯èƒ½åœ¨ç»“æ„ä¸Šä¸é‡è¦ï¼Œä½†åœ¨æ•°å€¼é¢„æµ‹ä¸Šèµ·å†³å®šæ€§ä½œç”¨

* ç«èµ›å»ºè®®ï¼šåœ¨ä»»ä½•éœ€è¦è§£é‡Šå˜é‡ä¸å› å˜é‡å…³ç³»çš„é¢„æµ‹é—®é¢˜ä¸­ï¼Œ**æ°¸è¿œä¸è¦**ç”¨UMAPçš„è¾“å‡ºå®Œå…¨æ›¿ä»£ä½ çš„åŸå§‹ç‰¹å¾

### æ ¸å¿ƒæ­¥éª¤

#### 1. æ„å»ºé«˜ç»´å›¾

ç›®æ ‡æ˜¯æ•æ‰æ•°æ®åœ¨é«˜ç»´ç©ºé—´ä¸­çš„å†…åœ¨æ‹“æ‰‘ç»“æ„ï¼Œå³ç‚¹ä¸ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»å’Œè¿œè¿‘äº²ç–

1. å¯»æ‰¾è¿‘é‚»ç‚¹ (Nearest Neighbors)

å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®ç‚¹ï¼ŒUMAP é¦–å…ˆä¼šä½¿ç”¨æ ‡å‡†çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ KD-æ ‘æˆ– NNDescentï¼‰æ‰¾åˆ°å®ƒæœ€è¿‘çš„ `k` ä¸ªé‚»å±…ã€‚è¿™é‡Œçš„ `k` æ˜¯ UMAP **æœ€é‡è¦çš„è¶…å‚æ•°ä¹‹ä¸€**ï¼Œåä¸º `n_neighbors`

- **`n_neighbors` çš„ä½œç”¨**ï¼šè¿™ä¸ªå‚æ•°å†³å®šäº† UMAP åœ¨æ„å»ºå›¾æ—¶å…³æ³¨çš„å±€éƒ¨é‚»åŸŸæœ‰å¤šå¤§
  - è¾ƒå°çš„ `k` å€¼ä¼šä½¿ UMAP æ›´å…³æ³¨æ•°æ®çš„**å±€éƒ¨ç»“æ„**ï¼Œå¯èƒ½å¯¼è‡´æœ€ç»ˆçš„æŠ•å½±å›¾å‘ˆç°å‡ºè®¸å¤šç»†å°çš„ã€ç‹¬ç«‹çš„ç°‡
  - è¾ƒå¤§çš„ `k` å€¼ä¼šè¿«ä½¿ UMAP è€ƒè™‘æ›´å¹¿é˜”çš„é‚»åŸŸï¼Œä»è€Œæ›´å¥½åœ°ä¿ç•™æ•°æ®çš„**å…¨å±€ç»“æ„**ï¼Œä½†å¯èƒ½ä¼šç‰ºç‰²ä¸€äº›å±€éƒ¨ç»†èŠ‚

![](https://img.picgo.net/2025/07/06/25-07-06-1751791372018bf45accedbcfcd7a.webp)

2. ä¸ºæ¯ä¸ªç‚¹è®¡ç®—å±€éƒ¨è·ç¦»å°ºåº¦

å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ªç‚¹ $x_i$ï¼ŒUMAP éƒ½ä¼šç¡®å®šä¸€ä¸ªä¸“å±äºå®ƒçš„è·ç¦»å°ºåº¦ $\sigma_i$ã€‚å¯¹äº**æ¯ä¸€ä¸ª**æ•°æ®ç‚¹ $x_i$ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæŒ‡æ•°è¡°å‡å‡½æ•°æ¥è®¡ç®—å®ƒä¸æ‰€æœ‰å…¶ä»–ç‚¹ $x_j$ çš„è¿æ¥æƒé‡ï¼Œé‚£ä¹ˆæ‰€æœ‰è¿™äº›æƒé‡çš„æ€»å’Œåº”è¯¥ç­‰äºä¸€ä¸ªé¢„è®¾çš„å¸¸æ•°ï¼Œå³ $\log_2(k)$

$$
\sum_{j=1}^k \exp\left(-\frac{d(x_i, x_{ij}) - \rho_i}{\sigma_i}\right) = \log_2(k)
$$

åœ¨è¿™ä¸ªå…¬å¼ä¸­ï¼š

- **$x_{ij}$**ï¼šè¡¨ç¤ºç‚¹ $x_i$ çš„ç¬¬ $j$ ä¸ªæœ€è¿‘é‚»å±…ã€‚æ±‚å’Œåªåœ¨ $x_i$ çš„ $k$ ä¸ªè¿‘é‚»ä¸­è¿›è¡Œ
- **$d(x_i, x_{ij})$**ï¼šç‚¹ $x_i$ ä¸å…¶ç¬¬ $j$ ä¸ªè¿‘é‚»ä¹‹é—´çš„åŸå§‹è·ç¦»
- **$\rho_i$**ï¼šç‚¹ $x_i$ åˆ°å®ƒç¬¬ä¸€ä¸ªæœ€è¿‘é‚»å±…çš„è·ç¦»
- **$\sigma_i$**ï¼šæˆ‘ä»¬è¦æ±‚è§£çš„æœªçŸ¥æ•°ï¼Œå³ç‚¹ $x_i$ ç‹¬æœ‰çš„å±€éƒ¨è·ç¦»å°ºåº¦

> ç”±äºä¸Šé¢çš„æ–¹ç¨‹å¾ˆéš¾ç›´æ¥è§£å‡º$\sigma_i$ï¼ŒUMAP é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥æ±‚è§£

æœ€ç»ˆï¼Œæ¯ä¸ªæ•°æ®ç‚¹ $x_i$ éƒ½æ‹¥æœ‰äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ $\sigma_i$ å€¼ï¼Œè¿™ä¸ªå€¼åæ˜ äº†å®ƒæ‰€åœ¨é‚»åŸŸçš„æ•°æ®å¯†åº¦

- **å¯¹äºå¤„åœ¨æ•°æ®å¯†é›†åŒºåŸŸçš„ç‚¹**ï¼šå®ƒçš„ `k` ä¸ªè¿‘é‚»è·ç¦»å®ƒéå¸¸è¿‘ã€‚ä¸ºäº†è®©æƒé‡æ€»å’Œè¾¾åˆ° $\log_2(k)$ï¼ŒæŒ‡æ•°è¡°å‡å¿…é¡»éå¸¸å¿«ï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦ä¸€ä¸ª**å¾ˆå°çš„ $\sigma_i$**ã€‚è¿™å°±åƒæ˜¯ç”¨ä¸€æŠŠç²¾å¯†çš„"å°å°ºå­"æ¥æµ‹é‡å®ƒå’Œé‚»å±…é—´çš„ç»†å¾®å·®åˆ«
- **å¯¹äºå¤„åœ¨æ•°æ®ç¨€ç–åŒºåŸŸçš„ç‚¹**ï¼šå®ƒçš„ `k` ä¸ªè¿‘é‚»è·ç¦»å®ƒéå¸¸è¿œã€‚ä¸ºäº†è®©æƒé‡æ€»å’Œä¸è‡³äºå› ä¸ºè·ç¦»å¤ªå¤§è€Œå˜å¾—è¿‡å°ï¼ŒæŒ‡æ•°è¡°å‡å¿…é¡»éå¸¸æ…¢ï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦ä¸€ä¸ª**å¾ˆå¤§çš„ $\sigma_i$**ã€‚è¿™å°±åƒæ˜¯ç”¨ä¸€æŠŠ"å¤§å°ºå­"æ¥è¿æ¥è¿œæ–¹çš„é‚»å±…

3. è®¡ç®—è¾¹æƒé‡

![](https://img.picgo.net/2025/07/06/25-07-06-175179136014804333daf22bddf2a.webp)

å…¶ä¸­ï¼š

- **$d(x_i, x_j)$** æ˜¯ç‚¹ $x_i$ å’Œ $x_j$ ä¹‹é—´çš„åŸå§‹è·ç¦»ï¼ˆå¦‚æ¬§æ°è·ç¦»ï¼‰

- **$\rho_i$** æ˜¯ç‚¹ $x_i$ åˆ°å…¶ç¬¬ä¸€ä¸ªæœ€è¿‘é‚»å±…çš„è·ç¦»ã€‚è®¾ç½®è¿™ä¸ªé¡¹æ˜¯ä¸ºäº†ç¡®ä¿æ¯ä¸ªç‚¹è‡³å°‘å’Œå®ƒçš„æœ€è¿‘é‚»æœ‰å¾ˆå¼ºçš„è¿æ¥ï¼Œå¢åŠ æµå½¢çš„å±€éƒ¨è¿é€šæ€§

- **$\sigma_i$** æ˜¯ä¸Šä¸€æ­¥è®¡ç®—å‡ºçš„å±€éƒ¨è·ç¦»å°ºåº¦

ç„¶åè¿›è¡Œåˆå¹¶

![](https://img.picgo.net/2025/07/06/25-07-06-17517913827157557513c6e367f1e.webp)

#### 2. æ„å»ºä½ç»´å›¾

1. åˆå§‹åŒ–ä½ç»´è¡¨ç¤º

UMAP é¦–å…ˆä¼šåœ¨ç›®æ ‡ä½ç»´ç©ºé—´ä¸­ä¸ºæ¯ä¸ªæ•°æ®ç‚¹éšæœºï¼ˆæˆ–ä½¿ç”¨æ›´æ™ºèƒ½çš„æ–¹æ³•å¦‚è°±åµŒå…¥ï¼‰ç”Ÿæˆä¸€ä¸ªåˆå§‹ä½ç½®ã€‚æˆ‘ä»¬å°†è¿™äº›ç‚¹è®°ä¸º $y_1, y_2, \dots, y_n$

2. è®¡ç®—ä½ç»´ç›¸ä¼¼åº¦

ä¸é«˜ç»´ç©ºé—´ç±»ä¼¼ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦åœ¨ä½ç»´ç©ºé—´ä¸­è®¡ç®—ç‚¹ä¸ç‚¹ä¹‹é—´çš„è¿æ¥å¼ºåº¦ $q_{ij}$ã€‚UMAP åœ¨è¿™é‡Œåšäº†ä¸€ä¸ªç®€åŒ–ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªé¢„è®¾çš„ã€ä¸ä¾èµ–äºæ•°æ®çš„æ›²çº¿æ—ï¼ˆé€šå¸¸æ˜¯ t åˆ†å¸ƒæ—çš„å˜ç§ï¼‰æ¥è®¡ç®—ç›¸ä¼¼åº¦

![](https://img.picgo.net/2025/07/06/25-07-06-17517914671143e5e78e456fde506.webp)

é¦–å…ˆï¼ŒUMAP æ ¹æ®ç”¨æˆ·è®¾å®šçš„`min_dist`å®šä¹‰äº†ä¸€ä¸ªç†æƒ³çš„ç›®æ ‡å…³ç³»æ›²çº¿ï¼ˆè“è‰²åˆ†æ®µæ›²çº¿ï¼‰ï¼Œç„¶è€Œï¼Œè¿™ä¸ªåˆ†æ®µå‡½æ•°åœ¨ `min_dist` é‚£ä¸ªç‚¹æ˜¯ä¸å¯å¯¼çš„ï¼Œä¸æ–¹ä¾¿ç”¨äºåç»­çš„æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚å› æ­¤ï¼ŒUMAP éœ€è¦æ‰¾åˆ°ä¸€æ¡å…‰æ»‘çš„ã€å¯å¯¼çš„æ›²çº¿å»é€¼è¿‘å®ƒã€‚è¿™æ¡å…‰æ»‘æ›²çº¿å°±æ˜¯å‰é¢æåˆ°çš„ $q_{ij} = (1 + a(y_i - y_j)^{2b})^{-1}$

ç®—æ³•é€šè¿‡éçº¿æ€§æœ€å°äºŒä¹˜æ³•ï¼ˆNon-Linear Least Square Fitï¼‰ï¼Œè°ƒæ•´ $a$ å’Œ $b$ çš„å€¼ï¼Œä½¿å¾—çº¢è‰²æ›²çº¿çš„å½¢çŠ¶ä¸è“è‰²æ›²çº¿çš„å½¢çŠ¶å°½å¯èƒ½åœ°æ¥è¿‘

#### 3. æ„å»ºæŸå¤±å‡½æ•° & è¿­ä»£ä¼˜åŒ–

UMAP çš„ç›®æ ‡æ˜¯è®©ä½ç»´çš„ç›¸ä¼¼åº¦åˆ†å¸ƒ $Q$ å°½å¯èƒ½åœ°åŒ¹é…é«˜ç»´çš„ç›¸ä¼¼åº¦åˆ†å¸ƒ $P$ã€‚å®ƒé€šè¿‡ä¸€ä¸ªç§°ä¸ºäº¤å‰ç†µ (Cross-Entropy) çš„æŸå¤±å‡½æ•°æ¥è¡¡é‡è¿™ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š

$$
\text{Cost} = \sum_{i,j} \left[ P_{ij} \log \left( \frac{P_{ij}}{Q_{ij}} \right) + (1 - P_{ij}) \log \left( \frac{1 - P_{ij}}{1 - Q_{ij}} \right) \right]
$$

è¿™ä¸ªæŸå¤±å‡½æ•°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š

- **å¸å¼•åŠ›é¡¹** ($P_{ij} \log (\ldots)$)ï¼šå¦‚æœä¸¤ä¸ªç‚¹åœ¨é«˜ç»´ç©ºé—´ä¸­æ˜¯è¿‘é‚» ($P_{ij}$ è¾ƒå¤§)ï¼Œè¿™ä¸ªé¡¹ä¼šä¿ƒä½¿å®ƒä»¬åœ¨ä½ç»´ç©ºé—´ä¸­ä¹Ÿç›¸äº’é è¿‘ï¼ˆå¢å¤§ $Q_{ij}$ï¼‰
- **æ’æ–¥åŠ›é¡¹** ($(1 - P_{ij}) \log (\ldots)$)ï¼šå¦‚æœä¸¤ä¸ªç‚¹åœ¨é«˜ç»´ç©ºé—´ä¸­ä¸æ˜¯è¿‘é‚» ($P_{ij}$ è¾ƒå°)ï¼Œè¿™ä¸ªé¡¹ä¼šä¿ƒä½¿å®ƒä»¬åœ¨ä½ç»´ç©ºé—´ä¸­ç›¸äº’è¿œç¦»ï¼ˆå‡å° $Q_{ij}$ï¼‰

> UMAP ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ (Stochastic Gradient Descent, SGD) ç®—æ³•æ¥æœ€å°åŒ–è¿™ä¸ªæŸå¤±å‡½æ•°ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç®—æ³•ä¼šéšæœºå–æ ·å›¾ä¸­çš„ä¸€æ¡è¾¹ï¼ˆä¸€ä¸ªç‚¹å¯¹ï¼‰ï¼Œè®¡ç®—å…¶äº§ç”Ÿçš„å¸å¼•åŠ›å’Œæ’æ–¥åŠ›ï¼Œç„¶åæ²¿ç€æ¢¯åº¦çš„æ–¹å‘å¾®è°ƒä½ç»´ç©ºé—´ä¸­è¿™ä¸¤ä¸ªç‚¹çš„ä½ç½®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸æ–­é‡å¤ï¼Œç›´åˆ°ä½ç»´çš„å¸ƒå±€æ”¶æ•›åˆ°ä¸€ä¸ªç¨³å®šçš„çŠ¶æ€ï¼Œå³æŸå¤±å‡½æ•°è¾¾åˆ°æœ€å°å€¼
>
> ä¸ºäº†æé«˜æ•ˆç‡ï¼ŒUMAP åœ¨æ’æ–¥åŠ›è®¡ç®—ä¸Šä½¿ç”¨äº†è´Ÿé‡‡æ · (Negative Sampling) çš„ä¼˜åŒ–æŠ€å·§ï¼Œå³å¯¹äºæ¯ä¸ªæ­£æ ·æœ¬ï¼ˆç›¸è¿çš„è¾¹ï¼‰ï¼Œåªé‡‡æ ·å°‘æ•°å‡ ä¸ªè´Ÿæ ·æœ¬ï¼ˆä¸ç›¸è¿çš„è¾¹ï¼‰æ¥è®¡ç®—æ’æ–¥åŠ›ï¼Œè€Œä¸æ˜¯è®¡ç®—æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´çš„æ’æ–¥åŠ›ï¼Œè¿™æå¤§åœ°æå‡äº†ç®—æ³•çš„é€Ÿåº¦

æœ€ç»ˆå¾—åˆ°çš„ä½ç»´ç‚¹é›† $\{ y_i \}$ å°±æ˜¯ UMAP çš„é™ç»´ç»“æœ

### è¶…å‚æ•°

![](https://img.picgo.net/2025/07/06/25-07-06-17517924391331a78f259f0d1492c.webp)

![](https://img.picgo.net/2025/07/06/25-07-06-17517924479753deac321a953e137.webp)

### ç¤ºä¾‹ä»£ç 

```python
# -*- coding: utf-8 -*-
"""
pip install umap-learn scikit-learn matplotlib pandas
"""

import umap
import numpy as np
from sklearn.datasets import make_blobs
from sklearn.preprocessing import StandardScaler
import matplotlib.pyplot as plt
import warnings

# è®¾ç½®ç»˜å›¾é£æ ¼å’Œå¤„ç†ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜
plt.rcParams['font.sans-serif'] = ['SimHei']  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.rcParams['axes.unicode_minus'] = False  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
warnings.filterwarnings('ignore')

print(f"UMAP version: {umap.__version__}")

# è¿™é‡Œæˆ‘ä»¬é¦–å…ˆç”¨ make_blobs ç”Ÿæˆä¸€äº›æ¨¡æ‹Ÿæ•°æ®ï¼Œä»¥æ¼”ç¤ºUMAPçš„æ•ˆæœã€‚
# è¿™äº›æ•°æ®åœ¨é«˜ç»´ç©ºé—´ä¸­æœ‰æ˜æ˜¾çš„åˆ†ç°‡ç»“æ„ã€‚

# ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
# n_samples: æ ·æœ¬æ•°é‡
# n_features: æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾ç»´åº¦ï¼ˆå³åŸå§‹ç»´åº¦ï¼‰
# centers: ç°‡çš„æ•°é‡
# cluster_std: ç°‡å†…æ•°æ®çš„ç¦»æ•£ç¨‹åº¦
# random_state: éšæœºç§å­ï¼Œç¡®ä¿æ¯æ¬¡è¿è¡Œç»“æœä¸€è‡´
data, labels = make_blobs(n_samples=1500, n_features=50, centers=8, cluster_std=2.5, random_state=42)

print(f"åŸå§‹æ•°æ®ç»´åº¦: {data.shape}")
print(f"æ ‡ç­¾æ•°é‡: {len(np.unique(labels))}")

# **é‡è¦æ­¥éª¤**: æ•°æ®æ ‡å‡†åŒ–
# UMAPå¯¹æ•°æ®çš„å°ºåº¦æ•æ„Ÿï¼Œè¿›è¡Œæ ‡å‡†åŒ–å¤„ç†é€šå¸¸èƒ½å¾—åˆ°æ›´å¥½çš„ç»“æœã€‚
scaled_data = StandardScaler().fit_transform(data)

# è¿™æ˜¯UMAPçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚æˆ‘ä»¬å°†é«˜ç»´æ•°æ®é™è‡³2ç»´ï¼Œæ–¹ä¾¿å¯è§†åŒ–ã€‚

print("\nå¼€å§‹è¿›è¡Œ2Dé™ç»´...")

# åˆå§‹åŒ–UMAPæ¨¡å‹
# å…³é”®è¶…å‚æ•°è§£é‡Š (ç«èµ›ä¸­æœ€éœ€è¦å…³æ³¨å’Œè°ƒè¯•çš„å‚æ•°):
# n_neighbors: è¿‘é‚»ç‚¹æ•°é‡ã€‚æ§åˆ¶UMAPå¦‚ä½•å¹³è¡¡å±€éƒ¨å’Œå…¨å±€ç»“æ„ã€‚
#              å€¼è¶Šå°ï¼Œè¶Šå…³æ³¨å±€éƒ¨ç»“æ„ï¼Œå¯èƒ½æŠŠæ•°æ®åˆ†æˆå¾ˆå¤šå°å›¢ã€‚
#              å€¼è¶Šå¤§ï¼Œè¶Šå…³æ³¨å…¨å±€ç»“æ„ï¼Œèƒ½çœ‹åˆ°æ›´å¤§èŒƒå›´çš„å…³è”ã€‚
#              é€šå¸¸å»ºè®®å–å€¼èŒƒå›´åœ¨ 5 åˆ° 50 ä¹‹é—´ã€‚è¿™æ˜¯æœ€é‡è¦çš„å‚æ•°ï¼
# min_dist: æ§åˆ¶é™ç»´åç‚¹ä¸ç‚¹ä¹‹é—´çš„æœ€å°è·ç¦»ã€‚
#           å€¼è¶Šå°ï¼Œç‚¹ç°‡ä¼šè¶Šç´§å¯†ã€‚
#           å€¼è¶Šå¤§ï¼Œç‚¹ç°‡ä¼šè¶Šæ¾æ•£ã€‚
#           è¯¥å‚æ•°ä¸»è¦å½±å“å¯è§†åŒ–æ•ˆæœã€‚
# n_components: é™ç»´åçš„ç›®æ ‡ç»´åº¦ã€‚å¯è§†åŒ–é€šå¸¸è®¾ä¸º2æˆ–3ã€‚
# metric: è®¡ç®—è·ç¦»çš„æ–¹å¼ï¼Œé»˜è®¤ä¸º'euclidean'ï¼ˆæ¬§æ°è·ç¦»ï¼‰ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æƒ…å†µã€‚
# random_state: éšæœºç§å­ï¼Œç¡®ä¿ç»“æœå¯å¤ç°ã€‚

reducer_2d = umap.UMAP(
    n_neighbors=15,
    min_dist=0.1,
    n_components=2,
    metric='euclidean',
    random_state=42
)

# è®­ç»ƒæ¨¡å‹å¹¶è¿›è¡Œé™ç»´
embedding_2d = reducer_2d.fit_transform(scaled_data)

print(f"2Dé™ç»´åæ•°æ®ç»´åº¦: {embedding_2d.shape}")

#4. 2Dç»“æœå¯è§†åŒ–
print("å¼€å§‹ç»˜åˆ¶2Dé™ç»´ç»“æœå›¾...")

plt.figure(figsize=(12, 10))
# ä½¿ç”¨åŸå§‹çš„æ ‡ç­¾æ¥ç»™é™ç»´åçš„ç‚¹ä¸Šè‰²ï¼Œä»¥éªŒè¯é™ç»´æ•ˆæœ
scatter = plt.scatter(
    embedding_2d[:, 0],
    embedding_2d[:, 1],
    c=labels,
    cmap='Spectral',  # ä½¿ç”¨å…‰è°±è‰²å›¾ï¼Œè§†è§‰æ•ˆæœå¥½
    s=5  # ç‚¹çš„å¤§å°
)

plt.title('UMAP 2D é™ç»´ç»“æœ (n_neighbors=15, min_dist=0.1)', fontsize=16)
plt.xlabel('UMAP Component 1', fontsize=12)
plt.ylabel('UMAP Component 2', fontsize=12)
plt.gca().set_aspect('equal', 'datalim')

# æ·»åŠ é¢œè‰²å›¾ä¾‹
legend1 = plt.legend(handles=scatter.legend_elements()[0],
                     labels=[f'Cluster {i}' for i in range(len(np.unique(labels)))],
                     title="æ•°æ®ç°‡")
plt.gca().add_artist(legend1)
plt.grid(True, linestyle='--', alpha=0.6)
plt.show()

# **ç»“æœè§£è¯»**:
# å¦‚æœUMAPè¿è¡Œè‰¯å¥½ï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°å›¾ä¸­ç›¸åŒé¢œè‰²çš„ç‚¹èšé›†åœ¨ä¸€èµ·ï¼Œå½¢æˆäº†æ¸…æ™°çš„ç°‡ã€‚
# è¿™è¯´æ˜UMAPæˆåŠŸåœ°åœ¨é«˜ç»´ç©ºé—´ä¸­æ‰¾åˆ°äº†æ•°æ®çš„å†…åœ¨ç»“æ„ï¼Œå¹¶å°†å…¶å‘ˆç°åœ¨äº†2Då¹³é¢ä¸Šã€‚


# 5. UMAPæ¨¡å‹è®­ç»ƒä¸3Dé™ç»´åŠå¯è§†åŒ–
# æœ‰æ—¶3Då¯è§†åŒ–èƒ½æä¾›æ¯”2Dæ›´ä¸°å¯Œçš„ä¿¡æ¯ã€‚

print("\nå¼€å§‹è¿›è¡Œ3Dé™ç»´...")

# å°† n_components è®¾ä¸º 3
reducer_3d = umap.UMAP(
    n_neighbors=15,
    min_dist=0.1,
    n_components=3,
    metric='euclidean',
    random_state=42
)

embedding_3d = reducer_3d.fit_transform(scaled_data)
print(f"3Dé™ç»´åæ•°æ®ç»´åº¦: {embedding_3d.shape}")

# ç»˜åˆ¶3Dæ•£ç‚¹å›¾
print("å¼€å§‹ç»˜åˆ¶3Dé™ç»´ç»“æœå›¾...")
fig = plt.figure(figsize=(14, 12))
ax = fig.add_subplot(111, projection='3d')

ax.scatter(
    embedding_3d[:, 0],
    embedding_3d[:, 1],
    embedding_3d[:, 2],
    c=labels,
    cmap='Spectral',
    s=5
)

ax.set_title('UMAP 3D é™ç»´ç»“æœ', fontsize=16)
ax.set_xlabel('UMAP Component 1', fontsize=12)
ax.set_ylabel('UMAP Component 2', fontsize=12)
ax.set_zlabel('UMAP Component 3', fontsize=12)
plt.show()
```

##  DEA æ•°æ®åŒ…ç»œåˆ†æ

### I. ä¸€ç§ç”¨äºç»©æ•ˆè¯„ä¼°çš„éå‚æ•°å‰æ²¿æ–¹æ³•

#### A. å®šä¹‰ç›¸å¯¹æ•ˆç‡ä¸æ ‡æ†ç®¡ç†

æ•°æ®åŒ…ç»œåˆ†æï¼ˆData Envelopment Analysis, DEAï¼‰æ˜¯ä¸€ç§æºäºè¿ç­¹å­¦å’Œç»æµå­¦çš„å®è¯æ€§ã€éå‚æ•°åŒ–æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯è¯„ä¼°ä¸€ç»„åŒè´¨å®ä½“ï¼ˆç§°ä¸ºå†³ç­–å•å…ƒï¼ŒDecision Making Units, DMUï¼‰çš„ç›¸å¯¹ç”Ÿäº§æ•ˆç‡ã€‚åœ¨æœ¬è´¨ä¸Šï¼ŒDEAæ˜¯ä¸€ç§æ ‡æ†ç®¡ç†ï¼ˆBenchmarkingï¼‰å·¥å…·ï¼Œå®ƒé€šè¿‡æ¯”è¾ƒæ¯ä¸ªDMUçš„å¤šç§æŠ•å…¥ï¼ˆInputsï¼‰ä¸å¤šç§äº§å‡ºï¼ˆOutputsï¼‰çš„ç»„åˆï¼Œæ¥è¡¡é‡å…¶ç»©æ•ˆè¡¨ç°ã€‚æ•ˆç‡çš„åŸºæœ¬æ¦‚å¿µè¢«å®šä¹‰ä¸ºæ‰€æœ‰åŠ æƒäº§å‡ºçš„æ€»å’Œä¸æ‰€æœ‰åŠ æƒæŠ•å…¥çš„æ€»å’Œä¹‹æ¯”ã€‚

DEAçš„åº”ç”¨èŒƒå›´æå…¶å¹¿æ³›ï¼Œå·²æˆåŠŸæ¸—é€åˆ°å›½é™…é“¶è¡Œä¸šã€åŒ»ç–—å¥åº·æœåŠ¡ã€æ•™è‚²è¯„ä¼°ã€è­¦åŠ¡è¿è¥ã€ç‰©æµç®¡ç†ä¹ƒè‡³ç»æµå¯æŒç»­æ€§ç ”ç©¶ç­‰å¤šä¸ªé¢†åŸŸã€‚è¿‘å¹´æ¥ï¼Œå…¶åº”ç”¨ç”šè‡³æ‰©å±•åˆ°äº†è¯„ä¼°è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹çš„æ€§èƒ½ï¼Œå¹¶åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸå±•ç°å‡ºå·¨å¤§çš„æ½œåŠ›ã€‚

ä¸ä¼ ç»Ÿçš„ç»©æ•ˆè¯„ä¼°æ–¹æ³•ä¸åŒï¼ŒDEAå¹¶ä¸è¯•å›¾æ„å»ºä¸€ä¸ªæ™®é€‚çš„ã€ä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€œç”Ÿäº§å‡½æ•°â€ï¼Œè€Œæ˜¯æ—¨åœ¨ä»å®è·µæ•°æ®ä¸­è¯†åˆ«å‡ºæœ€é«˜æ•ˆçš„è¿è¥æ¨¡å¼ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å…¶æˆä¸ºä¸€ä¸ªæå…·å®è·µä»·å€¼çš„ç®¡ç†å·¥å…·ã€‚

#### B. æ€æƒ³æº¯æºï¼šä»æ³•é›·å°”å‰æ²¿åˆ°CCRæ¨¡å‹

DEAçš„æ™ºåŠ›è°±ç³»å¯ä»¥è¿½æº¯åˆ°ç»æµå­¦å®¶è¿ˆå…‹å°”Â·è©¹å§†æ–¯Â·æ³•é›·å°”ï¼ˆMichael James Farrellï¼‰äº1957å¹´å‘è¡¨çš„å¼€åˆ›æ€§è®ºæ–‡ã€Šç”Ÿäº§æ•ˆç‡çš„è¡¡é‡ã€‹ã€‚æ³•é›·å°”æå‡ºäº†ä¸€ä¸ªé©å‘½æ€§çš„æ€æƒ³ï¼šç”¨â€œéé¢„è®¾çš„ç”Ÿäº§å‡½æ•°â€æ¥ä¼°ç®—æ•ˆç‡ï¼Œå³é€šè¿‡å¯¹è§‚æµ‹æ•°æ®è¿›è¡Œåˆ†æ®µçº¿æ€§åŒ…ç»œæ¥æ„å»ºæ•ˆç‡å‰æ²¿ï¼Œè€Œéäº‹å…ˆå‡å®šä¸€ä¸ªç‰¹å®šçš„å‡½æ•°å½¢å¼ï¼ˆå¦‚Cobb-Douglaså‡½æ•°ï¼‰ã€‚æ³•é›·å°”çš„å¦ä¸€ä¸ªå…³é”®è´¡çŒ®åœ¨äºï¼Œä»–å°†æ•´ä½“æ•ˆç‡åˆ†è§£ä¸ºä¸¤ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š

1. **æŠ€æœ¯æ•ˆç‡ï¼ˆTechnical Efficiencyï¼‰**ï¼šè¡¡é‡åœ¨ç»´æŒäº§å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼ŒæŠ•å…¥èƒ½å¤Ÿè¢«æŒ‰æ¯”ä¾‹ç¼©å‡çš„ç¨‹åº¦ï¼Œå³æ¶ˆé™¤èµ„æºæµªè´¹çš„èƒ½åŠ›ã€‚
2. **é…ç½®æ•ˆç‡ï¼ˆAllocative Efficiencyï¼‰**ï¼šä¹Ÿç§°ä»·æ ¼æ•ˆç‡ï¼Œè¡¡é‡åœ¨ç»™å®šæŠ•å…¥å“ä»·æ ¼ä¸‹ï¼Œä¼ä¸šæ˜¯å¦ä½¿ç”¨äº†æˆæœ¬æœ€ä½çš„æŠ•å…¥ç»„åˆã€‚

å°½ç®¡æ³•é›·å°”çš„ç†è®ºæå…·æ´å¯ŸåŠ›ï¼Œä½†åœ¨éšåçš„äºŒåå¹´é‡Œï¼Œå®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«å­¦æœ¯ç•Œæ‰€å¿½è§†ï¼Œéƒ¨åˆ†åŸå› åœ¨äºå…¶è®¡ç®—çš„å¤æ‚æ€§ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤šäº§å‡ºé—®é¢˜æ—¶ã€‚

çœŸæ­£çš„çªç ´å‘ç”Ÿåœ¨1978å¹´ï¼Œäºšä¼¯æ‹‰ç½•Â·æŸ¥æ©æ–¯ï¼ˆAbraham Charnesï¼‰ã€å¨å»‰Â·WÂ·åº“ç€ï¼ˆWilliam W. Cooperï¼‰å’Œçˆ±å¾·åå¤šÂ·ç½—å¾·æ–¯ï¼ˆEdwardo Rhodesï¼‰å‘è¡¨äº†é¢˜ä¸ºã€Šè¡¡é‡å†³ç­–å•å…ƒçš„æ•ˆç‡ã€‹çš„é‡Œç¨‹ç¢‘å¼è®ºæ–‡ã€‚è¿™ç¯‡è®ºæ–‡è¢«å…¬è®¤ä¸ºDEAé¢†åŸŸçš„å¥ åŸºä¹‹ä½œï¼Œå…¶å¼•ç”¨æ¬¡æ•°è¶…è¿‡700æ¬¡ï¼ˆæˆªè‡³1999å¹´ï¼‰å¹¶æŒç»­å¢é•¿ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸€çªç ´çš„å‚¬åŒ–å‰‚æ˜¯åº“ç€çš„åšå£«ç”Ÿç½—å¾·æ–¯ï¼Œä»–å°†æ³•é›·å°”é‚£ç¯‡æ²‰å¯‚äº†äºŒåå¹´çš„è®ºæ–‡å¸¦åˆ°äº†å¯¼å¸ˆçš„è§†é‡ä¸­ã€‚æŸ¥æ©æ–¯ã€åº“ç€å’Œç½—å¾·æ–¯ï¼ˆCharnes, Cooper, and Rhodesï¼Œç®€ç§°CCRï¼‰å·§å¦™åœ°è¿ç”¨çº¿æ€§è§„åˆ’ï¼ˆLinear Programmingï¼‰æ–¹æ³•ï¼Œå°†æ³•é›·å°”çš„æ€æƒ³æ“ä½œåŒ–ï¼Œä½¿å…¶èƒ½å¤Ÿè½»æ¾å¤„ç†å¤šæŠ•å…¥ã€å¤šäº§å‡ºçš„å¤æ‚æƒ…å†µï¼Œå¹¶æ­£å¼å°†è¿™ä¸€æ–¹æ³•å‘½åä¸ºâ€œæ•°æ®åŒ…ç»œåˆ†æâ€ã€‚

CCRæ¨¡å‹çš„è¯ç”Ÿå¹¶éçº¯ç²¹çš„ç†è®ºæ¨æ¼”ï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªæ£˜æ‰‹çš„ç°å®é—®é¢˜ã€‚å½“æ—¶ï¼Œç½—å¾·æ–¯çš„åšå£«è®ºæ–‡æ­£èšç„¦äºè¯„ä¼°ä¸€é¡¹åä¸ºâ€œè´¯å½»é¡¹ç›®â€ï¼ˆProgram Follow Throughï¼‰çš„ç¾å›½è”é‚¦æ”¿åºœè®¡åˆ’ï¼Œè¯¥è®¡åˆ’æ—¨åœ¨å¸®åŠ©å¼±åŠ¿å„¿ç«¥ã€‚è¿™ä¸ªé¡¹ç›®çš„æŠ•å…¥å’Œäº§å‡ºæä¸ºå¤æ‚ä¸”éš¾ä»¥ç”¨è´§å¸è¡¡é‡ï¼Œä¾‹å¦‚æŠ•å…¥åŒ…æ‹¬â€œæ¯äº²é™ªä¼´å­©å­é˜…è¯»çš„æ—¶é—´â€ï¼Œäº§å‡ºåˆ™åŒ…æ‹¬â€œæå‡å¼±åŠ¿å„¿ç«¥çš„è‡ªå°Šå¿ƒâ€ç­‰ã€‚ä¼ ç»Ÿçš„ç»æµå­¦æˆ–ç»Ÿè®¡å­¦æ–¹æ³•åœ¨é¢å¯¹è¿™ç±»å¼‚è´¨æ€§ã€éå…¬åº¦å’Œç¼ºä¹å¸‚åœºä»·æ ¼çš„å˜é‡æ—¶æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚CCRæ¨¡å‹é€šè¿‡çº¿æ€§è§„åˆ’ä¸ºæ¯ä¸ªDMUå¯»æ‰¾ä¸€ç»„â€œæœ€æœ‰åˆ©â€çš„æƒé‡ï¼Œä»è€Œåœ¨æ— éœ€é¢„è®¾ä»·æ ¼æˆ–å‡½æ•°å½¢å¼çš„å‰æä¸‹è¯„ä¼°æ•ˆç‡ï¼Œå®Œç¾åœ°è§£å†³äº†è¿™ä¸€éš¾é¢˜ã€‚è¿™æ­ç¤ºäº†DEAä¸€ä¸ªæœ€æ ¸å¿ƒä¸”æŒä¹…çš„ä¼˜åŠ¿ï¼šå®ƒèƒ½å¤Ÿåœ¨æŠ•å…¥äº§å‡ºæŒ‡æ ‡å¼‚è´¨ã€æ— æ³•é€šçº¦ä¸”ç¼ºä¹å¸‚åœºä»·æ ¼çš„å¤æ‚åœºæ™¯ä¸‹è¿›è¡Œæœ‰æ•ˆçš„ç»©æ•ˆè¯„ä¼°ï¼Œè¿™åœ¨å…¬å…±éƒ¨é—¨å’Œéè¥åˆ©ç»„ç»‡çš„è¯„ä¼°ä¸­å°¤ä¸ºå¸¸è§ã€‚

#### C. ä¸ºä½•é€‰æ‹©éå‚æ•°æ–¹æ³•

DEAä¹‹æ‰€ä»¥è¢«å¹¿æ³›é‡‡ç”¨ï¼Œå…¶éå‚æ•°ç‰¹æ€§æ˜¯æ ¹æœ¬åŸå› ã€‚ä¸å‚æ•°åŒ–æ–¹æ³•ï¼ˆå¦‚å›å½’åˆ†ææˆ–éšæœºå‰æ²¿åˆ†æSFAï¼‰ç›¸æ¯”ï¼ŒDEAçš„ä¼˜åŠ¿ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ã€‚

é¦–å…ˆï¼Œå‚æ•°åŒ–æ–¹æ³•è¦æ±‚ç ”ç©¶è€…å¿…é¡»é¢„å…ˆè®¾å®šä¸€ä¸ªå…·ä½“çš„ç”Ÿäº§æˆ–æˆæœ¬å‡½æ•°å½¢å¼ã€‚è¿™ä¸€å‡è®¾å…·æœ‰å¾ˆå¼ºçš„ä¸»è§‚æ€§ï¼Œå¦‚æœè®¾å®šçš„å‡½æ•°å½¢å¼ä¸çœŸå®çš„ç”Ÿäº§è¿‡ç¨‹ä¸ç¬¦ï¼Œå°†ä¼šå¯¼è‡´è¯„ä¼°ç»“æœäº§ç”Ÿç³»ç»Ÿæ€§åå·®ã€‚DEAåˆ™å®Œå…¨é¿å…äº†è¿™ä¸ªé—®é¢˜ï¼Œå®ƒä¸ä¾èµ–ä»»ä½•å‡½æ•°å½¢å¼çš„å‡è®¾ï¼Œè€Œæ˜¯ç›´æ¥ä»è§‚æµ‹æ•°æ®ä¸­æ„å»ºâ€œæœ€ä½³å®è·µå‰æ²¿â€ã€‚

å…¶æ¬¡ï¼ŒDEAçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå…¶å¤„ç†å¤šç»´æŠ•å…¥å’Œäº§å‡ºçš„èƒ½åŠ›ã€‚ä¼ ç»Ÿçš„ç»©æ•ˆè¯„ä¼°æ–¹æ³•ï¼Œå¦‚è´¢åŠ¡æ¯”ç‡åˆ†æï¼Œåœ¨é¢å¯¹å¤šä¸ªæŒ‡æ ‡æ—¶å¸¸å¸¸ä¼šç»™å‡ºç›¸äº’çŸ›ç›¾çš„ä¿¡å·ï¼Œè€ŒDEAèƒ½å¤Ÿå°†è¿™äº›å¤šç»´åº¦çš„æŒ‡æ ‡æ•´åˆè¿›ä¸€ä¸ªç»Ÿä¸€çš„æ•ˆç‡æ¡†æ¶ä¸­è¿›è¡Œç»¼åˆè¯„ä¼°ã€‚

æœ€åï¼Œå°½ç®¡DEAè§£å†³çš„æ˜¯ä¸€ä¸ªæ¯”ç‡ä¼˜åŒ–é—®é¢˜ï¼Œä½†é€šè¿‡æ•°å­¦å˜æ¢ï¼Œå®ƒå¯ä»¥è¢«è½¬æ¢æˆä¸€ä¸ªæ ‡å‡†çš„çº¿æ€§è§„åˆ’é—®é¢˜ï¼Œä½¿å¾—è®¡ç®—å˜å¾—éå¸¸ç®€ä¾¿å’Œé«˜æ•ˆã€‚

æ€»ç»“è€Œè¨€ï¼ŒDEAä¹‹æ‰€ä»¥å¹¿å—æ¬¢è¿ï¼Œä¸»è¦åŸºäºä¸‰ä¸ªåŸå› ï¼š

1. **å‡è®¾æ¡ä»¶ç›¸å¯¹è¾ƒå°‘**ï¼šæ— éœ€é¢„è®¾ç”Ÿäº§å‡½æ•°ï¼Œå‡å°‘äº†ä¸»è§‚åè¯¯çš„é£é™©ã€‚
2. **èƒ½å¤Ÿå¤„ç†å¤šç»´æŠ•å…¥äº§å‡º**ï¼šå¯ä»¥å¯¹å¤æ‚çš„è¿è¥ç³»ç»Ÿè¿›è¡Œå…¨é¢çš„æ ‡æ†æ¯”è¾ƒã€‚
3. **è®¡ç®—ç®€ä¾¿**ï¼šå¯ä»¥é€šè¿‡çº¿æ€§è§„åˆ’ç›´æ¥æ±‚è§£æ•ˆç‡æ¯”ç‡ã€‚

### II. DEAçš„æ¶æ„æ”¯æŸ±

#### A. å†³ç­–å•å…ƒï¼ˆDMUï¼‰

å†³ç­–å•å…ƒï¼ˆDecision Making Unit, DMUï¼‰æ˜¯DEAåˆ†æçš„åŸºæœ¬è¯„ä¼°å¯¹è±¡ã€‚ç†è®ºä¸Šï¼Œä»»ä½•ä¸€ä¸ªèƒ½å¤Ÿå°†æŠ•å…¥è½¬åŒ–ä¸ºäº§å‡ºçš„åŒè´¨å®ä½“ï¼Œéƒ½å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªDMUã€‚DEAçš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶è¯„ä¼°å¯¹è±¡çš„å¹¿æ³›é€‚åº”æ€§ï¼Œè¿™äº›DMUå¯ä»¥æ˜¯ï¼š

- **å•†ä¸šæœºæ„**ï¼šå¦‚é“¶è¡Œåˆ†è¡Œã€è¿é”å•†åº—ã€åˆ¶é€ å·¥å‚ã€é…’åº—ã€‚
- **å…¬å…±æœåŠ¡éƒ¨é—¨**ï¼šå¦‚åŒ»é™¢ã€å­¦æ ¡ã€è­¦å¯Ÿå±€ã€æ³•é™¢ã€‚
- **å®è§‚ç»æµå•ä½**ï¼šå¦‚åŸå¸‚ã€åœ°åŒºç”šè‡³å›½å®¶ã€‚

è¿›è¡ŒDEAåˆ†æçš„ä¸€ä¸ªå…³é”®å‰ææ˜¯**DMUçš„åŒè´¨æ€§ï¼ˆHomogeneityï¼‰**ã€‚è¿™æ„å‘³ç€æ‰€æœ‰å‚ä¸è¯„ä¼°çš„DMUå¿…é¡»æ‰§è¡Œç›¸ä¼¼çš„ä»»åŠ¡ï¼Œè¿ä½œäºç›¸ä¼¼çš„å¸‚åœºæˆ–ç›‘ç®¡ç¯å¢ƒä¸­ï¼Œå¹¶ä½¿ç”¨ç›¸åŒç±»å‹çš„æŠ•å…¥æ¥äº§ç”Ÿç›¸åŒç±»å‹çš„äº§å‡ºã€‚ä¾‹å¦‚ï¼Œå°†ä¸€å®¶æ•™å­¦åŒ»é™¢ä¸ä¸€å®¶ç¤¾åŒºè¯Šæ‰€è¿›è¡Œæ¯”è¾ƒæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒä»¬çš„ç›®æ ‡ã€èµ„æºå’Œäº§å‡ºæˆªç„¶ä¸åŒã€‚ç¡®ä¿åŒè´¨æ€§æ˜¯ä¿è¯DEAç»“æœæœ‰æ•ˆå’Œå¯æ¯”çš„åŸºç¡€ã€‚

#### B. æŠ•å…¥ä¸äº§å‡ºï¼šæ•ˆç‡çš„æ„å»ºæ¨¡å—

æŠ•å…¥å’Œäº§å‡ºæ˜¯æ„å»ºDEAæ¨¡å‹çš„åŸºçŸ³ã€‚

- **æŠ•å…¥ï¼ˆInputsï¼‰**ï¼šæŒ‡DMUåœ¨ç”Ÿäº§è¿‡ç¨‹ä¸­æ‰€æ¶ˆè€—æˆ–åˆ©ç”¨çš„å„ç§èµ„æºã€‚è¿™äº›å¯ä»¥æ˜¯äººåŠ›èµ„æºï¼ˆå¦‚å‘˜å·¥æ•°é‡ã€å·¥æ—¶ï¼‰ã€èµ„æœ¬ï¼ˆå¦‚è®¾å¤‡æ•°é‡ã€èµ„äº§æ€»é¢ï¼‰ã€ç‰©æ–™æˆ–å…¶ä»–è¿è¥æˆæœ¬ï¼ˆå¦‚è¿è¥è´¹ç”¨ã€èƒ½æºæ¶ˆè€—ï¼‰ã€‚
- **äº§å‡ºï¼ˆOutputsï¼‰**ï¼šæŒ‡DMUé€šè¿‡è½¬åŒ–æŠ•å…¥æ‰€äº§ç”Ÿçš„äº§å“æˆ–æœåŠ¡ã€‚è¿™äº›å¯ä»¥æ˜¯å®ä½“äº§å“ï¼ˆå¦‚äº§å“æ•°é‡ï¼‰ã€æœåŠ¡é‡ï¼ˆå¦‚æœåŠ¡çš„å®¢æˆ·æ•°ã€å¤„ç†çš„äº¤æ˜“ç¬”æ•°ï¼‰æˆ–è´¢åŠ¡ç»“æœï¼ˆå¦‚æ”¶å…¥ã€åˆ©æ¶¦ï¼‰ã€‚

DEAçš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹æ˜¯å®ƒèƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªæŠ•å…¥å’Œå¤šä¸ªäº§å‡ºï¼Œå¹¶ä¸”è¿™äº›æŒ‡æ ‡çš„è®¡é‡å•ä½å¯ä»¥å®Œå…¨ä¸åŒã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé›¶å”®åº—çš„DEAæ¨¡å‹å¯ä»¥åŒæ—¶åŒ…å«ä»¥â€œäººæ•°â€è®¡é‡çš„å‘˜å·¥æ•°é‡ã€ä»¥â€œå¹³æ–¹ç±³â€è®¡é‡çš„åº—é“ºé¢ç§¯ã€ä»¥â€œç¾å…ƒâ€è®¡é‡çš„è¿è¥è´¹ç”¨ä½œä¸ºæŠ•å…¥ï¼Œä»¥åŠä»¥â€œä»¶æ•°â€è®¡é‡çš„é”€å”®é‡å’Œä»¥â€œç¾å…ƒâ€è®¡é‡çš„åˆ©æ¶¦ä½œä¸ºäº§å‡ºã€‚è¿™ä¸ä¼ ç»Ÿçš„æ¯”ç‡åˆ†æå½¢æˆäº†é²œæ˜å¯¹æ¯”ï¼Œåè€…åœ¨å¤„ç†å¤šä¸ªæ¯”ç‡ï¼ˆå¦‚äººå‡é”€å”®é¢ã€åªæ•ˆï¼‰å¯èƒ½å‡ºç°çš„çŸ›ç›¾ä¿¡å·æ—¶ä¼šé‡åˆ°å›°éš¾ã€‚

æŒ‡æ ‡çš„é€‰æ‹©å¯¹DEAç»“æœè‡³å…³é‡è¦ã€‚é€‰æ‹©çš„æŠ•å…¥å’Œäº§å‡ºæŒ‡æ ‡åº”èƒ½é€»è¾‘æ¸…æ™°åœ°ä»£è¡¨è¢«è¯„ä¼°çš„ç”Ÿäº§è¿‡ç¨‹ã€‚åˆ†æå¸ˆé¢ä¸´çš„æŒ‘æˆ˜æ˜¯æ„å»ºä¸€ä¸ªâ€œç²¾ç®€â€ï¼ˆparsimoniousï¼‰çš„æ¨¡å‹ï¼šæ—¢è¦åŒ…å«è¶³å¤Ÿå¤šçš„å˜é‡ä»¥å…¨é¢åæ˜ DMUçš„è¿ä½œï¼Œåˆè¦å°½å¯èƒ½å°‘ä»¥ä¿æŒæ¨¡å‹çš„åˆ¤åˆ«åŠ›ã€‚

#### C. æ•ˆç‡å‰æ²¿ï¼šåŒ…ç»œæœ€ä½³å®è·µ

æ•ˆç‡å‰æ²¿ï¼ˆEfficiency Frontierï¼‰ï¼Œä¹Ÿç§°ä¸ºç”Ÿäº§å‰æ²¿æˆ–æœ€ä½³å®è·µå‰æ²¿ï¼Œæ˜¯DEAçš„æ ¸å¿ƒæ¦‚å¿µã€‚ä¸ç†è®ºç»æµå­¦ä¸­æŠ½è±¡çš„ç”Ÿäº§å‡½æ•°ä¸åŒï¼ŒDEAçš„æ•ˆç‡å‰æ²¿æ˜¯**ç»éªŒæ€§çš„**ï¼Œå®ƒå®Œå…¨ç”±æ ·æœ¬æ•°æ®ä¸­è¡¨ç°æœ€ä½³çš„DMUæ‰€æ„æˆã€‚

â€œæ•°æ®åŒ…ç»œåˆ†æâ€è¿™ä¸ªåç§°çš„ç”±æ¥ï¼Œæ­£æ˜¯å› ä¸ºå®ƒæ„å»ºçš„æ•ˆç‡å‰æ²¿é¢åƒä¸€ä¸ªâ€œä¿¡å°â€ä¸€æ ·ï¼Œå°†æ‰€æœ‰çš„æ•°æ®ç‚¹â€œåŒ…ç»œâ€åœ¨å†…ã€‚ä½äºè¿™ä¸ªâ€œä¿¡å°â€è¡¨é¢ï¼ˆå³å‰æ²¿é¢ä¸Šï¼‰çš„DMUè¢«å®šä¹‰ä¸ºç›¸å¯¹æœ‰æ•ˆï¼ˆæˆ–ç§°DEAæœ‰æ•ˆï¼‰ï¼Œå…¶æ•ˆç‡å¾—åˆ†ä¸º1ï¼ˆæˆ–100%ï¼‰ã€‚è€Œæ‰€æœ‰ä½äºâ€œä¿¡å°â€å†…éƒ¨çš„DMUåˆ™è¢«è§†ä¸ºç›¸å¯¹æ— æ•ˆï¼Œå®ƒä»¬çš„æ•ˆç‡é€šè¿‡å…¶ä¸å‰æ²¿é¢çš„è·ç¦»æ¥è¡¡é‡ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„å›¾å½¢æ¥ç›´è§‚ç†è§£ã€‚å‡è®¾æˆ‘ä»¬è¯„ä¼°ä¸€ç»„DMUï¼Œæ¯ä¸ªDMUä½¿ç”¨ä¸€ç§æŠ•å…¥ï¼ˆInput Xï¼‰ç”Ÿäº§ä¸€ç§äº§å‡ºï¼ˆOutput Yï¼‰ã€‚å°†æ‰€æœ‰DMUçš„æ•°æ®ç‚¹ç»˜åˆ¶åœ¨äºŒç»´åæ ‡ç³»ä¸­ï¼ŒDEAä¼šæ„å»ºä¸€æ¡è¿æ¥â€œæœ€é«˜æ•ˆâ€æ•°æ®ç‚¹çš„åˆ†æ®µçº¿æ€§æ›²çº¿ï¼ˆæˆ–åœ¨é«˜ç»´ç©ºé—´ä¸­çš„è¶…å¹³é¢ï¼‰ã€‚è¿™æ¡æ›²çº¿å°±æ˜¯æ•ˆç‡å‰æ²¿ã€‚ä»»ä½•ä½äºæ›²çº¿ä¸‹æ–¹çš„ç‚¹éƒ½æ˜¯æ— æ•ˆç‡çš„ï¼Œå…¶æ— æ•ˆç‡çš„ç¨‹åº¦å¯ä»¥é€šè¿‡å®ƒå‘æ›²çº¿ä¸ŠæŠ•å½±çš„è·ç¦»æ¥åº¦é‡ã€‚

è¿™ç§æ„å»ºæ–¹å¼æ­ç¤ºäº†DEAçš„ä¸€ä¸ªæ·±åˆ»å†…æ¶µï¼šæ•ˆç‡å‰æ²¿ä»£è¡¨çš„æ˜¯ä¸€ç§â€œå®è·µä¸­çš„æœ€ä¼˜â€ï¼Œè€Œéâ€œç†è®ºä¸Šçš„å®Œç¾â€ã€‚è¿™å¯¹äºç®¡ç†å®è·µå…·æœ‰é‡è¦æ„ä¹‰ã€‚ä¼ ç»Ÿç»æµå­¦ç†è®ºä¸­çš„ç”Ÿäº§å‡½æ•°ä»£è¡¨äº†åœ¨ç°æœ‰æŠ€æœ¯æ°´å¹³ä¸‹å¯èƒ½è¾¾åˆ°çš„ç»å¯¹æœ€å¤§äº§å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªæ— æ³•è§‚æµ‹çš„ã€ç†æƒ³åŒ–çš„æ¦‚å¿µã€‚DEAåˆ™æ”¾å¼ƒäº†å¯¹è¿™ä¸€ç†è®ºæœ€ä¼˜çš„ä¼°è®¡ï¼Œè½¬è€Œä»å®é™…æ•°æ®ä¸­å¯»æ‰¾â€œæ¦œæ ·â€ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªæ•ˆç‡å¾—åˆ†ä¸º1çš„DMUå¹¶éç»å¯¹æ„ä¹‰ä¸Šçš„â€œå®Œç¾â€ï¼Œå®ƒåªæ˜¯åœ¨å½“å‰è¢«è¯„ä¼°çš„æ ·æœ¬ä¸­è¡¨ç°æœ€å¥½çš„ä¸€ä¸ªã€‚å®ƒæ˜¯â€œæœ€ä½³å®è·µâ€ï¼Œè€Œéâ€œå®Œç¾å®è·µâ€ã€‚

è¿™ä¸€ç‰¹æ€§å¸¦æ¥äº†ä¸¤ä¸ªé‡è¦çš„å®è·µæ¨è®ºã€‚ç¬¬ä¸€ï¼ŒDEAçš„æ•ˆç‡è¯„åˆ†å¯¹æ ·æœ¬é€‰æ‹©é«˜åº¦æ•æ„Ÿã€‚å¦‚æœå‘æ•°æ®é›†ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„ã€æ•ˆç‡æé«˜çš„DMUï¼Œå®ƒå¯èƒ½ä¼šé‡æ–°å®šä¹‰æ•ˆç‡å‰æ²¿ï¼Œä»è€Œé™ä½å…¶ä»–æ‰€æœ‰DMUçš„ç›¸å¯¹æ•ˆç‡å¾—åˆ†ã€‚ç¬¬äºŒï¼Œå®ƒä½¿å¾—DEAæˆä¸ºä¸€ä¸ªéå¸¸åŠ¡å®çš„ç®¡ç†å·¥å…·ã€‚å¯¹äºä¸€å®¶æ•ˆç‡ä½ä¸‹çš„åŒ»é™¢æ¥è¯´ï¼Œå®ƒçš„æ”¹è¿›æ ‡æ†ä¸å†æ˜¯ä¸€ä¸ªæŠ½è±¡çš„ç†è®ºæ¨¡å‹ï¼Œè€Œæ˜¯ä¸€å®¶ï¼ˆæˆ–å‡ å®¶ï¼‰çœŸå®å­˜åœ¨çš„ã€ç”¨ç›¸ä¼¼èµ„æºå–å¾—äº†æ›´å¥½æˆæœçš„åŒè¡ŒåŒ»é™¢ã€‚è¿™ç§â€œç›¸å¯¹ä¸”å¯å®ç°â€çš„æ ‡æ†ç‰¹æ€§ï¼Œæ­£æ˜¯DEAä½œä¸ºæ ‡æ†ç®¡ç†å’ŒæŒç»­æ”¹è¿›å·¥å…·çš„å¼ºå¤§ä¹‹å¤„ã€‚å®ƒä¸ºç®¡ç†è€…æä¾›äº†å…·ä½“çš„ã€ç°å®ä¸–ç•Œä¸­çš„å­¦ä¹ æ¦œæ ·ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé¥ä¸å¯åŠçš„ç†è®ºç›®æ ‡ã€‚

### III. åŸºç¡€æ•°å­¦æ¨¡å‹ï¼šCCRä¸BCC

DEAæ–¹æ³•è®ºå»ºç«‹åœ¨ä¸¤ä¸ª foundational æ¨¡å‹ä¹‹ä¸Šï¼šCCRæ¨¡å‹å’ŒBCCæ¨¡å‹ã€‚å®ƒä»¬ä»£è¡¨äº†å¯¹ç”Ÿäº§æŠ€æœ¯ä¸åŒå‡è®¾çš„ç†è§£ï¼Œå¹¶å…±åŒæ„æˆäº†ç°ä»£æ•ˆç‡åˆ†æçš„åŸºçŸ³ã€‚

#### A. CCRæ¨¡å‹ï¼šå›ºå®šè§„æ¨¡æŠ¥é…¬ï¼ˆCRSï¼‰

CCRæ¨¡å‹ç”±Charnesã€Cooperå’ŒRhodesäº1978å¹´æå‡ºï¼Œæ˜¯DEAçš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€åŸºç¡€çš„æ¨¡å‹ã€‚è¯¥æ¨¡å‹çš„æ ¸å¿ƒå‡è®¾æ˜¯

**å›ºå®šè§„æ¨¡æŠ¥é…¬ï¼ˆConstant Returns to Scale, CRSï¼‰**ã€‚CRSå‡è®¾æ„å‘³ç€æŠ•å…¥å’Œäº§å‡ºä¹‹é—´å­˜åœ¨çº¿æ€§çš„ã€æˆæ¯”ä¾‹çš„å…³ç³»ï¼Œå³å¦‚æœæ‰€æœ‰æŠ•å…¥éƒ½å¢åŠ ä¸€å€ï¼Œæ‰€æœ‰äº§å‡ºä¹Ÿåº”è¯¥ç›¸åº”åœ°å¢åŠ ä¸€å€ã€‚è¿™ä¸ªå‡è®¾åœ¨æ‰€æœ‰DMUéƒ½è¢«è®¤ä¸ºåœ¨æœ€ä¼˜è§„æ¨¡ä¸‹è¿è¥æ—¶æ˜¯åˆé€‚çš„ï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªå®Œå…¨ç«äº‰çš„å¸‚åœºä¸­ã€‚

CCRæ¨¡å‹è¡¡é‡çš„æ•ˆç‡è¢«ç§°ä¸º**æ€»æŠ€æœ¯æ•ˆç‡ï¼ˆOverall Technical Efficiency, OTEï¼‰**ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»¼åˆæ€§æŒ‡æ ‡ï¼ŒåŒæ—¶åŒ…å«äº†**çº¯æŠ€æœ¯æ•ˆç‡**å’Œ**è§„æ¨¡æ•ˆç‡**ä¸¤ä¸ªæ–¹é¢ã€‚æ¢è¨€ä¹‹ï¼Œå¦‚æœä¸€ä¸ªDMUåœ¨CCRæ¨¡å‹ä¸‹æ˜¯æ— æ•ˆç‡çš„ï¼Œå…¶åŸå› å¯èƒ½æ˜¯ç®¡ç†ä¸å–„ï¼ˆæŠ€æœ¯æ— æ•ˆç‡ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯è¿è¥è§„æ¨¡ä¸å½“ï¼ˆè§„æ¨¡æ— æ•ˆç‡ï¼‰ï¼Œæˆ–è€…ä¸¤è€…å…¼è€Œæœ‰ä¹‹ã€‚åªæœ‰å½“ä¸€ä¸ªDMUåŒæ—¶è¾¾åˆ°æŠ€æœ¯æœ‰æ•ˆå’Œè§„æ¨¡æœ‰æ•ˆæ—¶ï¼Œå…¶CCRæ•ˆç‡å€¼æ‰ä¸º1ã€‚

ä»æ•°å­¦ä¸Šçœ‹ï¼ŒCCRæ¨¡å‹æœ€åˆè¢«è¡¨è¿°ä¸ºä¸€ä¸ªåˆ†å¼è§„åˆ’é—®é¢˜ï¼Œå…¶ç›®æ ‡æ˜¯ä¸ºå¾…è¯„ä¼°çš„DMUæ‰¾åˆ°ä¸€ç»„æœ€ä¼˜çš„æŠ•å…¥å’Œäº§å‡ºæƒé‡ï¼ˆviå’Œurï¼‰ï¼Œä»¥æœ€å¤§åŒ–å…¶æ•ˆç‡æ¯”ç‡h0ï¼ŒåŒæ—¶ä¿è¯ä½¿ç”¨è¿™ç»„æƒé‡æ—¶ï¼Œæ‰€æœ‰å…¶ä»–DMUçš„æ•ˆç‡æ¯”ç‡éƒ½ä¸è¶…è¿‡1ã€‚

#### B. BCCæ¨¡å‹ï¼šå¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVRSï¼‰

1984å¹´ï¼ŒBankerã€Charneså’ŒCooperå¯¹CCRæ¨¡å‹è¿›è¡Œäº†é‡è¦æ‰©å±•ï¼Œæå‡ºäº†BCCæ¨¡å‹ã€‚BCCæ¨¡å‹æ”¾å®½äº†ä¸¥æ ¼çš„CRSå‡è®¾ï¼Œå…è®¸

å¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVariable Returns to Scale, VRSï¼‰çš„å­˜åœ¨ã€‚VRSå‡è®¾æ›´åŠ è´´è¿‘ç°å®ï¼Œå› ä¸ºå®ƒæ‰¿è®¤åœ¨ä¸å®Œå…¨ç«äº‰ã€æ”¿åºœç®¡åˆ¶æˆ–é‡‘èçº¦æŸç­‰ç°å®å› ç´ çš„å½±å“ä¸‹ï¼ŒDMUæœªå¿…èƒ½åœ¨æœ€ä¼˜è§„æ¨¡ä¸Šè¿è¥ã€‚åœ¨VRSä¸‹ï¼Œç”Ÿäº§è¿‡ç¨‹å¯èƒ½ç»å†**è§„æ¨¡æŠ¥é…¬é€’å¢ï¼ˆIncreasing Returns to Scale, IRSï¼‰**ã€**å›ºå®šè§„æ¨¡æŠ¥é…¬ï¼ˆCRSï¼‰**å’Œ**è§„æ¨¡æŠ¥é…¬é€’å‡ï¼ˆDecreasing Returns to Scale, DRSï¼‰**ä¸‰ä¸ªé˜¶æ®µã€‚

#### C. æ•ˆç‡åˆ†è§£ï¼šæŠ€æœ¯æ•ˆç‡ä¸è§„æ¨¡æ•ˆç‡

BCCæ¨¡å‹æœ€é‡è¦çš„è´¡çŒ®åœ¨äºå®ƒèƒ½å¤Ÿå°†æ€»æŠ€æœ¯æ•ˆç‡ï¼ˆOTEï¼‰åˆ†è§£ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„ç»„æˆéƒ¨åˆ†ï¼š**çº¯æŠ€æœ¯æ•ˆç‡ï¼ˆPure Technical Efficiency, PTEï¼‰**å’Œ**è§„æ¨¡æ•ˆç‡ï¼ˆScale Efficiency, SEï¼‰**ã€‚

- **çº¯æŠ€æœ¯æ•ˆç‡ï¼ˆPTEï¼‰**ï¼šç”±BCCæ¨¡å‹ç›´æ¥æµ‹ç®—å¾—å‡ºã€‚å®ƒè¡¡é‡çš„æ˜¯åœ¨æ’é™¤äº†è§„æ¨¡å› ç´ å½±å“åï¼ŒDMUçš„ç®¡ç†å’Œè¿è¥èƒ½åŠ›ï¼Œå³åœ¨ç°æœ‰è§„æ¨¡ä¸‹ï¼Œå°†æŠ•å…¥è½¬åŒ–ä¸ºäº§å‡ºçš„çº¯ç²¹èƒ½åŠ›ã€‚PTEåæ˜ äº†DMUçš„èµ„æºé…ç½®èƒ½åŠ›å’Œä½¿ç”¨æ•ˆç‡ã€‚

- **è§„æ¨¡æ•ˆç‡ï¼ˆSEï¼‰**ï¼šè¡¡é‡DMUçš„è¿è¥è§„æ¨¡æ˜¯å¦æ¥è¿‘â€œæœ€ä¼˜ç”Ÿäº§è§„æ¨¡â€ã€‚å®ƒä¸èƒ½ç›´æ¥ä»æŸä¸ªæ¨¡å‹ä¸­å¾—åˆ°ï¼Œè€Œæ˜¯é€šè¿‡CCRå’ŒBCCæ¨¡å‹çš„æ•ˆç‡å€¼è®¡ç®—å¾—å‡ºï¼š
$$
  SE = \frac{OTE_{CCR}}{PTE_{BCC}}
$$

å…¶ä¸­ï¼Œ$OTE_{CCR}$æ˜¯CCRæ¨¡å‹çš„æ•ˆç‡å€¼ï¼Œ$PTE_{BCC}$æ˜¯BCCæ¨¡å‹çš„æ•ˆç‡å€¼ã€‚ç”±äº$PTE_{BCC}$æ€»æ˜¯å¤§äºæˆ–ç­‰äº$OTE_{CCR}$ï¼Œå› æ­¤SEçš„å–å€¼èŒƒå›´åœ¨0å’Œ1ä¹‹é—´ã€‚å½“SE=1æ—¶ï¼Œè¡¨ç¤ºDMUå¤„äºæœ€ä¼˜è§„æ¨¡ï¼›å½“SE<1æ—¶ï¼Œè¡¨ç¤ºå­˜åœ¨è§„æ¨¡æ— æ•ˆç‡ã€‚

è¿™ç§æ•ˆç‡åˆ†è§£å°†DEAä»ä¸€ä¸ªç®€å•çš„æ•ˆç‡æµ‹é‡å·¥å…·ï¼Œè½¬å˜ä¸ºä¸€ä¸ªå¼ºå¤§çš„ç®¡ç†è¯Šæ–­å·¥å…·ã€‚CCRæ¨¡å‹ç»™å‡ºçš„æ€»æ•ˆç‡ï¼ˆOTEï¼‰å›ç­”äº†â€œDMUæ˜¯å¦æœ‰æ•ˆç‡ï¼Ÿâ€çš„é—®é¢˜ï¼Œè€Œæ•ˆç‡åˆ†è§£åˆ™è¿›ä¸€æ­¥å›ç­”äº†â€œå¦‚æœæ— æ•ˆç‡ï¼ŒåŸå› ä½•åœ¨ï¼Ÿâ€ã€‚ä¾‹å¦‚ï¼Œä¸¤å®¶åŒ»é™¢å¯èƒ½å…·æœ‰ç›¸åŒçš„ä½OTEå¾—åˆ†ï¼ˆå¦‚0.8ï¼‰ï¼Œä½†å…¶èƒŒåçš„åŸå› å¯èƒ½å®Œå…¨ä¸åŒï¼š

- **åŒ»é™¢A**ï¼šPTE = 1.0ï¼ŒSE = 0.8ã€‚è¿™æ„å‘³ç€è¯¥åŒ»é™¢çš„ç®¡ç†æ°´å¹³æ˜¯é¡¶å°–çš„ï¼ˆçº¯æŠ€æœ¯æœ‰æ•ˆï¼‰ï¼Œä½†å…¶è¿è¥è§„æ¨¡è¿‡å°æˆ–è¿‡å¤§ï¼Œå¯¼è‡´äº†è§„æ¨¡æ— æ•ˆç‡ã€‚å…¶æˆ˜ç•¥æ”¹è¿›æ–¹å‘åº”èšç„¦äºè°ƒæ•´è§„æ¨¡ï¼Œå¦‚æ‰©å¼ æˆ–åˆå¹¶ã€‚
- **åŒ»é™¢B**ï¼šPTE = 0.8ï¼ŒSE = 1.0ã€‚è¿™æ„å‘³ç€è¯¥åŒ»é™¢çš„è¿è¥è§„æ¨¡æ˜¯æœ€ä½³çš„ï¼Œä½†å…¶ç®¡ç†æ°´å¹³å­˜åœ¨é—®é¢˜ï¼Œå¯¼è‡´äº†çº¯æŠ€æœ¯æ— æ•ˆç‡ã€‚å…¶æˆ˜ç•¥æ”¹è¿›æ–¹å‘åº”æ˜¯ä¼˜åŒ–å†…éƒ¨æµç¨‹ã€æå‡ç®¡ç†èƒ½åŠ›ï¼Œè€Œéæ”¹å˜è§„æ¨¡ã€‚

æ­¤å¤–ï¼ŒBCCæ¨¡å‹è¿˜èƒ½è¿›ä¸€æ­¥åˆ¤æ–­è§„æ¨¡æ— æ•ˆç‡çš„ç±»å‹ã€‚é€šè¿‡åˆ†æå¯¹å¶é—®é¢˜ä¸­çš„å˜é‡ï¼Œå¯ä»¥ç¡®å®šDMUå¤„äºè§„æ¨¡æŠ¥é…¬é€’å¢ï¼ˆIRSï¼‰è¿˜æ˜¯é€’å‡ï¼ˆDRSï¼‰é˜¶æ®µã€‚

- **IRS**ï¼šè¡¨ç¤ºDMUè§„æ¨¡åå°ï¼Œæ‰©å¤§è§„æ¨¡å¯ä»¥å¸¦æ¥æ›´é«˜çš„æŠ•å…¥äº§å‡ºæ•ˆç‡ã€‚
- **DRS**ï¼šè¡¨ç¤ºDMUè§„æ¨¡åå¤§ï¼Œå¯èƒ½å‡ºç°äº†ç®¡ç†æ‹¥å µæˆ–èŒƒå›´ä¸ç»æµï¼Œç¼©å‡è§„æ¨¡åè€Œèƒ½æå‡æ•ˆç‡ã€‚

è¿™ç§ä»â€œæ˜¯å¦æœ‰æ•ˆâ€åˆ°â€œä¸ºä½•æ— æ•ˆâ€ä»¥åŠâ€œå¦‚ä½•æ”¹è¿›â€çš„åˆ†ææ·±åŒ–ï¼Œæ˜¯BCCæ¨¡å‹çš„æ ¸å¿ƒä»·å€¼æ‰€åœ¨ï¼Œå®ƒä¸ºç®¡ç†è€…æä¾›äº†å…·ä½“ã€å¯æ“ä½œçš„æˆ˜ç•¥å»ºè®®ã€‚

**è¡¨1ï¼šCCRä¸BCCæ¨¡å‹å¯¹æ¯”**

| ç‰¹å¾                     | CCR æ¨¡å‹ (Charnes, Cooper, Rhodes, 1978)                     | BCC æ¨¡å‹ (Banker, Charnes, Cooper, 1984)                     |
| ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **å…¨ç§°**                 | Charnes-Cooper-Rhodes æ¨¡å‹                                   | Banker-Charnes-Cooper æ¨¡å‹                                   |
| **æ ¸å¿ƒå‡è®¾ï¼ˆè§„æ¨¡æŠ¥é…¬ï¼‰** | å›ºå®šè§„æ¨¡æŠ¥é…¬ (Constant Returns to Scale, CRS)                | å¯å˜è§„æ¨¡æŠ¥é…¬ (Variable Returns to Scale, VRS)                |
| **è¡¡é‡çš„æ•ˆç‡**           | æ€»æŠ€æœ¯æ•ˆç‡ (Overall Technical Efficiency, OTE)ï¼ŒåŒ…å«æŠ€æœ¯å’Œè§„æ¨¡æ•ˆç‡ | çº¯æŠ€æœ¯æ•ˆç‡ (Pure Technical Efficiency, PTE)ï¼Œå‰”é™¤äº†è§„æ¨¡å½±å“  |
| **æ–°å¢æ•°å­¦çº¦æŸ**         | æ— ï¼ˆç›¸å¯¹äºBCCï¼‰                                              | åœ¨å¯¹å¶ï¼ˆåŒ…ç»œï¼‰å½¢å¼ä¸­å¢åŠ å‡¸æ€§çº¦æŸ (âˆ‘Î»j=1)                     |
| **æ•ˆç‡å€¼è§£è¯»**           | åæ˜ äº†ç®¡ç†æ°´å¹³å’Œè¿è¥è§„æ¨¡çš„ç»¼åˆæ•ˆç‡                           | ä»…åæ˜ åœ¨å½“å‰è§„æ¨¡ä¸‹çš„ç®¡ç†å’Œè¿è¥æ•ˆç‡                           |
| **ä¸»è¦åº”ç”¨åœºæ™¯**         | é€‚ç”¨äºæ‰€æœ‰DMUè¢«è®¤ä¸ºåœ¨æœ€ä¼˜è§„æ¨¡ä¸‹è¿è¥çš„ç†æƒ³æƒ…å†µ                | é€‚ç”¨äºå­˜åœ¨ä¸å®Œå…¨ç«äº‰ã€ç®¡åˆ¶ç­‰å¯¼è‡´DMUè§„æ¨¡å„å¼‚çš„ç°å®æƒ…å†µ        |
| **æä¾›çš„æˆ˜ç•¥æ´å¯Ÿ**       | è¯†åˆ«æ•´ä½“æ•ˆç‡ä½ä¸‹çš„DMU                                        | å°†æ— æ•ˆç‡åˆ†è§£ä¸ºæŠ€æœ¯å±‚é¢å’Œè§„æ¨¡å±‚é¢ï¼Œæä¾›æ›´ç²¾ç¡®çš„è¯Šæ–­å’Œæ”¹è¿›æ–¹å‘ |

### IV. æˆ˜ç•¥å¯¼å‘ï¼šæŠ•å…¥æœ€å°åŒ–ä¸äº§å‡ºæœ€å¤§åŒ–

åœ¨æ„å»ºDEAæ¨¡å‹æ—¶ï¼Œåˆ†æå¸ˆå¿…é¡»åšå‡ºä¸€ä¸ªå…³é”®çš„æˆ˜ç•¥é€‰æ‹©ï¼šé‡‡ç”¨**æŠ•å…¥å¯¼å‘ï¼ˆInput-Orientedï¼‰**æ¨¡å‹è¿˜æ˜¯**äº§å‡ºå¯¼å‘ï¼ˆOutput-Orientedï¼‰**æ¨¡å‹ã€‚è¿™ä¸ªé€‰æ‹©å¹¶éæŠ€æœ¯ä¸Šçš„ç»†ææœ«èŠ‚ï¼Œè€Œæ˜¯æ·±åˆ»åæ˜ äº†è¢«è¯„ä¼°DMUçš„æˆ˜ç•¥å§¿æ€åŠå…¶æ‰€å¤„çš„è¿è¥ç¯å¢ƒã€‚

#### A. æŠ•å…¥å¯¼å‘æ¨¡å‹

æŠ•å…¥å¯¼å‘æ¨¡å‹æ—¨åœ¨å›ç­”è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œåœ¨ä¿æŒå½“å‰äº§å‡ºæ°´å¹³ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå„é¡¹æŠ•å…¥å¯ä»¥æŒ‰æ¯”ä¾‹å‡å°‘å¤šå°‘ï¼Ÿâ€ã€‚è¿™ç§æ¨¡å‹çš„å…³æ³¨ç‚¹æ˜¯**æŠ•å…¥çš„èŠ‚çº¦**å’Œ**æˆæœ¬çš„æ§åˆ¶**ã€‚

å®ƒç‰¹åˆ«é€‚ç”¨äºç®¡ç†è€…å¯¹æŠ•å…¥æ‹¥æœ‰è¾ƒå¤§æ§åˆ¶æƒï¼Œè€Œå¯¹äº§å‡ºæ§åˆ¶æƒè¾ƒå°çš„åœºæ™¯ã€‚å…¬å…±æœåŠ¡éƒ¨é—¨æ˜¯å…¸å‹çš„ä¾‹å­ã€‚ä¾‹å¦‚ï¼Œä¸€æ‰€å…¬ç«‹å­¦æ ¡æˆ–ä¸€å®¶å…¬ç«‹åŒ»é™¢ï¼Œå…¶æœåŠ¡å¯¹è±¡æ•°é‡ï¼ˆäº§å‡ºï¼‰å¾€å¾€ç”±æ”¿åºœæˆ–ç¤¾ä¼šéœ€æ±‚å†³å®šï¼Œæ˜¯ç›¸å¯¹å›ºå®šçš„ï¼›è€Œå…¶é¢„ç®—ã€äººå‘˜é…ç½®å’Œèµ„æºä½¿ç”¨ï¼ˆæŠ•å…¥ï¼‰åˆ™æ˜¯ç®¡ç†è€…å¯ä»¥è¿›è¡Œä¼˜åŒ–çš„æ–¹é¢ã€‚å› æ­¤ï¼Œåœ¨è¯„ä¼°è¿™ç±»ä»¥æˆæœ¬æ§åˆ¶å’Œèµ„æºæœ‰æ•ˆåˆ©ç”¨ä¸ºæ ¸å¿ƒç›®æ ‡çš„ç»„ç»‡æ—¶ï¼ŒæŠ•å…¥å¯¼å‘æ¨¡å‹æ˜¯è‡ªç„¶çš„é€‰æ‹©ã€‚å…¶æ•°å­¦ç›®æ ‡æ˜¯æœ€å°åŒ–ä¸€ä¸ªè¡¨ç¤ºæŠ•å…¥ç¼©å‡æ¯”ä¾‹çš„æ ‡é‡$\theta$ï¼ˆå…¶ä¸­$\theta \le 1$ï¼‰ã€‚

#### B. äº§å‡ºå¯¼å‘æ¨¡å‹

ä¸æŠ•å…¥å¯¼å‘æ¨¡å‹ç›¸åï¼Œäº§å‡ºå¯¼å‘æ¨¡å‹æ—¨åœ¨å›ç­”ï¼šâ€œåœ¨ä¿æŒå½“å‰æŠ•å…¥æ°´å¹³ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå„é¡¹äº§å‡ºå¯ä»¥æŒ‰æ¯”ä¾‹å¢åŠ å¤šå°‘ï¼Ÿâ€ã€‚è¿™ç§æ¨¡å‹çš„å…³æ³¨ç‚¹æ˜¯**äº§å‡ºçš„æ‰©å¼ **å’Œ**æ”¶ç›Šçš„æœ€å¤§åŒ–**ã€‚

å®ƒé€‚ç”¨äºç®¡ç†è€…å¯¹æŠ•å…¥æ§åˆ¶æƒè¾ƒå°ï¼ˆä¾‹å¦‚ï¼Œé¢„ç®—æˆ–èµ„æºåœ¨çŸ­æœŸå†…æ˜¯å›ºå®šçš„ï¼‰ï¼Œè€Œå¯¹äº§å‡ºæœ‰è¾ƒå¤§å½±å“åŠ›çš„åœºæ™¯ã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯è¿½æ±‚å¸‚åœºä»½é¢å’Œé”€å”®å¢é•¿çš„ç§è¥ä¼ä¸šã€‚åœ¨ç»™å®šçš„å·¥å‚è§„æ¨¡ã€å‘˜å·¥æ•°é‡å’Œèµ„æœ¬æŠ•å…¥ä¸‹ï¼Œä¼ä¸šçš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–å…¶äº§å“äº§é‡å’Œé”€å”®æ”¶å…¥ã€‚å› æ­¤ï¼Œåœ¨è¯„ä¼°è¿™ç±»ä»¥å¢é•¿å’Œå¸‚åœºæ‰©å¼ ä¸ºæ ¸å¿ƒç›®æ ‡çš„ç»„ç»‡æ—¶ï¼Œäº§å‡ºå¯¼å‘æ¨¡å‹æ›´ä¸ºåˆé€‚ã€‚å…¶æ•°å­¦ç›®æ ‡æ˜¯æœ€å¤§åŒ–ä¸€ä¸ªè¡¨ç¤ºäº§å‡ºæ‰©å¼ æ¯”ä¾‹çš„æ ‡é‡$\phi$ï¼ˆå…¶ä¸­$\phi \ge 1$ï¼‰ã€‚

#### C. ç­‰ä»·æ€§ä¸å·®å¼‚æ€§

æŠ•å…¥å¯¼å‘å’Œäº§å‡ºå¯¼å‘æ¨¡å‹çš„é€‰æ‹©ï¼Œå…¶ç»“æœä¼šå—åˆ°è§„æ¨¡æŠ¥é…¬å‡è®¾çš„å½±å“ã€‚

- **åœ¨å›ºå®šè§„æ¨¡æŠ¥é…¬ï¼ˆCRSï¼‰å‡è®¾ä¸‹**ï¼šæŠ•å…¥å¯¼å‘å’Œäº§å‡ºå¯¼å‘æ¨¡å‹æ˜¯ç­‰ä»·çš„ã€‚å®ƒä»¬ä¼šè¯†åˆ«å‡ºå®Œå…¨ç›¸åŒçš„æ•ˆç‡å‰æ²¿å’Œç›¸åŒçš„æœ‰æ•ˆDMUé›†åˆã€‚ä¸€ä¸ªDMUçš„æŠ•å…¥æ•ˆç‡å€¼ï¼ˆÎ¸ï¼‰å’Œäº§å‡ºæ•ˆç‡å€¼ï¼ˆÏ•ï¼‰äº’ä¸ºå€’æ•°ï¼Œå³ $\theta = 1/\phi$ã€‚å› æ­¤ï¼Œåœ¨CRSå‡è®¾ä¸‹ï¼Œæ¨¡å‹å¯¼å‘çš„é€‰æ‹©ä¸ä¼šå½±å“æœ€ç»ˆçš„æ•ˆç‡æ’åºã€‚
- **åœ¨å¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVRSï¼‰å‡è®¾ä¸‹**ï¼šæƒ…å†µåˆ™æœ‰æ‰€ä¸åŒã€‚è™½ç„¶ä¸¤ç§å¯¼å‘ä»ç„¶ä¼šè¯†åˆ«å‡ºç›¸åŒçš„æœ‰æ•ˆDMUé›†åˆï¼ˆæ•ˆç‡å€¼ä¸º1çš„å•ä½ï¼‰ï¼Œä½†å¯¹äºæ— æ•ˆç‡çš„DMUï¼Œå®ƒä»¬çš„æ•ˆç‡å¾—åˆ†ï¼ˆÎ¸å’Œ$\phi$ï¼‰ä¸å†æ˜¯ç®€å•çš„å€’æ•°å…³ç³»ï¼Œå¹¶ä¸”å®ƒä»¬åœ¨å‰æ²¿é¢ä¸Šçš„æŠ•å½±ç‚¹ï¼ˆå³æ”¹è¿›ç›®æ ‡ï¼‰ä¹Ÿå¯èƒ½ä¸åŒã€‚

è¿™ä¸ªé€‰æ‹©çš„èƒŒåï¼Œä½“ç°äº†ç»„ç»‡çš„æˆ˜ç•¥ä¼˜å…ˆçº§ã€‚ä¸€ä¸ªé‡‡ç”¨æŠ•å…¥å¯¼å‘æ¨¡å‹çš„ç»„ç»‡ï¼Œå…¶éšå«çš„æˆ˜ç•¥å§¿æ€æ˜¯é˜²å¾¡æ€§çš„ã€å†…å‘çš„ï¼Œèšç„¦äºåœ¨ç°æœ‰å¸‚åœºæˆ–çº¦æŸä¸‹é€šè¿‡é™æœ¬å¢æ•ˆæ¥æå‡ç«äº‰åŠ›ã€‚è€Œä¸€ä¸ªé‡‡ç”¨äº§å‡ºå¯¼å‘æ¨¡å‹çš„ç»„ç»‡ï¼Œå…¶æˆ˜ç•¥å§¿æ€åˆ™æ˜¯è¿›æ”»æ€§çš„ã€å¤–å‘çš„ï¼Œèšç„¦äºåœ¨ç°æœ‰èµ„æºåŸºç¡€ä¸Šé€šè¿‡æ‰©å¤§äº§å‡ºæ¥æŠ¢å å¸‚åœºå’Œå¸‚åœºå’Œå®ç°å¢é•¿ã€‚å› æ­¤ï¼Œåˆ†æå¸ˆåœ¨é€‰æ‹©æ¨¡å‹å¯¼å‘æ—¶ï¼Œå¿…é¡»æ·±å…¥ç†è§£è¢«è¯„ä¼°DMUçš„ä¸šåŠ¡æ€§è´¨ã€å¸‚åœºç¯å¢ƒå’Œæˆ˜ç•¥æ„å›¾ï¼Œä»¥ç¡®ä¿DEAæ¨¡å‹ç»™å‡ºçš„â€œæ”¹è¿›å»ºè®®â€æ˜¯ç¬¦åˆå…¶å®é™…æƒ…å†µå’Œç›®æ ‡çš„ã€‚

**è¡¨2ï¼šæŠ•å…¥å¯¼å‘ä¸äº§å‡ºå¯¼å‘æ¨¡å‹çš„æˆ˜ç•¥æŒ‡å—**

| æ ‡å‡†                                  | æŠ•å…¥å¯¼å‘æ¨¡å‹                                                 | äº§å‡ºå¯¼å‘æ¨¡å‹                                          |
| ------------------------------------- | ------------------------------------------------------------ | ----------------------------------------------------- |
| **æ ¸å¿ƒé—®é¢˜**                          | åœ¨äº§å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼ŒæŠ•å…¥èƒ½å‡å°‘å¤šå°‘ï¼Ÿ                         | åœ¨æŠ•å…¥ä¸å˜çš„æƒ…å†µä¸‹ï¼Œäº§å‡ºèƒ½å¢åŠ å¤šå°‘ï¼Ÿ                  |
| **ç®¡ç†ç„¦ç‚¹**                          | æˆæœ¬æ§åˆ¶ã€èµ„æºèŠ‚çº¦ã€æ•ˆç‡æå‡                                 | äº§å‡ºæ‰©å¼ ã€æ”¶å…¥å¢é•¿ã€å¸‚åœºä»½é¢                          |
| **æˆ˜ç•¥å§¿æ€**                          | é˜²å¾¡æ€§ã€å†…å‘å‹ã€æ•´åˆä¼˜åŒ–                                     | è¿›æ”»æ€§ã€å¤–å‘å‹ã€å¢é•¿æ‰©å¼                               |
| **å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆå…¬å…±éƒ¨é—¨/æˆæœ¬ä¸­å¿ƒï¼‰** | å…¬ç«‹åŒ»é™¢ã€å…¬ç«‹å­¦æ ¡ã€æ”¿åºœæœºæ„ç­‰ï¼Œå…¶æœåŠ¡ç›®æ ‡ï¼ˆäº§å‡ºï¼‰å›ºå®šï¼Œéœ€æœ€å°åŒ–æˆæœ¬ï¼ˆæŠ•å…¥ï¼‰ | è¾ƒå°‘è§ï¼Œé™¤éç›®æ ‡æ˜¯æœ€å¤§åŒ–æœåŠ¡è¦†ç›–èŒƒå›´                  |
| **å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆç§è¥éƒ¨é—¨/åˆ©æ¶¦ä¸­å¿ƒï¼‰** | å¤„äºæˆç†Ÿæˆ–é¥±å’Œå¸‚åœºï¼Œä»¥é™æœ¬ä¸ºä¸»è¦ç«äº‰æ‰‹æ®µçš„ä¼ä¸š               | å¤„äºæˆé•¿å‹å¸‚åœºï¼Œä»¥æ‰©å¤§ç”Ÿäº§å’Œé”€å”®ä¸ºä¸»è¦ç›®æ ‡çš„ä¼ä¸š      |
| **æ•°å­¦ç›®æ ‡**                          | æœ€å°åŒ–æŠ•å…¥ç¼©å‡å› å­ Î¸                                         | æœ€å¤§åŒ–äº§å‡ºæ‰©å¼ å› å­ Ï•                                  |
| **å¾—åˆ†è§£é‡Šï¼ˆä»¥æ— æ•ˆç‡DMUä¸ºä¾‹ï¼‰**       | $\theta < 1$ï¼Œè¡¨ç¤ºä¸ºè¾¾åˆ°æœ‰æ•ˆæ‰€éœ€è¾¾åˆ°çš„æŠ•å…¥æ°´å¹³å å½“å‰æŠ•å…¥çš„æ¯”ä¾‹        | $\phi > 1$ï¼Œè¡¨ç¤ºä¸ºè¾¾åˆ°æœ‰æ•ˆæ‰€éœ€è¾¾åˆ°çš„äº§å‡ºæ°´å¹³æ˜¯å½“å‰äº§å‡ºçš„å€æ•° |

### V. ä»æ•°æ®åˆ°å†³ç­–ï¼šä¸ºå¯æ“ä½œæ´å¯Ÿè§£è¯»DEAç»“æœ

DEAåˆ†æçš„æœ€ç»ˆç›®çš„ä¸æ˜¯ç”Ÿæˆä¸€å †æ•°å­—ï¼Œè€Œæ˜¯ä¸ºç®¡ç†å†³ç­–æä¾›æ¸…æ™°ã€å¯æ“ä½œçš„æ´å¯Ÿã€‚è¦å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå¿…é¡»å¯¹DEAçš„å„é¡¹è¾“å‡ºç»“æœè¿›è¡Œæ·±å…¥è§£è¯»ã€‚

#### A. æ•ˆç‡åˆ†å€¼ï¼ˆÎ¸ï¼‰

æ•ˆç‡åˆ†å€¼ï¼ˆé€šå¸¸ç”¨$\theta$è¡¨ç¤ºï¼‰æ˜¯DEAæ¨¡å‹æœ€ç›´æ¥çš„è¾“å‡ºï¼Œå…¶å–å€¼èŒƒå›´ä¸º(0, 1]ã€‚è¿™ä¸ªåˆ†æ•°ä»£è¡¨äº†DMUçš„ç›¸å¯¹æ•ˆç‡æ°´å¹³ã€‚

- **æ•ˆç‡åˆ†å€¼ä¸º1**ï¼šè¡¨ç¤ºè¯¥DMUæ˜¯ç›¸å¯¹æœ‰æ•ˆçš„ï¼Œä½äºç”±æ ·æœ¬æ•°æ®æ„æˆçš„æ•ˆç‡å‰æ²¿é¢ä¸Šã€‚è¿™æ„å‘³ç€ï¼Œåœ¨å½“å‰æ ·æœ¬ä¸­ï¼Œæ²¡æœ‰å…¶ä»–ä»»ä½•ä¸€ä¸ªDMUæˆ–DMUçš„çº¿æ€§ç»„åˆèƒ½ç”¨æ›´å°‘çš„æŠ•å…¥äº§ç”ŸåŒæ ·å¤šçš„äº§å‡ºï¼ˆæˆ–ç”¨åŒæ ·çš„æŠ•å…¥äº§ç”Ÿæ›´å¤šçš„äº§å‡ºï¼‰ã€‚
- **æ•ˆç‡åˆ†å€¼å°äº1**ï¼šè¡¨ç¤ºè¯¥DMUæ˜¯ç›¸å¯¹æ— æ•ˆçš„ã€‚åˆ†å€¼è¶Šä½ï¼Œæ— æ•ˆç‡çš„ç¨‹åº¦è¶Šé«˜ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæŠ•å…¥å¯¼å‘æ¨¡å‹ä¸­æ•ˆç‡ä¸º0.8çš„DMUï¼Œæ„å‘³ç€å®ƒåªéœ€ä½¿ç”¨å½“å‰80%çš„æŠ•å…¥ï¼Œå°±å¯ä»¥ç»´æŒç°æœ‰çš„äº§å‡ºæ°´å¹³ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•ˆç‡å€¼ä¸º1çš„DMUä¹‹é—´è¿˜å­˜åœ¨è¿›ä¸€æ­¥çš„åŒºåˆ†ï¼š

- **å¼ºæœ‰æ•ˆï¼ˆStrongly Efficientï¼‰**ï¼šä¸ä»…æ•ˆç‡å€¼ä¸º1ï¼Œè€Œä¸”å…¶æ‰€æœ‰çš„æŠ•å…¥å’Œäº§å‡ºæ¾å¼›å˜é‡ï¼ˆè§ä¸‹æ–‡ï¼‰å‡ä¸ºé›¶ã€‚è¿™ä»£è¡¨äº†çœŸæ­£çš„æœ€ä½³å®è·µã€‚
- **å¼±æœ‰æ•ˆï¼ˆWeakly Efficientï¼‰**ï¼šæ•ˆç‡å€¼ä¸º1ï¼Œä½†è‡³å°‘å­˜åœ¨ä¸€ä¸ªéé›¶çš„æ¾å¼›å˜é‡ã€‚è¿™æ„å‘³ç€è¯¥DMUè™½ç„¶åœ¨å¾„å‘æ”¹è¿›ä¸Šå·²ç»è¾¾åˆ°æœ€ä¼˜ï¼Œä½†åœ¨æŸäº›ç‰¹å®šæŠ•å…¥æˆ–äº§å‡ºä¸Šä»æœ‰â€œéå¾„å‘â€çš„æ”¹è¿›ç©ºé—´ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªæŠ•å…¥è¿‡å¤šæˆ–æŸä¸ªäº§å‡ºä¸è¶³ï¼‰ã€‚

#### B. å‘ç°æµªè´¹ï¼šæŠ•å…¥/äº§å‡ºæ¾å¼›é‡ï¼ˆSlack Variablesï¼‰

å¯¹äºæ•ˆç‡å€¼å°äº1çš„æ— æ•ˆç‡DMUï¼Œä»…ä»…çŸ¥é“å…¶æ•ˆç‡åˆ†æ•°æ˜¯ä¸å¤Ÿçš„ã€‚**æ¾å¼›å˜é‡**æä¾›äº†å…³äºèµ„æºæµªè´¹æˆ–äº§å‡ºä¸è¶³çš„æ›´å…·ä½“ã€æ›´ç²¾ç»†çš„ä¿¡æ¯ã€‚

- **æŠ•å…¥å†—ä½™ï¼ˆInput Slacks, $s^-$ï¼‰**ï¼šè¡¨ç¤ºåœ¨æŒ‰æ¯”ä¾‹ç¼©å‡æ‰€æœ‰æŠ•å…¥ï¼ˆç”±æ•ˆç‡å€¼$\theta$å†³å®šï¼‰ä¹‹åï¼ŒæŸäº›ç‰¹å®šæŠ•å…¥**é¢å¤–**éœ€è¦å‡å°‘çš„æ•°é‡ï¼Œæ‰èƒ½ä½¿è¯¥DMUè¾¾åˆ°å‰æ²¿æ°´å¹³ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ•ˆç‡ä¸º0.9çš„åŒ»é™¢ï¼Œé™¤äº†éœ€è¦å°†æ‰€æœ‰æŠ•å…¥ï¼ˆåŒ»ç”Ÿã€æŠ¤å£«ã€åºŠä½ï¼‰éƒ½å‡å°‘10%ä¹‹å¤–ï¼Œå…¶æŠ•å…¥æ¾å¼›å˜é‡å¯èƒ½æ˜¾ç¤ºï¼Œè¡Œæ”¿äººå‘˜æ•°é‡è¿˜éœ€è¦é¢å¤–å†å‡å°‘5äººã€‚è¿™æŒ‡å‡ºäº†éå‡è¡¡çš„èµ„æºæµªè´¹ã€‚
- **äº§å‡ºä¸è¶³ï¼ˆOutput Slacks, $s^+$ï¼‰**ï¼šè¡¨ç¤ºåœ¨æŒ‰æ¯”ä¾‹å¢åŠ æ‰€æœ‰äº§å‡ºä¹‹åï¼ŒæŸäº›ç‰¹å®šäº§å‡º**é¢å¤–**éœ€è¦å¢åŠ çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼Œä¸€å®¶é“¶è¡Œåˆ†è¡Œåœ¨è¾¾åˆ°å…¶å¾„å‘äº§å‡ºç›®æ ‡åï¼Œå…¶äº§å‡ºæ¾å¼›å˜é‡å¯èƒ½æ˜¾ç¤ºï¼Œå…¶ç†è´¢äº§å“é”€å”®é¢è¿˜éœ€è¦é¢å¤–å†å¢åŠ 10ä¸‡ç¾å…ƒã€‚

æ¾å¼›å˜é‡æ˜¯DEAæä¾›å¯æ“ä½œå»ºè®®çš„å…³é”®ã€‚å®ƒå°†åˆ†æä»â€œä½ éœ€è¦æ•´ä½“ä¸ŠèŠ‚çº¦10%çš„æˆæœ¬â€æ·±åŒ–åˆ°â€œä½ éœ€è¦åœ¨æ•´ä½“èŠ‚çº¦10%æˆæœ¬çš„åŸºç¡€ä¸Šï¼Œé‡ç‚¹å‰Šå‡Xéƒ¨é—¨çš„Yé¡¹å¼€æ”¯â€ï¼Œä»è€Œä¸ºç®¡ç†è€…æä¾›äº†ç²¾ç¡®çš„æ”¹è¿›é¶ç‚¹ã€‚

#### C. å‚ç…§é›†ï¼ˆPeer Groupï¼‰çš„è§’è‰²

å¯¹äºæ¯ä¸€ä¸ªæ— æ•ˆç‡çš„DMUï¼ŒDEAåˆ†æéƒ½ä¼šè¯†åˆ«å‡ºä¸€ä¸ªæˆ–å¤šä¸ªæœ‰æ•ˆçš„DMUä½œä¸ºå…¶**å‚ç…§é›†**ï¼Œä¹Ÿç§°ä¸º**å¯¹ç­‰ç»„ï¼ˆPeer Groupï¼‰**ã€‚

è¿™ä¸ªå‚ç…§é›†ç”±é‚£äº›æ„æˆæ•ˆç‡å‰æ²¿ç‰¹å®šâ€œé¢â€çš„æœ‰æ•ˆDMUç»„æˆï¼Œæ— æ•ˆç‡çš„DMUæ­£æ˜¯å‘è¿™ä¸ªâ€œé¢â€è¿›è¡ŒæŠ•å½±ä»¥è®¡ç®—å…¶æ•ˆç‡ã€‚ä»æ•°å­¦ä¸Šè®²ï¼Œæ— æ•ˆç‡DMUçš„æ”¹è¿›ç›®æ ‡ï¼ˆå³å…¶åœ¨å‰æ²¿é¢ä¸Šçš„æŠ•å½±ç‚¹ï¼‰å¯ä»¥è¡¨ç¤ºä¸ºå‚ç…§é›†ä¸­å„ä¸ªæœ‰æ•ˆDMUçš„æŠ•å…¥äº§å‡ºå‘é‡çš„åŠ æƒå¹³å‡ï¼ˆå‡¸ç»„åˆï¼‰ï¼Œæƒé‡å³ä¸º$\lambda$å€¼ã€‚

å‚ç…§é›†çš„ä½œç”¨è¶…è¶Šäº†çº¯ç²¹çš„æ•°å­¦è®¡ç®—ï¼Œå®ƒæ˜¯è¿æ¥å®šé‡åˆ†æä¸å®šæ€§ç®¡ç†æ”¹è¿›çš„æ¡¥æ¢ã€‚å®ƒä¸ºæ— æ•ˆç‡çš„DMUæä¾›äº†å…·ä½“çš„ã€ç°å®ä¸–ç•Œä¸­çš„å­¦ä¹ æ¦œæ ·å’Œæ ‡æ†ã€‚ä¸€ä¸ªæ— æ•ˆç‡çš„DMUçš„ç®¡ç†è€…ä¸å†é¢å¯¹ä¸€ä¸ªæŠ½è±¡çš„â€œ100åˆ†â€ç›®æ ‡ï¼Œè€Œæ˜¯å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ï¼šâ€œåŒ»é™¢Aâ€å’Œâ€œåŒ»é™¢Bâ€å°±æ˜¯æˆ‘çš„å‚ç…§é›†ï¼Œå®ƒä»¬ç”¨å’Œæˆ‘ç›¸ä¼¼çš„èµ„æºå–å¾—äº†æ¯”æˆ‘æ›´å¥½çš„æˆæœã€‚

æ¥ä¸‹æ¥çš„ç®¡ç†ä»»åŠ¡å°±å˜å¾—éå¸¸æ˜ç¡®ï¼šæ·±å…¥ç ”ç©¶å‚ç…§é›†ä¸­çš„åŒè¡Œã€‚å®ƒä»¬é‡‡ç”¨äº†ä»€ä¹ˆæ ·çš„è¿è¥æµç¨‹ï¼Ÿä½¿ç”¨äº†ä½•ç§æŠ€æœ¯ï¼Ÿå®ƒä»¬çš„ç»„ç»‡æ¶æ„å’Œæ¿€åŠ±æœºåˆ¶æ˜¯æ€æ ·çš„ï¼Ÿé€šè¿‡å¯¹è¿™äº›â€œæœ€ä½³å®è·µè€…â€çš„æ·±å…¥å‰–-æï¼Œæ— æ•ˆç‡çš„DMUå¯ä»¥æ‰¾åˆ°é€‚åˆè‡ªèº«çš„ã€åˆ‡å®å¯è¡Œçš„æ”¹è¿›è·¯å¾„ã€‚

å› æ­¤ï¼Œå¯ä»¥è¯´å‚ç…§é›†æ˜¯DEAåˆ†æå¯¹å®è·µç®¡ç†è€…è€Œè¨€æœ€æœ‰ä»·å€¼çš„è¾“å‡ºä¹‹ä¸€ã€‚å®ƒå°†æŠ½è±¡çš„æ•ˆç‡åˆ†æ•°è½¬åŒ–ä¸ºä¸€ä¸ªå…·ä½“çš„å­¦ä¹ å¯¹è±¡åˆ—è¡¨ï¼Œå°†æ ‡æ†ç®¡ç†çš„ç†å¿µæ“ä½œåŒ–ï¼Œæœ‰æ•ˆåœ°å°†æ¨¡å‹çš„æ•°å­¦ä¼˜åŒ–ä¸ç»„ç»‡çš„å­¦ä¹ å’Œé€‚åº”è¿‡ç¨‹è”ç³»èµ·æ¥ã€‚


### VI. è¡¡é‡åŠ¨æ€ç”Ÿäº§ç‡ï¼šMalmquistæŒ‡æ•°

å½“åˆ†ææ¶‰åŠè·¨è¶Šå¤šä¸ªæ—¶é—´æ®µçš„é¢æ¿æ•°æ®æ—¶ï¼Œé™æ€çš„DEAæ¨¡å‹è™½ç„¶å¯ä»¥åœ¨æ¯ä¸ªæ—¶æœŸç‹¬ç«‹è¯„ä¼°æ•ˆç‡ï¼Œä½†å´æ— æ³•æ•æ‰ç”Ÿäº§ç‡çš„åŠ¨æ€å˜åŒ–ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCaves, Christensenå’ŒDiewertåœ¨1982å¹´æå‡ºäº†MalmquistæŒ‡æ•°ï¼Œå®ƒä¸DEAæ–¹æ³•ç›¸ç»“åˆï¼Œæˆä¸ºè¡¡é‡è·¨æ—¶æœŸç”Ÿäº§ç‡å˜åŒ–ï¼ˆTotal Factor Productivity, TFPï¼‰çš„å¼ºå¤§å·¥å…·ã€‚

MalmquistæŒ‡æ•°çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œé€šè¿‡è®¡ç®—ä¸€ä¸ªDMUåœ¨ä¸¤ä¸ªä¸åŒæ—¶é—´ç‚¹ï¼ˆä¾‹å¦‚tå’Œt+1ï¼‰ç›¸å¯¹äºæŠ€æœ¯å‰æ²¿çš„è·ç¦»æ¯”ç‡ï¼Œæ¥è¡¡é‡å…¶ç”Ÿäº§ç‡çš„å˜åŒ–ã€‚åŸºäºDEAçš„MalmquistæŒ‡æ•°é€šè¿‡æ„å»ºä¸åŒæ—¶æœŸçš„æ•ˆç‡å‰æ²¿ï¼Œå¹¶å°†ä¸€ä¸ªæ—¶æœŸçš„DMUä¸å¦ä¸€ä¸ªæ—¶æœŸçš„å‰æ²¿è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œå®ç°å¯¹ç”Ÿäº§ç‡å˜åŒ–çš„æµ‹åº¦ã€‚

#### A. MalmquistæŒ‡æ•°çš„åˆ†è§£

MalmquistæŒ‡æ•°æœ€å¸å¼•äººçš„åœ°æ–¹åœ¨äºï¼Œå®ƒå¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤ä¸ªæ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œä»è€Œä¸ºç”Ÿäº§ç‡å˜åŒ–çš„æ¥æºæä¾›æ·±åˆ»çš„æ´å¯Ÿï¼š

1.  **æŠ€æœ¯æ•ˆç‡å˜åŒ–ï¼ˆEfficiency Change, ECï¼‰**ï¼šä¹Ÿç§°ä¸ºâ€œè¿½èµ¶æ•ˆåº”â€ï¼ˆCatch-up Effectï¼‰ã€‚å®ƒè¡¡é‡çš„æ˜¯ä¸€ä¸ªDMUè‡ªèº«ç›¸å¯¹äºå…¶æ‰€å¤„æ—¶ä»£çš„æŠ€æœ¯å‰æ²¿çš„æ•ˆç‡å˜åŒ–ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå›ç­”äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œè¿™ä¸ªDMUåœ¨è¿½èµ¶å…¶æ‰€åœ¨æ—¶ä»£çš„æœ€ä½³å®è·µæ–¹é¢ï¼Œæ˜¯è¿›æ­¥äº†è¿˜æ˜¯é€€æ­¥äº†ï¼Ÿâ€
    *   **EC > 1**ï¼šè¡¨ç¤ºæŠ€æœ¯æ•ˆç‡æœ‰æ‰€æ”¹å–„ï¼ŒDMUæ­£åœ¨å‘å…¶æ—¶ä»£çš„ç”Ÿäº§å‰æ²¿é è¿‘ã€‚
    *   **EC < 1**ï¼šè¡¨ç¤ºæŠ€æœ¯æ•ˆç‡å‡ºç°æ¶åŒ–ï¼ŒDMUæ­£åœ¨è¿œç¦»å…¶æ—¶ä»£çš„ç”Ÿäº§å‰æ²¿ã€‚
    *   **EC = 1**ï¼šè¡¨ç¤ºæŠ€æœ¯æ•ˆç‡æ²¡æœ‰å˜åŒ–ã€‚

2.  **æŠ€æœ¯è¿›æ­¥ï¼ˆTechnical Change, TCï¼‰**ï¼šä¹Ÿç§°ä¸ºâ€œå‰æ²¿ç§»åŠ¨æ•ˆåº”â€ï¼ˆFrontier-shift Effectï¼‰ã€‚å®ƒè¡¡é‡çš„æ˜¯æŠ€æœ¯å‰æ²¿æœ¬èº«åœ¨ä¸¤ä¸ªæ—¶æœŸä¹‹é—´çš„ç§»åŠ¨ã€‚è¿™é€šå¸¸åæ˜ äº†ç”±æŠ€æœ¯åˆ›æ–°ã€ç®¡ç†èŒƒå¼é©æ–°æˆ–å®è§‚ç¯å¢ƒæ”¹å–„å¸¦æ¥çš„æ•´ä¸ªè¡Œä¸šçš„è¿›æ­¥ã€‚å®ƒå›ç­”äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œæ•´ä¸ªè¡Œä¸šçš„æŠ€æœ¯æ°´å¹³æ˜¯è¿›æ­¥äº†è¿˜æ˜¯é€€æ­¥äº†ï¼Ÿâ€
    *   **TC > 1**ï¼šè¡¨ç¤ºæŠ€æœ¯å‰æ²¿å‘å¤–æ‰©å¼ ï¼Œå³å‘ç”Ÿäº†æŠ€æœ¯è¿›æ­¥ã€‚è¿™æ„å‘³ç€åœ¨ç›¸åŒçš„æŠ•å…¥æ°´å¹³ä¸‹ï¼Œå¯ä»¥è·å¾—æ›´å¤šçš„äº§å‡ºã€‚
    *   **TC < 1**ï¼šè¡¨ç¤ºæŠ€æœ¯å‰æ²¿å‘å†…æ”¶ç¼©ï¼Œå³å‘ç”Ÿäº†æŠ€æœ¯é€€æ­¥ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å‘ç”Ÿï¼Œä¾‹å¦‚ç”±äºæ–°çš„ã€æ›´ä¸¥æ ¼çš„ç¯å¢ƒæ³•è§„å¯¼è‡´ç”Ÿäº§å¯èƒ½æ€§ä¸‹é™ã€‚
    *   **TC = 1**ï¼šè¡¨ç¤ºæŠ€æœ¯å‰æ²¿æ²¡æœ‰ç§»åŠ¨ã€‚

æ€»çš„å…¨è¦ç´ ç”Ÿäº§ç‡å˜åŒ–ï¼ˆTFPCHï¼‰ç”±è¿™ä¸¤ä¸ªéƒ¨åˆ†ç›¸ä¹˜å¾—åˆ°ï¼š

**TFPCH (Malmquist Index) = EC Ã— TC**

#### B. è§£è¯»MalmquistæŒ‡æ•°

é€šè¿‡å¯¹MalmquistæŒ‡æ•°çš„åˆ†è§£ï¼Œç®¡ç†è€…å¯ä»¥è·å¾—æ¯”å•ä¸€ç”Ÿäº§ç‡æ•°å­—æ›´ä¸°å¯Œçš„ä¿¡æ¯ï¼Œä»è€Œè¿›è¡Œæ›´ç²¾ç¡®çš„è¯Šæ–­ï¼š

*   **TFPCH > 1**ï¼šè¡¨ç¤ºDMUçš„å…¨è¦ç´ ç”Ÿäº§ç‡åœ¨ä¸¤ä¸ªæ—¶æœŸä¹‹é—´æœ‰æ‰€å¢é•¿ã€‚
*   **TFPCH < 1**ï¼šè¡¨ç¤ºDMUçš„å…¨è¦ç´ ç”Ÿäº§ç‡å‡ºç°äº†ä¸‹é™ã€‚
*   **TFPCH = 1**ï¼šè¡¨ç¤ºDMUçš„å…¨è¦ç´ ç”Ÿäº§ç‡æ²¡æœ‰å˜åŒ–ã€‚

æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æç”Ÿäº§ç‡å˜åŒ–çš„é©±åŠ¨å› ç´ ã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªDMUå¯èƒ½éƒ½æœ‰ç›¸åŒçš„TFPCHå€¼ï¼ˆå¦‚1.05ï¼Œè¡¨ç¤º5%çš„å¢é•¿ï¼‰ï¼Œä½†å…¶èƒŒåçš„æ•…äº‹å¯èƒ½å®Œå…¨ä¸åŒï¼š

*   **DMU A**: EC = 1.10, TC = 0.95ã€‚è¿™æ„å‘³ç€è¯¥DMUé€šè¿‡æ”¹å–„å†…éƒ¨ç®¡ç†å’Œè¿è¥ï¼Œå®ç°äº†10%çš„æ•ˆç‡æå‡ï¼ˆè¿½èµ¶æ•ˆåº”ï¼‰ï¼Œä½†æ•´ä¸ªè¡Œä¸šçš„æŠ€æœ¯æ°´å¹³å®é™…ä¸Šæ˜¯é€€æ­¥äº†5%ã€‚è¯¥DMUçš„å¢é•¿æ˜¯å†…ç”Ÿæ€§çš„ï¼Œå®ƒåœ¨é€†å¢ƒä¸­å®ç°äº†è¶…è¶Šã€‚
*   **DMU B**: EC = 0.95, TC = 1.10ã€‚è¿™æ„å‘³ç€è¯¥DMUè™½ç„¶äº«å—äº†æ•´ä¸ªè¡Œä¸šæŠ€æœ¯è¿›æ­¥å¸¦æ¥çš„10%çš„çº¢åˆ©ï¼Œä½†å…¶è‡ªèº«çš„ç®¡ç†æ•ˆç‡å®é™…ä¸Šæ˜¯ä¸‹é™äº†5%ã€‚è¯¥DMUçš„å¢é•¿æ˜¯å¤–ç”Ÿæ€§çš„ï¼Œå®ƒæœªèƒ½è·Ÿä¸ŠæŠ€æœ¯è¿›æ­¥çš„æ­¥ä¼ï¼Œç”šè‡³å‡ºç°äº†ç®¡ç†æ»‘å¡ã€‚

è¿™ç§åˆ†è§£ä½¿å¾—ç®¡ç†è€…èƒ½å¤Ÿæ¸…æ™°åœ°è¾¨åˆ«ï¼Œç»©æ•ˆçš„æ”¹å–„æˆ–æ¶åŒ–ç©¶ç«Ÿæ˜¯æºäºè‡ªèº«çš„åŠªåŠ›ï¼Œè¿˜æ˜¯ä»…ä»…æ­äº†è¡Œä¸šå‘å±•çš„â€œé¡ºé£è½¦â€ï¼ˆæˆ–æˆä¸ºè¡Œä¸šè¡°é€€çš„å—å®³è€…ï¼‰ã€‚

#### C. åº”ç”¨ä¸å±€é™

MalmquistæŒ‡æ•°åœ¨å„ç§é¢†åŸŸéƒ½æœ‰å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚è¯„ä¼°é“¶è¡Œã€åŒ»é™¢ã€åˆ¶é€ ä¼ä¸šã€ç”šè‡³å›½å®¶åœ¨ä¸åŒå¹´ä»½çš„ç”Ÿäº§ç‡å˜åŒ–ã€‚

ç„¶è€Œï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„å±€DENOUNCEDã€‚ä¾‹å¦‚ï¼Œåœ¨å­˜åœ¨éå›ºå®šè§„æ¨¡æŠ¥é…¬çš„æƒ…å†µä¸‹ï¼Œä¼ ç»Ÿçš„MalmquistæŒ‡æ•°å¯èƒ½æ— æ³•å‡†ç¡®åœ°è¡¡é‡ç”Ÿäº§ç‡çš„å˜åŒ–ã€‚æ­¤å¤–ï¼Œè®¡ç®—æŒ‡æ•°æœ‰ä¸åŒçš„æ–¹æ³•ï¼ˆå¦‚åŸºäºç›¸é‚»æ—¶æœŸæˆ–å›ºå®šåŸºæœŸï¼‰ï¼Œè¿™äº›é€‰æ‹©å¯èƒ½ä¼šå½±å“ç»“æœã€‚

å°½ç®¡å¦‚æ­¤ï¼ŒMalmquistæŒ‡æ•°ä½œä¸ºDEAæ¡†æ¶çš„ä¸€ä¸ªé‡è¦åŠ¨æ€æ‰©å±•ï¼Œä¸ºç†è§£å’Œåˆ†æè·¨æ—¶æœŸç»©æ•ˆæ¼”å˜æä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œå¯Œæœ‰æ´å¯ŸåŠ›çš„åˆ†æå·¥å…·ã€‚

### VII. å‰æ²¿æ‹“å±•ï¼šæ‰©å±•DEAæ¡†æ¶

åŸºç¡€çš„CCRå’ŒBCCæ¨¡å‹è™½ç„¶å¼ºå¤§ï¼Œä½†åœ¨å¤„ç†æ›´å¤æ‚çš„ç°å®é—®é¢˜æ—¶å­˜åœ¨å±€é™æ€§ã€‚ä¸ºäº†å…‹æœè¿™äº›ä¸è¶³ï¼ŒDEAé¢†åŸŸå‘å±•å‡ºäº†ä¸€ç³»åˆ—é«˜çº§æ¨¡å‹ï¼Œæå¤§åœ°æ‰©å±•äº†å…¶åˆ†æèƒ½åŠ›å’Œåº”ç”¨èŒƒå›´ã€‚

#### A. å¯¹â€œæœ€ä½³â€è¿›è¡Œæ’åºï¼šè¶…æ•ˆç‡æ¨¡å‹

**é—®é¢˜**ï¼šæ ‡å‡†DEAæ¨¡å‹çš„ä¸€ä¸ªæ˜¾è‘—ç¼ºç‚¹æ˜¯ï¼Œæ‰€æœ‰ä½äºæ•ˆç‡å‰æ²¿ä¸Šçš„DMUéƒ½è¢«èµ‹äºˆç›¸åŒçš„æ•ˆç‡å€¼â€œ1â€ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬æ— æ³•å¯¹è¿™äº›â€œæœ€ä½³å®è·µè€…â€è¿›è¡Œè¿›ä¸€æ­¥çš„åŒºåˆ†å’Œæ’åºã€‚åœ¨èµ„æºåˆ†é…æˆ–è¯„å¥–ç­‰åœºæ™¯ä¸‹ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒAndersenå’ŒPetersenåœ¨1993å¹´æå‡ºäº†**è¶…æ•ˆç‡ï¼ˆSuper-efficiencyï¼‰DEAæ¨¡å‹**ã€‚å…¶æ ¸å¿ƒæ€æƒ³éå¸¸å·§å¦™ï¼šåœ¨è¯„ä¼°æŸä¸€ä¸ªDMUçš„æ•ˆç‡æ—¶ï¼Œæš‚æ—¶å°†å…¶ä»å‚ç…§é›†ä¸­ç§»é™¤ï¼Œç„¶åç”¨å‰©ä½™çš„DMUæ„å»ºæ•ˆç‡å‰æ²¿æ¥è¯„ä¼°å®ƒã€‚

- å¯¹äºä¸€ä¸ªåŸæœ¬æ— æ•ˆç‡çš„DMUï¼Œå…¶æ•ˆç‡å€¼ä¸æ ‡å‡†æ¨¡å‹ç›¸åŒã€‚
- å¯¹äºä¸€ä¸ªåŸæœ¬æœ‰æ•ˆç‡çš„DMUï¼Œç”±äºå®ƒç°åœ¨ä½äºç”±å…¶â€œæ¬¡ä¼˜â€åŒè¡Œæ„å»ºçš„å‰æ²¿ä¹‹å¤–ï¼Œå…¶æ•ˆç‡å¾—åˆ†å°†å¯ä»¥**å¤§äº1**ã€‚

**è§£è¯»**ï¼šè¶…æ•ˆç‡å¾—åˆ†æä¾›äº†ä¸€ä¸ªå¯¹æœ‰æ•ˆDMUè¿›è¡Œæ’åºçš„ä¾æ®ã€‚å¾—åˆ†è¶Šé«˜ï¼Œè¡¨ç¤ºè¯¥DMUçš„æ•ˆç‡æ°´å¹³è¶Šâ€œç¨³å›ºâ€ã€‚è¿™ä¸ªå¾—åˆ†ä¹Ÿå¯ä»¥è¢«è§£è¯»ä¸ºä¸€ç§**ç¨³å®šæ€§æˆ–é²æ£’æ€§çš„åº¦é‡**ï¼šåœ¨ä¸€ä¸ªæŠ•å…¥å¯¼å‘çš„æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªè¶…æ•ˆç‡å¾—åˆ†ä¸º1.2çš„DMUæ„å‘³ç€ï¼Œå³ä½¿å®ƒçš„æ‰€æœ‰æŠ•å…¥éƒ½å¢åŠ 20%ï¼Œå®ƒç›¸å¯¹äºå…¶ä»–DMUè€Œè¨€ä»ç„¶æ˜¯æœ‰æ•ˆçš„ã€‚è¿™ä¸ºå†³ç­–è€…è¯†åˆ«â€œæœ€ä½³ä¸­çš„æœ€ä½³â€æä¾›äº†æœ‰åŠ›çš„å·¥å…·ã€‚

**æ³¨æ„äº‹é¡¹**ï¼šéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¶…æ•ˆç‡æ¨¡å‹åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ— è§£ï¼ˆinfeasibleï¼‰ï¼Œå°¤å…¶æ˜¯åœ¨å¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVRSï¼‰å‡è®¾ä¸‹ï¼Œå½“è¢«è¯„ä¼°DMUçš„æŠ•å…¥äº§å‡ºç»„åˆæ— æ³•è¢«å…¶ä»–DMUçš„ç»„åˆæ‰€åŒ…ç»œæ—¶ã€‚

#### B. æ‰“å¼€â€œé»‘ç®±â€ï¼šç”¨äºå¤šé˜¶æ®µè¿‡ç¨‹çš„ç½‘ç»œDEA

**é—®é¢˜**ï¼šä¼ ç»ŸDEAæ¨¡å‹å°†DMUè§†ä¸ºä¸€ä¸ªâ€œé»‘ç®±â€ï¼Œåªå…³å¿ƒæœ€ç»ˆçš„æŠ•å…¥å’Œäº§å‡ºï¼Œè€Œå¿½ç•¥äº†å…¶å†…éƒ¨å¤æ‚çš„è¿ä½œæµç¨‹å’Œå­å•å…ƒä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚è¿™å¯¼è‡´æˆ‘ä»¬æ— æ³•å®šä½ç»„ç»‡å†…éƒ¨æ•ˆç‡ç“¶é¢ˆçš„å…·ä½“ç¯èŠ‚ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š**ç½‘ç»œDEAï¼ˆNetwork DEAï¼‰æ¨¡å‹é€šè¿‡å°†DMUçš„å†…éƒ¨ç»“æ„å»ºæ¨¡ä¸ºä¸€ç³»åˆ—ç›¸äº’è¿æ¥çš„å­æµç¨‹æˆ–é˜¶æ®µï¼Œä»è€Œæ‰“å¼€äº†è¿™ä¸ªâ€œé»‘ç®±â€ã€‚è¿™äº›é˜¶æ®µé€šè¿‡

ä¸­é—´äº§å“ï¼ˆIntermediate Productsï¼‰**è”ç³»èµ·æ¥â€”â€”ä¸€ä¸ªé˜¶æ®µçš„äº§å‡ºæˆä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„æŠ•å…¥ã€‚

**åº”ç”¨èŒƒä¾‹ï¼ˆé“¶è¡Œä¸šï¼‰**ï¼šç½‘ç»œDEAåœ¨é“¶è¡Œä¸šè¯„ä¼°ä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œä¸€ä¸ªç»å…¸æ¨¡å‹æ˜¯ä¸¤é˜¶æ®µé“¶è¡Œæ•ˆç‡æ¨¡å‹ï¼š

- **ç¬¬ä¸€é˜¶æ®µï¼šè¿è¥æ•ˆç‡ï¼ˆæˆ–å­˜æ¬¾å¸æ”¶æ•ˆç‡ï¼‰**ã€‚æ­¤é˜¶æ®µå…³æ³¨é“¶è¡Œå¦‚ä½•åˆ©ç”¨å…¶ç‰©ç†å’ŒäººåŠ›èµ„æºï¼ˆå¦‚å‘˜å·¥ã€å›ºå®šèµ„äº§ï¼‰æ¥å¸æ”¶èµ„é‡‘ã€‚
  - **æŠ•å…¥**ï¼šå‘˜å·¥äººæ•°ã€è¿è¥æˆæœ¬ã€å›ºå®šèµ„äº§ã€‚
  - **ä¸­é—´äº§å‡º**ï¼šå¸æ”¶çš„å­˜æ¬¾æ€»é¢ã€å…¶ä»–è´Ÿå€ºã€‚
- **ç¬¬äºŒé˜¶æ®µï¼šç›ˆåˆ©æ•ˆç‡ï¼ˆæˆ–èµ„äº§è¿ç”¨æ•ˆç‡ï¼‰**ã€‚æ­¤é˜¶æ®µå…³æ³¨é“¶è¡Œå¦‚ä½•å°†å¸æ”¶æ¥çš„èµ„é‡‘ï¼ˆä¸­é—´äº§å“ï¼‰è½¬åŒ–ä¸ºæ”¶ç›Šã€‚
  - **ä¸­é—´æŠ•å…¥**ï¼šç¬¬ä¸€é˜¶æ®µäº§ç”Ÿçš„å­˜æ¬¾æ€»é¢ã€‚
  - **æœ€ç»ˆäº§å‡º**ï¼šè´·æ¬¾æ€»é¢ã€æŠ•èµ„æ”¶ç›Šã€åˆ©æ¯æ”¶å…¥ã€åˆ©æ¶¦ã€‚

é€šè¿‡ç½‘ç»œDEAï¼Œåˆ†æå¸ˆä¸ä»…å¯ä»¥å¾—åˆ°é“¶è¡Œçš„æ€»ä½“æ•ˆç‡ï¼Œè¿˜èƒ½åˆ†åˆ«è®¡ç®—å‡ºå…¶è¿è¥æ•ˆç‡å’Œç›ˆåˆ©æ•ˆç‡ã€‚è¿™ä½¿å¾—è¯Šæ–­å¯ä»¥æ›´åŠ ç²¾ç¡®ï¼šä¸€å®¶é“¶è¡Œçš„æ•´ä½“æ•ˆç‡ä½ä¸‹ï¼Œç©¶ç«Ÿæ˜¯å› ä¸ºå®ƒå¸æ”¶å­˜æ¬¾çš„æˆæœ¬è¿‡é«˜ï¼ˆç¬¬ä¸€é˜¶æ®µæ— æ•ˆç‡ï¼‰ï¼Œè¿˜æ˜¯å› ä¸ºå®ƒæœªèƒ½æœ‰æ•ˆåœ°å°†è¿™äº›å­˜æ¬¾è½¬åŒ–ä¸ºé«˜æ”¶ç›Šèµ„äº§ï¼ˆç¬¬äºŒé˜¶æ®µæ— æ•ˆç‡ï¼‰ï¼Ÿè¿™ç§ç²¾ç»†åŒ–çš„è¯Šæ–­ä¸ºç®¡ç†æ”¹è¿›æä¾›äº†æ›´æ˜ç¡®çš„æ–¹å‘ã€‚

#### C. æ•æ‰æ—¶é—´ç»´åº¦ï¼šç”¨äºé¢æ¿æ•°æ®åˆ†æçš„åŠ¨æ€DEA

**é—®é¢˜**ï¼šå½“æ‹¥æœ‰è·¨è¶Šå¤šä¸ªæ—¶æœŸçš„æ•°æ®ï¼ˆå³é¢æ¿æ•°æ®ï¼‰æ—¶ï¼Œä½¿ç”¨é™æ€DEAæ¨¡å‹åœ¨æ¯ä¸ªæ—¶æœŸç‹¬ç«‹è¿›è¡Œåˆ†æä¼šå¿½ç•¥æ—¶æœŸä¹‹é—´çš„å†…åœ¨è”ç³»ï¼Œå¯èƒ½å¯¼è‡´è¯¯å¯¼æ€§çš„ç»“è®ºã€‚ä¾‹å¦‚ï¼Œæœ¬å¹´åº¦çš„èµ„æœ¬æŠ•èµ„ï¼ˆæŠ•å…¥ï¼‰å¯èƒ½ä¼šåœ¨æœªæ¥å‡ å¹´æ‰äº§ç”Ÿæ•ˆç›Šï¼ˆäº§å‡ºï¼‰ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š**åŠ¨æ€DEAï¼ˆDynamic DEAï¼‰**æ¨¡å‹é€šè¿‡å¼•å…¥**ç»“è½¬å˜é‡ï¼ˆCarry-over Variablesï¼‰**æ¥æ˜ç¡®åœ°è¿æ¥è¿ç»­çš„æ—¶é—´å‘¨æœŸã€‚ç»“è½¬å˜é‡ä»£è¡¨äº†é‚£äº›å¯ä»¥ä»ä¸€ä¸ªæ—¶æœŸâ€œæºå¸¦â€åˆ°ä¸‹ä¸€ä¸ªæ—¶æœŸçš„å› ç´ ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ï¼š

- **æœŸæœ›çš„ï¼ˆDesirableï¼‰**ï¼šå¦‚å›ºå®šèµ„äº§ã€ç ”å‘æŠ•å…¥ã€ç•™å­˜æ”¶ç›Šã€çŸ¥è¯†å­˜é‡ã€‚
- **ä¸æœŸæœ›çš„ï¼ˆUndesirableï¼‰**ï¼šå¦‚åè´¦ã€ç´¯ç§¯çš„æ±¡æŸ“ç‰©ã€‚
- **è‡ªç”±çš„ï¼ˆFreeï¼‰**ï¼šå¯ç”±ç®¡ç†è€…è‡ªè¡Œå†³å®šçš„ã€‚
- **å›ºå®šçš„ï¼ˆFixedï¼‰**ï¼šç®¡ç†è€…æ— æ³•æ§åˆ¶çš„ã€‚

**è§£è¯»**ï¼šåŠ¨æ€DEAä¸ä»…è¯„ä¼°æ¯ä¸ªæ—¶æœŸçš„æ•ˆç‡ï¼Œè¿˜è¯„ä¼°æ•´ä¸ªè€ƒå¯ŸæœŸå†…çš„**ç³»ç»Ÿæ€»æ•ˆç‡**ã€‚å®ƒæ­ç¤ºäº†ç³»ç»Ÿæ€»æ•ˆç‡ä¸å„æ—¶æœŸæ•ˆç‡ä¹‹é—´çš„æ•°å­¦å…³ç³»â€”â€”ç³»ç»Ÿæ€»æ•ˆç‡çš„è¡¥æ•°æ˜¯å„æ—¶æœŸæ•ˆç‡è¡¥æ•°çš„çº¿æ€§ç»„åˆã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿæ›´å‡†ç¡®åœ°æç»˜DMUçš„é•¿æœŸç»©æ•ˆæ¼”å˜è½¨è¿¹ï¼Œå¹¶è¯„ä¼°å…¶èµ„æºè·¨æœŸé…ç½®çš„æœ‰æ•ˆæ€§ã€‚

#### D. è€ƒè™‘å¤–éƒ¨æ€§ï¼šåŒ…å«éæœŸæœ›äº§å‡ºçš„æ¨¡å‹

**é—®é¢˜**ï¼šè®¸å¤šç”Ÿäº§è¿‡ç¨‹åœ¨äº§ç”ŸæœŸæœ›äº§å‡ºï¼ˆå¦‚äº§å“ã€åˆ©æ¶¦ï¼‰çš„åŒæ—¶ï¼Œä¹Ÿä¼šä¸å¯é¿å…åœ°äº§ç”Ÿ**éæœŸæœ›äº§å‡ºï¼ˆUndesirable Outputsï¼‰**ï¼Œå¦‚å·¥ä¸šæ±¡æŸ“ã€åè´¦ã€åŒ»ç–—äº‹æ•…ç­‰ã€‚å¦‚æœæ¨¡å‹å¿½ç•¥è¿™äº›è´Ÿé¢äº§å‡ºï¼Œå°±ä¼šé«˜ä¼°é‚£äº›ä»¥ç¯å¢ƒæˆ–ç¤¾ä¼šä¸ºä»£ä»·æ¢å–ç»æµæ•ˆç›Šçš„DMUçš„æ•ˆç‡ï¼Œä»è€Œå¾—å‡ºæœ‰åçš„ã€ä¸è´Ÿè´£ä»»çš„ç»“è®ºã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šä¸ºäº†å°†éæœŸæœ›äº§å‡ºçº³å…¥æ¨¡å‹ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†å¤šç§æ–¹æ³•ã€‚

1. **è§†ä¸ºæŠ•å…¥æ³•**ï¼šä¸€ç§ç›´è§‚ä¸”å¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨æ•°å­¦æ¨¡å‹ä¸­å°†éæœŸæœ›äº§å‡ºåƒæŠ•å…¥ä¸€æ ·å¯¹å¾…ï¼Œå› ä¸ºä¼˜åŒ–çš„ç›®æ ‡éƒ½æ˜¯æœ€å°åŒ–ã€‚
2. **æ•°æ®è½¬æ¢æ³•**ï¼šä¾‹å¦‚ï¼Œå¯¹éæœŸæœ›äº§å‡ºçš„å€¼å–å€’æ•°æˆ–ä¹˜ä»¥-1ã€‚ä½†è¿™ç§æ–¹æ³•å¯èƒ½å¼•å…¥æ–°çš„é—®é¢˜ï¼Œå¦‚äº§ç”Ÿè´Ÿå€¼ï¼Œè€Œæ ‡å‡†DEAæ¨¡å‹æ— æ³•å¤„ç†è´Ÿå€¼ã€‚
3. **æ–¹å‘æ€§è·ç¦»å‡½æ•°æ³•**ï¼šè¿™æ˜¯ä¸€ç§æ›´å…ˆè¿›çš„æ–¹æ³•ï¼Œå®ƒåœ¨ä¸€ä¸ªå‘é‡æ–¹å‘ä¸ŠåŒæ—¶å¯»æ±‚å¢åŠ æœŸæœ›äº§å‡ºå’Œå‡å°‘éæœŸæœ›äº§å‡ºã€‚

**å¤„ç½®æ€§å‡è®¾**ï¼šåœ¨å¤„ç†éæœŸæœ›äº§å‡ºæ—¶ï¼Œä¸€ä¸ªå…³é”®çš„å»ºæ¨¡é€‰æ‹©æ˜¯å…³äºå…¶**å¤„ç½®æ€§ï¼ˆDisposabilityï¼‰**çš„å‡è®¾ã€‚

- **å¼ºå¤„ç½®æ€§ï¼ˆStrong Disposabilityï¼‰**ï¼šå‡è®¾éæœŸæœ›äº§å‡ºå¯ä»¥æ— æˆæœ¬åœ°ã€è‡ªç”±åœ°å‡å°‘ï¼Œè€Œä¸å½±å“æœŸæœ›äº§å‡ºçš„ç”Ÿäº§ã€‚è¿™é€šå¸¸ä¸ç¬¦åˆç°å®ã€‚
- **å¼±å¤„ç½®æ€§ï¼ˆWeak Disposabilityï¼‰**ï¼šå‡è®¾å‡å°‘éæœŸæœ›äº§å‡ºæ˜¯æœ‰æˆæœ¬çš„ï¼Œé€šå¸¸éœ€è¦æŒ‰æ¯”ä¾‹å‡å°‘æœŸæœ›äº§å‡ºã€‚ä¾‹å¦‚ï¼Œå‘ç”µå‚è¦å‡å°‘äºŒæ°§åŒ–ç¡«æ’æ”¾ï¼Œå¯èƒ½éœ€è¦é™ä½å‘ç”µé‡æˆ–æŠ•å…¥æ˜‚è´µçš„è„±ç¡«è®¾å¤‡ã€‚è¿™ä¸ªå‡è®¾æ›´ä¸ºç°å®ã€‚

**åº”ç”¨èŒƒä¾‹ï¼ˆå‘ç”µå‚ï¼‰**ï¼šåœ¨è¯„ä¼°ç‡ƒç…¤å‘ç”µå‚çš„æ•ˆç‡æ—¶ï¼Œæ¨¡å‹ä¼šåŒ…å«æŠ•å…¥ï¼ˆå¦‚ç…¤ç‚­ã€åŠ³åŠ¨åŠ›ï¼‰ã€æœŸæœ›äº§å‡ºï¼ˆå¦‚å‘ç”µé‡ï¼‰å’ŒéæœŸæœ›äº§å‡ºï¼ˆå¦‚äºŒæ°§åŒ–ç¡«ã€æ°®æ°§åŒ–ç‰©æ’æ”¾é‡ï¼‰ã€‚é‡‡ç”¨å¼±å¤„ç½®æ€§å‡è®¾çš„æ¨¡å‹ä¼šæ­£ç¡®åœ°è¯†åˆ«å‡ºé‚£äº›åœ¨ç»´æŒé«˜å‘ç”µé‡çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ§åˆ¶æ±¡æŸ“æ’æ”¾çš„ç”µå‚ä¸ºé«˜æ•ˆç”µå‚ã€‚

è¿™äº›é«˜çº§æ¨¡å‹çš„æ¼”è¿›è½¨è¿¹æ¸…æ™°åœ°è¡¨æ˜ï¼ŒDEAæ­£ä»ä¸€ä¸ªç®€å•çš„ã€é™æ€çš„ã€èšåˆçš„ç»©æ•ˆè¯„åˆ†å·¥å…·ï¼Œå‘ä¸€ä¸ªæ›´åŠ ç²¾ç»†ã€åŠ¨æ€ã€ä¸”ç»“æ„åŒ–çš„è¯Šæ–­ç³»ç»Ÿå‘å±•ã€‚å®ƒåæ˜ äº†ç°ä»£ç»„ç»‡æ—¥ç›Šå¢é•¿çš„å¤æ‚æ€§ï¼Œä»¥åŠå¯¹èƒ½å¤Ÿæ¨¡æ‹Ÿå†…éƒ¨æµç¨‹ã€æ—¶é—´åŠ¨æ€å’Œå¤–éƒ¨çº¦æŸçš„åˆ†æå·¥å…·çš„è¿«åˆ‡éœ€æ±‚ï¼Œä¸ºç®¡ç†è€…æä¾›äº†ä¸€ä¸ªè¿œæ¯”åˆæœŸæ¨¡å‹ä¸°å¯Œå’Œç°å®çš„è¯Šæ–­å·¥å…·ç®±ã€‚

### VII. æ¯”è¾ƒè§†è§’ï¼šå°†DEAç½®äºç»©æ•ˆå·¥å…·è°±ç³»ä¸­

ä¸ºäº†å……åˆ†ç†è§£DEAçš„ä»·å€¼å’Œé€‚ç”¨èŒƒå›´ï¼Œæœ‰å¿…è¦å°†å…¶ä¸å¦å¤–ä¸¤ç§ä¸»æµçš„ç»©æ•ˆè¯„ä¼°å·¥å…·â€”â€”éšæœºå‰æ²¿åˆ†æï¼ˆSFAï¼‰å’Œä¼ ç»Ÿæ¯”ç‡åˆ†æâ€”â€”è¿›è¡Œæ¯”è¾ƒã€‚

#### A. DEA ä¸ éšæœºå‰æ²¿åˆ†æï¼ˆSFAï¼‰

DEAå’ŒSFAæ˜¯å‰æ²¿åˆ†æé¢†åŸŸçš„ä¸¤å¤§ä¸»æµæ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ—¨åœ¨è¯„ä¼°DMUç›¸å¯¹äºä¸€ä¸ªâ€œæœ€ä½³å®è·µâ€å‰æ²¿çš„æ•ˆç‡ï¼Œä½†å…¶å“²å­¦åŸºç¡€å’ŒæŠ€æœ¯è·¯å¾„æˆªç„¶ä¸åŒã€‚

- **æ ¸å¿ƒå·®å¼‚**ï¼šæœ€æ ¹æœ¬çš„åŒºåˆ«åœ¨äºï¼ŒDEAæ˜¯ä¸€ç§**éå‚æ•°ã€ç¡®å®šæ€§**çš„æ•°å­¦è§„åˆ’æ–¹æ³•ï¼Œè€ŒSFAæ˜¯ä¸€ç§**å‚æ•°åŒ–ã€éšæœºæ€§**çš„è®¡é‡ç»æµå­¦æ–¹æ³•ã€‚
- **å…³é”®åŒºåˆ«ç‚¹**ï¼š
  1. **å‡½æ•°å½¢å¼**ï¼šSFAè¦æ±‚ç ”ç©¶è€…é¢„å…ˆè®¾å®šä¸€ä¸ªå…·ä½“çš„ç”Ÿäº§æˆ–æˆæœ¬å‡½æ•°å½¢å¼ï¼ˆå¦‚Cobb-Douglasæˆ–Translogå‡½æ•°ï¼‰ï¼Œè€ŒDEAåˆ™æ— éœ€ä»»ä½•å‡½æ•°å½¢å¼çš„å‡è®¾ã€‚è¿™ä½¿å¾—DEAåœ¨ç”Ÿäº§æŠ€æœ¯æœªçŸ¥æˆ–å¤æ‚æ—¶æ›´å…·çµæ´»æ€§ï¼Œä½†ä¹Ÿä½¿å¾—SFAåœ¨å‡½æ•°å½¢å¼è®¾å®šæ­£ç¡®æ—¶èƒ½æä¾›å…³äºç”Ÿäº§æŠ€æœ¯å¼¹æ€§çš„ä¿¡æ¯ã€‚
  2. **è¯¯å·®é¡¹å¤„ç†**ï¼šè¿™æ˜¯ä¸¤è€…æœ€å…³é”®çš„åŒºåˆ«ã€‚SFAå°†DMUåç¦»æ•ˆç‡å‰æ²¿çš„è·ç¦»åˆ†è§£ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š**éšæœºè¯¯å·®é¡¹**ï¼ˆä»£è¡¨æµ‹é‡è¯¯å·®ã€æ•°æ®å™ªå£°ã€è¿æ°”ç­‰ä¸å¯æ§å› ç´ ï¼‰å’Œ**æŠ€æœ¯æ— æ•ˆç‡é¡¹**ï¼ˆä»£è¡¨ç®¡ç†ä¸å–„ç­‰å¯æ§å› ç´ ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒDEAæ˜¯ç¡®å®šæ€§çš„ï¼Œå®ƒå°†æ‰€æœ‰åç¦»å‰æ²¿çš„è·ç¦»éƒ½å½’å› äº**æŠ€æœ¯æ— æ•ˆç‡**ã€‚
  3. **å¯¹æ•°æ®è¯¯å·®çš„æ•æ„Ÿæ€§**ï¼šç”±äºDEAçš„ç¡®å®šæ€§æœ¬è´¨ï¼Œå®ƒå¯¹æ•°æ®ä¸­çš„å¼‚å¸¸å€¼æˆ–æµ‹é‡è¯¯å·®éå¸¸æ•æ„Ÿï¼Œä¸€ä¸ªæç«¯çš„æ•°æ®ç‚¹å°±å¯èƒ½æ‰­æ›²æ•´ä¸ªæ•ˆç‡å‰æ²¿ã€‚SFAç”±äºåŒ…å«äº†éšæœºè¯¯å·®é¡¹ï¼Œå¯¹è¿™ç±»æ•°æ®é—®é¢˜é€šå¸¸æ›´ä¸ºç¨³å¥ã€‚
  4. **ç»Ÿè®¡æ¨æ–­**ï¼šä½œä¸ºä¸€ç§è®¡é‡ç»æµå­¦æ–¹æ³•ï¼ŒSFAå…è®¸ç ”ç©¶è€…å¯¹å…¶å‚æ•°è¿›è¡Œæ ‡å‡†çš„ç»Ÿè®¡å‡è®¾æ£€éªŒï¼Œä¾‹å¦‚æ£€éªŒæŸäº›å¤–éƒ¨ç¯å¢ƒå˜é‡å¯¹æ•ˆç‡çš„å½±å“ã€‚è€Œç”¨DEAçš„ç»“æœè¿›è¡Œç»Ÿè®¡æ¨æ–­åˆ™ç›¸å¯¹å›°éš¾ï¼Œå°½ç®¡è‡ªåŠ©æ³•ï¼ˆBootstrappingï¼‰ç­‰æŠ€æœ¯çš„å‘å±•åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†è¿™ä¸€ç¼ºé™·ã€‚
- **åº”ç”¨åœºæ™¯é€‰æ‹©**ï¼šä¸¤ç§æ–¹æ³•å¹¶æ— ç»å¯¹ä¼˜åŠ£ï¼Œé€‰æ‹©å–å†³äºç ”ç©¶ç›®çš„å’Œæ•°æ®ç‰¹æ€§ã€‚
  - **é€‰æ‹©DEA**ï¼šå½“ç”Ÿäº§æŠ€æœ¯å½¢å¼æœªçŸ¥æˆ–éš¾ä»¥è®¾å®šï¼Œä¸”æ•°æ®è´¨é‡è¾ƒé«˜ã€æµ‹é‡è¯¯å·®è¾ƒå°æ—¶ï¼ŒDEAæ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚
  - **é€‰æ‹©SFA**ï¼šå½“æœ‰ç†ç”±ç›¸ä¿¡éšæœºå†²å‡»å¯¹äº§å‡ºæœ‰æ˜¾è‘—å½±å“ï¼Œæˆ–è€…ç ”ç©¶çš„ä¸»è¦ç›®çš„æ˜¯è¿›è¡Œç»Ÿè®¡æ¨æ–­å’Œå‡è®¾æ£€éªŒæ—¶ï¼ŒSFAæ˜¯é¦–é€‰æ–¹æ³•ã€‚

#### B. DEA ä¸ ä¼ ç»Ÿæ¯”ç‡åˆ†æ

ä¼ ç»Ÿæ¯”ç‡åˆ†æï¼Œå°¤å…¶æ˜¯è´¢åŠ¡æ¯”ç‡åˆ†æï¼ˆå¦‚èµ„äº§å›æŠ¥ç‡ROAã€äººå‡é”€å”®é¢ï¼‰ï¼Œæ˜¯å•†ä¸šé¢†åŸŸæœ€å¸¸ç”¨ã€æœ€ç›´è§‚çš„ç»©æ•ˆè¯„ä¼°å·¥å…·ã€‚ç„¶è€Œï¼Œä¸DEAç›¸æ¯”ï¼Œå…¶å±€é™æ€§ä¹Ÿååˆ†æ˜æ˜¾ã€‚

- **æ¯”ç‡åˆ†æçš„é—®é¢˜**ï¼š
  1. **ç»´åº¦å•ä¸€**ï¼šæ¯ä¸ªæ¯”ç‡é€šå¸¸åªè€ƒè™‘ä¸€ä¸ªæŠ•å…¥å’Œä¸€ä¸ªäº§å‡ºï¼Œæ— æ³•æ•æ‰å¤šç»´åº¦çš„ç»©æ•ˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé“¶è¡Œåˆ†è¡Œå¯èƒ½ROAå¾ˆé«˜ï¼Œä½†å®¢æˆ·æ»¡æ„åº¦å¾ˆä½ã€‚
  2. **ä¿¡å·å†²çª**ï¼šåœ¨è¯„ä¼°æ•´ä½“ç»©æ•ˆæ—¶ï¼Œä¸åŒçš„æ¯”ç‡å¸¸å¸¸ä¼šç»™å‡ºç›¸äº’çŸ›ç›¾çš„ä¿¡å·ã€‚ä¸€ä¸ªå…¬å¸å¯èƒ½ç›ˆåˆ©èƒ½åŠ›æ¯”ç‡å¾ˆé«˜ï¼Œä½†æµåŠ¨æ€§æ¯”ç‡å¾ˆå·®ï¼Œè¿™ä½¿å¾—å¯¹æ•´ä½“ç»©æ•ˆçš„åˆ¤æ–­å˜å¾—ä¸»è§‚å’Œå›°éš¾ã€‚
  3. **æƒé‡ä¸»è§‚**ï¼šå¦‚æœè¦å°†å¤šä¸ªæ¯”ç‡æ•´åˆæˆä¸€ä¸ªç»¼åˆæŒ‡æ•°ï¼Œæƒé‡çš„è®¾å®šå¾€å¾€æ˜¯ä¸»è§‚çš„ï¼Œç¼ºä¹å®¢è§‚ä¾æ®ã€‚
- **DEAçš„ä¼˜åŠ¿**ï¼šDEAå®Œç¾åœ°è§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚å®ƒèƒ½å¤Ÿå°†å¤šä¸ªä¸åŒå•ä½çš„æŠ•å…¥å’Œäº§å‡ºï¼Œé€šè¿‡çº¿æ€§è§„åˆ’å®¢è§‚åœ°èµ‹äºˆæƒé‡ï¼Œä»è€Œæ•´åˆè¿›ä¸€ä¸ªå•ä¸€ã€å…¨é¢çš„æ•ˆç‡å¾—åˆ†ä¸­ã€‚DEAæä¾›äº†ä¸€ä¸ªæ›´åŠ æ•´ä½“å’Œç³»ç»Ÿçš„ç»©æ•ˆè§†å›¾ã€‚
- **äº’è¡¥å…³ç³»**ï¼šå°½ç®¡DEAåœ¨ç»¼åˆè¯„ä¼°ä¸Šæ›´ä¼˜ï¼Œä½†è¿™ä¸¤ç§æ–¹æ³•å¯ä»¥è¢«è§†ä¸ºäº’è¡¥è€Œéç›¸äº’æ›¿ä»£ã€‚æ¯”ç‡åˆ†æå¯ä»¥ä½œä¸ºDEAåˆ†æçš„å‰æœŸæ¢ç´¢æ­¥éª¤ï¼Œå¸®åŠ©è¯†åˆ«å’Œç­›é€‰é‡è¦çš„æŠ•å…¥äº§å‡ºå˜é‡ã€‚åè¿‡æ¥ï¼ŒDEAåˆ†æçš„ç»“æœå¯ä»¥ä¸ºè§£è¯»å•ä¸ªæ¯”ç‡æä¾›ä¸€ä¸ªå®è§‚çš„ã€ç»¼åˆçš„ç»©æ•ˆèƒŒæ™¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå…¬å¸çš„DEAæ•ˆç‡å¾—åˆ†å¾ˆé«˜ï¼Œé‚£ä¹ˆå³ä½¿å…¶æŸä¸ªè´¢åŠ¡æ¯”ç‡çœ‹èµ·æ¥ä¸ä½³ï¼Œä¹Ÿå¯èƒ½è¯´æ˜è¯¥å…¬å¸åœ¨å…¶ä»–æ–¹é¢æœ‰å“è¶Šè¡¨ç°ï¼Œä»è€Œå¼¥è¡¥äº†è¿™ä¸€çŸ­æ¿ã€‚

**è¡¨3ï¼šDEAä¸éšæœºå‰æ²¿åˆ†æï¼ˆSFAï¼‰çš„æ–¹æ³•è®ºæ¯”è¾ƒ**

| æ ‡å‡†                          | æ•°æ®åŒ…ç»œåˆ†æ (DEA)                                   | éšæœºå‰æ²¿åˆ†æ (SFA)                                     |
| ----------------------------- | ---------------------------------------------------- | ------------------------------------------------------ |
| **æ–¹æ³•è®ºç±»å‹**                | éå‚æ•°åŒ–                                             | å‚æ•°åŒ–                                                 |
| **æ ¸å¿ƒæŠ€æœ¯**                  | æ•°å­¦è§„åˆ’ï¼ˆçº¿æ€§è§„åˆ’ï¼‰                                 | è®¡é‡ç»æµå­¦ï¼ˆå¦‚æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼‰                           |
| **å‡½æ•°å½¢å¼å‡è®¾**              | æ— éœ€é¢„è®¾ç”Ÿäº§æˆ–æˆæœ¬å‡½æ•°                               | å¿…é¡»é¢„è®¾å…·ä½“çš„å‡½æ•°å½¢å¼ï¼ˆå¦‚Cobb-Douglas, Translogï¼‰     |
| **å¯¹åç¦»å‰æ²¿çš„å¤„ç†**          | æ‰€æœ‰åç¦»å‡è§†ä¸ºæŠ€æœ¯æ— æ•ˆç‡                             | å°†åç¦»åˆ†è§£ä¸ºéšæœºè¯¯å·®å’ŒæŠ€æœ¯æ— æ•ˆç‡ä¸¤éƒ¨åˆ†                 |
| **å¤„ç†å¤šäº§å‡ºçš„èƒ½åŠ›**          | å¤©ç„¶æ”¯æŒå¤šæŠ•å…¥ã€å¤šäº§å‡º                               | æ ‡å‡†æ¨¡å‹é€šå¸¸å¤„ç†å•äº§å‡ºï¼Œå¤šäº§å‡ºéœ€å€ŸåŠ©è·ç¦»å‡½æ•°ç­‰å¤æ‚å½¢å¼ |
| **å¯¹å¼‚å¸¸å€¼/æ•°æ®è¯¯å·®çš„æ•æ„Ÿæ€§** | é«˜åº¦æ•æ„Ÿï¼Œå¼‚å¸¸å€¼å¯èƒ½æ‰­æ›²å‰æ²¿                         | ç›¸å¯¹ç¨³å¥ï¼Œéšæœºè¯¯å·®é¡¹å¯ä»¥å¸æ”¶éƒ¨åˆ†æ•°æ®å™ªå£°               |
| **ç»Ÿè®¡æ¨æ–­èƒ½åŠ›**              | æœ‰é™ï¼Œéœ€å€ŸåŠ©è‡ªåŠ©æ³•ï¼ˆBootstrappingï¼‰ç­‰é«˜çº§æŠ€æœ¯        | å¼ºå¤§ï¼Œå¯ç›´æ¥å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œå‡è®¾æ£€éªŒ                     |
| **ä¸»è¦ä¼˜åŠ¿**                  | çµæ´»æ€§é«˜ï¼Œå‡è®¾å°‘ï¼Œæ— éœ€æŒ‡å®šå‡½æ•°å½¢å¼ï¼Œç›´è§‚             | èƒ½åŒºåˆ†æ— æ•ˆç‡å’Œéšæœºå™ªå£°ï¼Œå¯è¿›è¡Œç»Ÿè®¡æ¨æ–­                 |
| **ä¸»è¦åŠ£åŠ¿**                  | å¯¹æ•°æ®å™ªå£°æ•æ„Ÿï¼Œæ— æ³•è¿›è¡Œæ ‡å‡†ç»Ÿè®¡æ£€éªŒï¼Œç»“æœä¸ºç›¸å¯¹æ•ˆç‡ | ä¾èµ–ä¸¥æ ¼çš„å‡½æ•°å½¢å¼å’Œåˆ†å¸ƒå‡è®¾ï¼Œè‹¥å‡è®¾é”™è¯¯åˆ™ç»“æœæœ‰å     |

### VIII. DEAå®è·µï¼šè¡Œä¸šåº”ç”¨è“å›¾

DEAçš„ç†è®ºæ¡†æ¶å…·æœ‰é«˜åº¦çš„æ™®é€‚æ€§ï¼Œä½¿å…¶åœ¨ä¼—å¤šè¡Œä¸šä¸­éƒ½æ‰¾åˆ°äº†ç”¨æ­¦ä¹‹åœ°ã€‚æœ¬èŠ‚å°†å±•ç¤ºDEAåœ¨ä¸‰ä¸ªå…³é”®é¢†åŸŸçš„å…·ä½“åº”ç”¨è“å›¾ï¼Œè¯¦ç»†è¯´æ˜åœ¨è¿™äº›åœºæ™¯ä¸‹å…¸å‹çš„æŠ•å…¥ã€äº§å‡ºæŒ‡æ ‡é€‰æ‹©å’Œåˆ†æè§†è§’ã€‚

#### A. è¯„ä¼°é‡‘èä¸­ä»‹ï¼šé“¶è¡Œä¸š

é“¶è¡Œä¸šæ˜¯DEAåº”ç”¨æœ€å¹¿æ³›å’Œæœ€æˆç†Ÿçš„é¢†åŸŸä¹‹ä¸€ã€‚è¯„ä¼°é“¶è¡Œæ•ˆç‡æ—¶ï¼Œé€šå¸¸æœ‰ä¸¤ç§ä¸»æµçš„å»ºæ¨¡æ€è·¯ï¼š

1. **ç”Ÿäº§æ³•ï¼ˆProduction Approachï¼‰**ï¼šè¿™ç§æ–¹æ³•å°†é“¶è¡Œè§†ä¸ºæœåŠ¡çš„â€œç”Ÿäº§è€…â€ã€‚å®ƒæ›´å…³æ³¨é“¶è¡Œçš„è¿è¥æ•ˆç‡ã€‚
   - **å…¸å‹æŠ•å…¥**ï¼šåŠ³åŠ¨åŠ›ï¼ˆå¦‚å‘˜å·¥äººæ•°ï¼‰ã€èµ„æœ¬ï¼ˆå¦‚å›ºå®šèµ„äº§ï¼‰ã€‚
   - **å…¸å‹äº§å‡º**ï¼šæœåŠ¡çš„æ•°é‡ï¼ˆå¦‚å¤„ç†çš„å­˜è´·æ¬¾è´¦æˆ·æ•°é‡ã€äº¤æ˜“ç¬”æ•°ï¼‰ã€‚
2. **ä¸­ä»‹æ³•ï¼ˆIntermediation Approachï¼‰**ï¼šè¿™ç§æ–¹æ³•å°†é“¶è¡Œè§†ä¸ºèµ„é‡‘çš„â€œä¸­ä»‹è€…â€ï¼Œæ˜¯ç›®å‰æ›´ä¸ºä¸»æµçš„æ–¹æ³•ã€‚å®ƒå…³æ³¨é“¶è¡Œå¸æ”¶èµ„é‡‘å¹¶å°†å…¶è½¬åŒ–ä¸ºç”Ÿæ¯èµ„äº§çš„æ ¸å¿ƒåŠŸèƒ½ã€‚
   - **å…¸å‹æŠ•å…¥**ï¼šé“¶è¡Œå¸æ”¶çš„èµ„é‡‘ï¼Œå¦‚å„é¡¹å­˜æ¬¾ã€åŒä¸šæ‹†å…¥ã€è¿è¥æˆæœ¬ã€å‘˜å·¥äººæ•°ã€è‚¡ä¸œæƒç›Šã€‚
   - **å…¸å‹äº§å‡º**ï¼šé“¶è¡Œè¿ç”¨çš„èµ„é‡‘ï¼Œå¦‚å„é¡¹è´·æ¬¾ã€è¯åˆ¸æŠ•èµ„ã€åˆ©æ¯æ”¶å…¥ã€éåˆ©æ¯æ”¶å…¥ã€åˆ©æ¶¦ã€‚

**åº”ç”¨åœºæ™¯**ï¼š

- **ç»¼åˆæ•ˆç‡è¯„ä¼°**ï¼šæ¯”è¾ƒä¸åŒé“¶è¡Œæˆ–åŒä¸€é“¶è¡Œä¸åŒåˆ†è¡Œé—´çš„ç›¸å¯¹æ•ˆç‡ï¼Œè¯†åˆ«æœ€ä½³å®è·µè€…å’Œè½åè€…ã€‚
- **é“¶è¡Œå€’é—­é¢„æµ‹**ï¼šç ”ç©¶å‘ç°ï¼ŒDEAæ•ˆç‡å¾—åˆ†å¯ä»¥ä½œä¸ºè¡¡é‡é“¶è¡Œç®¡ç†è´¨é‡ï¼ˆCAMELè¯„çº§ä¸­çš„â€œMâ€ï¼‰çš„æœ‰æ•ˆä»£ç†å˜é‡ï¼Œå¹¶æ˜¾è‘—æå‡é“¶è¡Œå€’-é—­é¢„æµ‹æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚
- **æŠ€æœ¯ä¸åˆ›æ–°å½±å“è¯„ä¼°**ï¼šé€šè¿‡å°†ä¿¡æ¯æŠ€æœ¯æŠ•èµ„ã€ATMæœºæ•°é‡ç­‰ä½œä¸ºæŠ•å…¥ï¼Œè¯„ä¼°é‡‘èåˆ›æ–°ï¼ˆå¦‚ç½‘ä¸Šé“¶è¡Œã€ç§»åŠ¨é“¶è¡Œï¼‰å¯¹é“¶è¡Œæ•ˆç‡å’Œä»·å€¼åˆ›é€ çš„è´¡çŒ®ã€‚

#### B. è¡¡é‡æœåŠ¡äº¤ä»˜ï¼šåŒ»ç–—ä¸åŒ»é™¢ç»©æ•ˆ

åœ¨èµ„æºæ—¥ç›Šç´§å¼ çš„åŒ»ç–—å¥åº·é¢†åŸŸï¼ŒDEAå·²æˆä¸ºè¯„ä¼°åŒ»é™¢ã€è¯Šæ‰€ç­‰åŒ»ç–—æœºæ„æ•ˆç‡çš„é‡è¦å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨æ–°å† ç–«æƒ…ç­‰é‡å¤§å…¬å…±å«ç”Ÿäº‹ä»¶çš„èƒŒæ™¯ä¸‹ï¼Œå…¶ä»·å€¼æ„ˆå‘å‡¸æ˜¾ã€‚

- **å…¸å‹æŠ•å…¥**ï¼š
  - **äººåŠ›èµ„æº**ï¼šåŒ»ç”Ÿæ•°é‡ã€æŠ¤å£«æ•°é‡ã€è¯å‰‚å¸ˆæ•°é‡ã€å…¶ä»–åŒ»æŠ€å’Œè¡Œæ”¿äººå‘˜æ•°é‡ã€‚
  - **èµ„æœ¬èµ„æº**ï¼šåºŠä½æ•°ã€æ˜‚è´µåŒ»ç–—è®¾å¤‡ï¼ˆå¦‚MRIã€CTï¼‰æ•°é‡ã€è¿è¥æˆæœ¬ã€‚
- **å…¸å‹äº§å‡º**ï¼šäº§å‡ºçš„é€‰æ‹©éœ€å…¼é¡¾æ•°é‡å’Œè´¨é‡ã€‚
  - **æœŸæœ›äº§å‡ºï¼ˆDesirable Outputsï¼‰**ï¼šä½é™¢å¤©æ•°ã€é—¨è¯Šäººæ¬¡ã€æ€¥è¯Šäººæ¬¡ã€æ‰‹æœ¯å°æ•°ã€æ²»æ„ˆæ‚£è€…æ•°ã€æ‚£è€…æ»¡æ„åº¦å¾—åˆ†ã€‚
  - **éæœŸæœ›äº§å‡ºï¼ˆUndesirable Outputsï¼‰**ï¼šé™¢å†…æ„ŸæŸ“ç‡ã€æ‚£è€…å†å…¥é™¢ç‡ã€æ­»äº¡ç‡ã€åŒ»ç–—åºŸå¼ƒç‰©é‡ã€‚

**åº”ç”¨åœºæ™¯**ï¼š

- **åŒ»é™¢æ ‡æ†ç®¡ç†**ï¼šè¯†åˆ«æ•ˆç‡ä½ä¸‹çš„åŒ»é™¢ï¼Œå¹¶ä¸ºå…¶æä¾›ç”±é«˜æ•ˆåŒè¡Œæ„æˆçš„å‚ç…§é›†ï¼Œä»¥ä¾›å­¦ä¹ æ”¹è¿›ã€‚
- **èµ„æºé…ç½®ä¼˜åŒ–**ï¼šé€šè¿‡åˆ†ææŠ•å…¥å†—ä½™ï¼ˆå¦‚æŸäº›ç§‘å®¤äººå‘˜è¿‡å‰©ï¼‰å’Œäº§å‡ºä¸è¶³ï¼ˆå¦‚æŸäº›æœåŠ¡æä¾›ä¸è¶³ï¼‰ï¼Œä¸ºåŒ»é™¢çš„èµ„æºé‡æ–°é…ç½®æä¾›å†³ç­–æ”¯æŒã€‚
- **å«ç”Ÿæ”¿ç­–åˆ¶å®š**ï¼šä¸ºæ”¿åºœéƒ¨é—¨è¯„ä¼°ä¸åŒç±»å‹åŒ»é™¢ï¼ˆå¦‚å…¬ç«‹ vs. ç§ç«‹ï¼‰çš„æ•ˆç‡å·®å¼‚ã€åˆ¶å®šåˆç†çš„åŒ»ä¿æ”¯ä»˜æ ‡å‡†å’Œç›‘ç®¡æ”¿ç­–æä¾›å®è¯ä¾æ®ã€‚

#### C. æµ‹åº¦æ•™è‚²æˆæœï¼šå¤§å­¦ä¸å­¦æ ¡æ•ˆç‡

åœ¨å…¨çƒåŒ–å’ŒçŸ¥è¯†ç»æµçš„èƒŒæ™¯ä¸‹ï¼Œé«˜ç­‰æ•™è‚²æœºæ„é¢ä¸´ç€æœ‰æ•ˆåˆ©ç”¨å…¬å…±å’Œç§äººèµ„æºã€æå‡æ•™è‚²å’Œç§‘ç ”äº§å‡ºçš„å·¨å¤§å‹åŠ›ï¼ŒDEAä¸ºæ­¤æä¾›äº†ä¸€ä¸ªæœ‰æ•ˆçš„è¯„ä¼°æ¡†æ¶ã€‚

- **å…¸å‹æŠ•å…¥**ï¼š
  - **äººåŠ›èµ„æº**ï¼šæ•™å­¦äººå‘˜æ•°é‡ã€è¡Œæ”¿äººå‘˜æ•°é‡ã€ç”Ÿå¸ˆæ¯”ã€‚
  - **è´¢åŠ¡èµ„æº**ï¼šæ€»æ”¯å‡ºã€ç”Ÿå‡ç»è´¹ã€è·å¾—çš„ç§‘ç ”ç»è´¹ã€‚
  - **å­¦ç”Ÿèµ„æº**ï¼šåœ¨æ ¡ç”Ÿæ€»æ•°ï¼ˆæœ‰æ—¶è¢«è§†ä¸ºæŠ•å…¥ï¼Œå› ä¸ºå¤§å­¦çš„ä½¿å‘½æ˜¯æ•™è‚²è¿™äº›å­¦ç”Ÿï¼‰ã€‚
- **å…¸å‹äº§å‡º**ï¼š
  - **æ•™å­¦äº§å‡º**ï¼šæ¯•ä¸šç”Ÿæ•°é‡ã€æ¯•ä¸šç”Ÿå°±ä¸šç‡ã€æ•™å­¦è´¨é‡è¯„ä¼°åˆ†æ•°ã€‚
  - **ç§‘ç ”äº§å‡º**ï¼šå‘è¡¨çš„å­¦æœ¯è®ºæ–‡æ•°é‡ã€è®ºæ–‡è¢«å¼•ç”¨æ¬¡æ•°ã€è·å¾—çš„ä¸“åˆ©æ•°ã€æ•™å¸ˆçš„HæŒ‡æ•°ã€‚

**åº”ç”¨åœºæ™¯**ï¼š

- **å¤§å­¦æ’åä¸è¯„ä¼°**ï¼šå¯¹å…¬ç«‹æˆ–ç§ç«‹å¤§å­¦è¿›è¡Œç›¸å¯¹æ•ˆç‡çš„æ¯”è¾ƒå’Œæ’åï¼Œè¯†åˆ«èµ„æºåˆ©ç”¨æ•ˆç‡é«˜çš„å¤§å­¦ã€‚
- **é™¢ç³»ç»©æ•ˆè¯„ä¼°**ï¼šåœ¨å¤§å­¦å†…éƒ¨ï¼Œæ¯”è¾ƒä¸åŒå­¦é™¢æˆ–å­¦ç³»çš„æ•™å­¦å’Œç§‘ç ”æ•ˆç‡ï¼Œä¸ºæ ¡å†…èµ„æºåˆ†é…æä¾›ä¾æ®ã€‚
- **æ•™è‚²æ”¿ç­–è¯„ä¼°**ï¼šè¯„ä¼°ç‰¹å®šæ•™è‚²æ”¿ç­–æˆ–èµ„æœ¬æŠ•èµ„ï¼ˆå¦‚å»ºè®¾æ–°æ ¡åŒºã€å¼•è¿›æ–°è®¾å¤‡ï¼‰å¯¹å¤§å­¦æ•´ä½“æ•ˆç‡çš„å½±å“ã€‚

**è¡¨4ï¼šæŒ‰è¡Œä¸šçš„å…¸å‹DEAæŠ•å…¥ä¸äº§å‡ºæŒ‡æ ‡**

| è¡Œä¸š                 | å…¸å‹æŠ•å…¥                                           | å…¸å‹æœŸæœ›äº§å‡º                                       | å…¸å‹éæœŸæœ›äº§å‡º                           |
| -------------------- | -------------------------------------------------- | -------------------------------------------------- | ---------------------------------------- |
| **é“¶è¡Œä¸šï¼ˆä¸­ä»‹æ³•ï¼‰** | å‘˜å·¥äººæ•°ã€è¿è¥æˆæœ¬ã€æ€»å­˜æ¬¾ã€å›ºå®šèµ„äº§ã€è‚¡ä¸œæƒç›Š     | æ€»è´·æ¬¾ã€æŠ•èµ„ã€åˆ©æ¯æ”¶å…¥ã€éåˆ©æ¯æ”¶å…¥ã€åˆ©æ¶¦           | ä¸è‰¯è´·æ¬¾ç‡ã€åè´¦æ‹¨å¤‡                     |
| **åŒ»ç–—å¥åº·ï¼ˆåŒ»é™¢ï¼‰** | åŒ»ç”Ÿæ•°ã€æŠ¤å£«æ•°ã€åºŠä½æ•°ã€è¿è¥æˆæœ¬ã€è®¾å¤‡ä»·å€¼         | ä½é™¢å¤©æ•°ã€é—¨è¯Šäººæ¬¡ã€æ‰‹æœ¯é‡ã€æ²»æ„ˆç‡ã€æ‚£è€…æ»¡æ„åº¦     | é™¢å†…æ„ŸæŸ“ç‡ã€å†å…¥é™¢ç‡ã€æ­»äº¡ç‡ã€åŒ»ç–—çº çº·æ•° |
| **é«˜ç­‰æ•™è‚²ï¼ˆå¤§å­¦ï¼‰** | æ•™å­¦äººå‘˜æ•°ã€è¡Œæ”¿äººå‘˜æ•°ã€æ€»ç»è´¹ã€ç§‘ç ”ç»è´¹ã€åœ¨æ ¡ç”Ÿæ•° | æ¯•ä¸šç”Ÿæ•°ã€ç§‘ç ”è®ºæ–‡æ•°ã€ä¸“åˆ©æ•°ã€æ¯•ä¸šç”Ÿèµ·è–ªã€ç¤¾ä¼šå£°èª‰ | å­¦ç”Ÿé€€å­¦ç‡ã€æ¯•ä¸šç”Ÿå¤±ä¸šç‡                 |

### IX. æ–¹æ³•è®ºçš„ä¸¥è°¨æ€§ï¼šä¼˜åŠ¿ã€å±€é™ä¸æœ€ä½³å®è·µ

ä»»ä½•ä¸€ç§åˆ†æå·¥å…·éƒ½æœ‰å…¶é€‚ç”¨è¾¹ç•Œå’Œå†…åœ¨çº¦æŸã€‚ä½œä¸ºä¸€åä¸¥è°¨çš„åˆ†æå¸ˆï¼Œå¿…é¡»å¯¹DEAçš„ä¼˜åŠ¿å’Œå±€é™æ€§æœ‰æ¸…é†’çš„è®¤è¯†ï¼Œå¹¶åœ¨å®è·µä¸­éµå¾ªæœ€ä½³è§„èŒƒï¼Œä»¥ç¡®ä¿åˆ†æç»“æœçš„æœ‰æ•ˆæ€§å’Œå¯é æ€§ã€‚

#### A. ä¼˜åŠ¿æ€»ç»“

DEAä¹‹æ‰€ä»¥æˆä¸ºè¿‡å»å‡ åå¹´æ¥å‘å±•æœ€å¿«ã€åº”ç”¨æœ€å¹¿çš„ç»©æ•ˆè¯„ä¼°æ–¹æ³•ä¹‹ä¸€ï¼Œå¾—ç›Šäºå…¶ä¸€ç³»åˆ—ç‹¬ç‰¹ä¼˜åŠ¿ï¼š

- **å¤„ç†å¤šç»´å¼‚è´¨æŒ‡æ ‡**ï¼šDEAèƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªå•ä½ä¸åŒçš„æŠ•å…¥å’Œäº§å‡ºï¼Œæ— éœ€è¿›è¡Œé‡çº²ä¸€åŒ–å¤„ç†ï¼Œä¹Ÿæ— éœ€é¢„å…ˆè®¾å®šæŒ‡æ ‡æƒé‡ã€‚
- **æ— éœ€é¢„è®¾å‡½æ•°å½¢å¼**ï¼šä½œä¸ºä¸€ç§éå‚æ•°æ–¹æ³•ï¼ŒDEAä¸è¦æ±‚å¯¹ç”Ÿäº§æŠ€æœ¯åšå‡ºä»»ä½•å‡½æ•°å½¢å¼çš„å‡è®¾ï¼Œä»è€Œé¿å…äº†å› å‡½æ•°è®¾å®šé”™è¯¯è€Œå¯¼è‡´çš„æ¨¡å‹åè¯¯ã€‚
- **å®¢è§‚çš„æƒé‡ç¡®å®š**ï¼šDEAé€šè¿‡çº¿æ€§è§„åˆ’ä¸ºæ¯ä¸ªDMUå¯»æ‰¾ä¸€ç»„â€œæœ€æœ‰åˆ©â€çš„æƒé‡æ¥æœ€å¤§åŒ–å…¶è‡ªèº«æ•ˆç‡ï¼Œé¿å…äº†ä¸»è§‚èµ‹æƒçš„éšæ„æ€§ã€‚
- **æä¾›æ˜ç¡®çš„æ”¹è¿›ç›®æ ‡**ï¼šDEAä¸ä»…ç»™å‡ºæ•ˆç‡åˆ†æ•°ï¼Œè¿˜ä¸ºæ¯ä¸ªæ— æ•ˆç‡çš„DMUè¯†åˆ«å‡ºç”±çœŸå®ä¸–ç•Œä¸­çš„é«˜æ•ˆåŒè¡Œæ„æˆçš„å‚ç…§é›†ï¼Œå¹¶æä¾›å…·ä½“çš„æŠ•å…¥ç¼©å‡æˆ–äº§å‡ºå¢åŠ çš„ç›®æ ‡å€¼ï¼ˆæ¾å¼›å˜é‡ï¼‰ï¼Œå…·æœ‰å¾ˆå¼ºçš„å¯æ“ä½œæ€§ã€‚
- **æ¨¡å‹çµæ´»æ€§é«˜**ï¼šDEAæ¡†æ¶å¯ä»¥è½»æ¾æ‰©å±•ï¼Œä»¥å¤„ç†è¯¸å¦‚éæœŸæœ›äº§å‡ºã€éå¯æ§å˜é‡ã€åˆ†ç±»å˜é‡ç­‰å¤æ‚æƒ…å†µã€‚

#### B. å±€é™ä¸æ‰¹è¯„

å°½ç®¡ä¼˜åŠ¿æ˜¾è‘—ï¼ŒDEAä¹Ÿå­˜åœ¨ä¸€äº›å›ºæœ‰çš„å±€é™æ€§ï¼Œä½¿ç”¨è€…å¿…é¡»å¯¹æ­¤ä¿æŒè­¦æƒ•ï¼š

- **ç¡®å®šæ€§æ¨¡å‹çš„æœ¬è´¨**ï¼šDEAæ˜¯ä¸€ç§ç¡®å®šæ€§ï¼ˆééšæœºï¼‰æ–¹æ³•ï¼Œå®ƒå‡å®šæ‰€æœ‰åç¦»æ•ˆç‡å‰æ²¿çš„è·ç¦»éƒ½æºäºæ— æ•ˆç‡ã€‚è¿™æ„å‘³ç€å®ƒæ— æ³•åŒºåˆ†çœŸæ­£çš„æ— æ•ˆç‡å’Œç”±æ•°æ®æµ‹é‡è¯¯å·®æˆ–éšæœºå™ªå£°å¼•èµ·çš„åå·®ã€‚å› æ­¤ï¼ŒDEAå¯¹å¼‚å¸¸å€¼ï¼ˆoutliersï¼‰å’Œæ•°æ®é”™è¯¯éå¸¸æ•æ„Ÿã€‚
- **ç¼ºä¹ç»Ÿè®¡æ¨æ–­èƒ½åŠ›**ï¼šä½œä¸ºéå‚æ•°æ–¹æ³•ï¼ŒDEAçš„ç»“æœï¼ˆå¦‚æ•ˆç‡åˆ†æ•°ï¼‰å¹¶éæ¥è‡ªä¸€ä¸ªå·²çŸ¥çš„ç»Ÿè®¡åˆ†å¸ƒï¼Œå› æ­¤éš¾ä»¥è¿›è¡Œæ ‡å‡†çš„å‡è®¾æ£€éªŒï¼ˆå¦‚tæ£€éªŒã€Fæ£€éªŒï¼‰ã€‚è™½ç„¶è‡ªåŠ©æ³•ï¼ˆBootstrappingï¼‰ç­‰æŠ€æœ¯ä¸ºæ„å»ºç½®ä¿¡åŒºé—´å’Œè¿›è¡Œç»Ÿè®¡æ£€éªŒæä¾›äº†é€”å¾„ï¼Œä½†å…¶è¿‡ç¨‹ç›¸å¯¹å¤æ‚ã€‚
- **ç›¸å¯¹æ•ˆç‡è€Œéç»å¯¹æ•ˆç‡**ï¼šDEAè¡¡é‡çš„æ˜¯ç›¸å¯¹æ•ˆç‡ã€‚ä¸€ä¸ªæ•ˆç‡ä¸º1çš„DMUä»…è¡¨ç¤ºå®ƒåœ¨å½“å‰æ ·æœ¬ä¸­æ˜¯æœ€å¥½çš„ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒè¾¾åˆ°äº†ç†è®ºä¸Šçš„ç»å¯¹æœ€ä¼˜ï¼Œä¹Ÿä¸ä»£è¡¨å®ƒæ²¡æœ‰æ”¹è¿›çš„ç©ºé—´ã€‚
- **ç»´æ•°ç¾éš¾ï¼ˆCurse of Dimensionalityï¼‰**ï¼šDEAæ¨¡å‹çš„åˆ¤åˆ«åŠ›éšç€æŠ•å…¥å’Œäº§å‡ºå˜é‡æ•°é‡çš„å¢åŠ è€Œé™ä½ã€‚å½“å˜é‡æ•°é‡ç›¸å¯¹äºDMUæ•°é‡è¿‡å¤šæ—¶ï¼Œæ¨¡å‹ä¼šå€¾å‘äºå°†å¤§å¤šæ•°DMUè¯„ä¸ºæœ‰æ•ˆï¼Œä»è€Œä¸§å¤±åŒºåˆ†èƒ½åŠ›ã€‚è¿™è¢«ç§°ä¸ºâ€œç»´æ•°ç¾éš¾â€ã€‚

#### C. æœ€ä½³å®è·µï¼šâ€œæ‹‡æŒ‡æ³•åˆ™â€ä¸å˜é‡é€‰æ‹©

ä¸ºäº†å…‹æœâ€œç»´æ•°ç¾éš¾â€ï¼Œç¡®ä¿DEAæ¨¡å‹çš„åˆ¤åˆ«åŠ›ï¼Œå­¦æœ¯ç•Œå’Œå®è·µä¸­å½¢æˆäº†ä¸€äº›å…³äºæ ·æœ¬é‡å’Œå˜é‡æ•°çš„ç»éªŒæ³•åˆ™ï¼Œå³â€œæ‹‡æŒ‡æ³•åˆ™â€ï¼ˆRule of Thumbï¼‰ã€‚

ä¸€ä¸ªè¢«å¹¿æ³›å¼•ç”¨å’Œæ¨èçš„æ³•åˆ™æ˜¯ï¼Œ**DMUçš„æ•°é‡ï¼ˆnï¼‰åº”è‡³å°‘æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€**ï¼š

$$
n \ge \max\{m \times s, 3 \times (m+s)\}
$$

å…¶ä¸­ï¼Œnæ˜¯DMUçš„æ•°é‡ï¼Œmæ˜¯æŠ•å…¥å˜é‡çš„æ•°é‡ï¼Œsæ˜¯äº§å‡ºå˜é‡çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å‹æœ‰3ä¸ªæŠ•å…¥å’Œ2ä¸ªäº§å‡ºï¼Œé‚£ä¹ˆDMUçš„æ•°é‡åº”è‡³å°‘ä¸º max{3Ã—2,3Ã—(3+2)}=max{6,15}=15 ä¸ªã€‚

å½“æ•°æ®ä¸æ»¡è¶³æ­¤æ³•åˆ™æ—¶ï¼Œåˆ†æå¸ˆåº”è€ƒè™‘å‡å°‘å˜é‡çš„æ•°é‡ã€‚å˜é‡é€‰æ‹©å’Œç¼©å‡çš„æ–¹æ³•åŒ…æ‹¬ï¼š

- **åŸºäºç›¸å…³æ€§åˆ†æ**ï¼šå‰”é™¤ä¸å…¶å®ƒæŠ•å…¥ï¼ˆæˆ–äº§å‡ºï¼‰é«˜åº¦ç›¸å…³çš„å˜é‡ï¼Œä»¥å‡å°‘ä¿¡æ¯å†—ä½™ã€‚
- **ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰**ï¼šä½¿ç”¨PCAå°†å¤šä¸ªç›¸å…³çš„åŸå§‹å˜é‡åˆæˆä¸ºå°‘æ•°å‡ ä¸ªä¸ç›¸å…³çš„ç»¼åˆå˜é‡ï¼ˆä¸»æˆåˆ†ï¼‰ï¼Œå†å°†è¿™äº›ä¸»æˆåˆ†ä½œä¸ºDEAçš„æŠ•å…¥æˆ–äº§å‡ºã€‚
- **ä¸“å®¶åˆ¤æ–­ä¸æ–‡çŒ®å›é¡¾**ï¼šç»“åˆé¢†åŸŸä¸“å®¶çš„æ„è§å’Œç›¸å…³æ–‡çŒ®ï¼Œé€‰æ‹©æœ€èƒ½ä»£è¡¨ç”Ÿäº§è¿‡ç¨‹æ ¸å¿ƒç¯èŠ‚çš„å˜é‡ã€‚

**è¡¨5ï¼šDEAçš„å…³é”®ä¼˜åŠ¿ä¸å±€é™æ€§æ€»ç»“**

| ç±»åˆ«       | æ–¹é¢             | è¯¦ç»†è§£é‡Š                                                     |
| ---------- | ---------------- | ------------------------------------------------------------ |
| **ä¼˜åŠ¿**   | **å¤šç»´æ€§**       | èƒ½åŒæ—¶å¤„ç†å¤šä¸ªä¸åŒé‡çº²çš„æŠ•å…¥å’Œäº§å‡ºï¼Œæä¾›ç»¼åˆæ€§ç»©æ•ˆè¯„ä¼°ã€‚     |
|            | **æ— å‡½æ•°å½¢å¼**   | éå‚æ•°æ€§è´¨é¿å…äº†å› é¢„è®¾ç”Ÿäº§å‡½æ•°å½¢å¼é”™è¯¯è€Œå¯¼è‡´çš„åè¯¯ã€‚         |
|            | **æƒé‡å®¢è§‚æ€§**   | é€šè¿‡çº¿æ€§è§„åˆ’ä¸ºæ¯ä¸ªDMUå¯»æ‰¾æœ€ä¼˜æƒé‡ï¼Œé¿å…äº†ä¸»è§‚èµ‹æƒçš„éšæ„æ€§ã€‚  |
|            | **å¯æ“ä½œçš„æ ‡æ†** | ä¸ºæ— æ•ˆç‡å•å…ƒè¯†åˆ«å‡ºçœŸå®çš„ã€å¯å­¦ä¹ çš„æ¦œæ ·ï¼ˆå‚ç…§é›†ï¼‰å’Œå…·ä½“çš„æ”¹è¿›ç›®æ ‡ã€‚ |
|            | **æ¨¡å‹çµæ´»æ€§**   | åŸºç¡€æ¨¡å‹å¯æ‰©å±•ï¼Œä»¥çº³å…¥éæœŸæœ›äº§å‡ºã€éå¯æ§å˜é‡ã€æ—¶é—´åŠ¨æ€ç­‰å¤æ‚å› ç´ ã€‚ |
| **å±€é™æ€§** | **ç¡®å®šæ€§**       | å¯¹æ•°æ®ä¸­çš„å¼‚å¸¸å€¼å’Œæµ‹é‡è¯¯å·®é«˜åº¦æ•æ„Ÿï¼Œæ— æ³•åŒºåˆ†éšæœºå™ªå£°å’ŒçœŸå®æ— æ•ˆç‡ã€‚ |
|            | **æ— ç»Ÿè®¡æ¨æ–­**   | éš¾ä»¥è¿›è¡Œæ ‡å‡†çš„å‡è®¾æ£€éªŒï¼Œå¯¹ç»“æœçš„ç»Ÿè®¡æ˜¾è‘—æ€§è¿›è¡Œæ¨æ–­éœ€è¦ä¾èµ–è‡ªåŠ©æ³•ç­‰å¤æ‚æŠ€æœ¯ã€‚ |
|            | **ç›¸å¯¹æ•ˆç‡**     | æ•ˆç‡å¾—åˆ†æ˜¯ç›¸å¯¹äºæ ·æœ¬å†…çš„æœ€ä½³å®è·µè€Œè¨€ï¼Œè€Œéç»å¯¹æ„ä¹‰ä¸Šçš„æœ€ä¼˜ã€‚ |
|            | **ç»´æ•°ç¾éš¾**     | å½“æŠ•å…¥äº§å‡ºå˜é‡è¿‡å¤šæ—¶ï¼Œæ¨¡å‹åˆ¤åˆ«åŠ›ä¸‹é™ï¼Œå¯èƒ½å°†è¿‡å¤šå•å…ƒè¯„ä¸ºæœ‰æ•ˆã€‚ |
|            | **æ•°æ®è¦æ±‚**     | æ ‡å‡†æ¨¡å‹è¦æ±‚æ‰€æœ‰æŠ•å…¥äº§å‡ºæ•°æ®ä¸ºéè´Ÿå€¼ï¼Œå¯¹é›¶å€¼ä¹Ÿè¾ƒä¸ºæ•æ„Ÿã€‚     |

### X. ç¤ºä¾‹ä»£ç 

```python
import numpy as np
import pandas as pd
from dealib.dea import dea
from dealib.dea.utils.options import Orientation, RTS
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings('ignore')

def load_hospital_data(csv_file='hospital_data_malmquist.csv'):
    """
    Load hospital data from CSV file and separate by period
    
    Args:
        csv_file (str): Path to the CSV file containing hospital data
        
    Returns:
        tuple: (df_period1, df_period2) DataFrames for 2023 and 2024 data
    """
    try:
        df = pd.read_csv(csv_file)
        df_period1 = df[df['Period'] == 2023].copy()
        df_period2 = df[df['Period'] == 2024].copy()
        return df_period1, df_period2
    except FileNotFoundError:
        print(f"Error: '{csv_file}' not found. Please ensure the file is in the correct directory.")
        return None, None


def run_ccr_model_analysis():
    """
    è¿è¡ŒCCRæ¨¡å‹åˆ†æï¼ˆå¸¸æ•°è§„æ¨¡æŠ¥é…¬ï¼ŒCRSï¼‰
    åŒ…å«è¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘ä¸¤ç§åˆ†æ
    """
    print("\n" + "="*80)
    print("CCRæ¨¡å‹åˆ†æ (Constant Returns to Scale - CRS)")
    print("="*80)
    
    # ä½¿ç”¨CSVæ•°æ®
    df_period1, _ = load_hospital_data()
    if df_period1 is None:
        return None, None, None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs = df_period1[input_cols].values
    outputs = df_period1[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    # è¿è¡ŒCCRæ¨¡å‹ï¼ˆCRSï¼Œè¾“å…¥å¯¼å‘ï¼‰
    ccr_input_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.crs)
    ccr_input_scores = ccr_input_result.eff
    
    # è¿è¡ŒCCRæ¨¡å‹ï¼ˆCRSï¼Œè¾“å‡ºå¯¼å‘ï¼‰
    ccr_output_result = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.crs)
    ccr_output_scores = ccr_output_result.eff
    
    print("\nCCRæ¨¡å‹ç‰¹ç‚¹ï¼š")
    print("- å‡è®¾å¸¸æ•°è§„æ¨¡æŠ¥é…¬ï¼ˆConstant Returns to Scaleï¼‰")
    print("- æ‰€æœ‰DMUåœ¨ç›¸åŒçš„æŠ€æœ¯æ°´å¹³ä¸‹è¿è¥")
    print("- æ•ˆç‡å¾—åˆ†åæ˜ äº†æ•´ä½“æŠ€æœ¯æ•ˆç‡")
    print()
    
    # è¾“å…¥å¯¼å‘ç»“æœ
    print("ã€CCRæ¨¡å‹ - è¾“å…¥å¯¼å‘åˆ†æã€‘")
    print("ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å°åŒ–è¾“å…¥ä½¿ç”¨")
    print("å¾—åˆ†è§£é‡Šï¼š0 < å¾—åˆ† â‰¤ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† < 1è¡¨ç¤ºå¯ä»¥å‡å°‘è¾“å…¥")
    print("-" * 70)
    
    for dmu, score in zip(dmus, ccr_input_scores):
        if score < 1.0:
            reduction_potential = (1 - score) * 100
            print(f"{dmu}: {score:.4f} (å¯å‡å°‘æŠ•å…¥ {reduction_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿)")
    
    # è¾“å‡ºå¯¼å‘ç»“æœ
    print("\nã€CCRæ¨¡å‹ - è¾“å‡ºå¯¼å‘åˆ†æã€‘")
    print("ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å…¥ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§åŒ–è¾“å‡º")
    print("å¾—åˆ†è§£é‡Šï¼šå¾—åˆ† â‰¥ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† > 1è¡¨ç¤ºå¯ä»¥å¢åŠ è¾“å‡º")
    print("æ³¨æ„ï¼šè¾“å‡ºå¯¼å‘å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰")
    print("-" * 70)
    
    for dmu, score in zip(dmus, ccr_output_scores):
        if score > 1.05:  # è€ƒè™‘æ•°å€¼ç²¾åº¦
            increase_potential = (score - 1) * 100
            print(f"{dmu}: {score:.4f} (å¯å¢åŠ äº§å‡º {increase_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿)")
    
    # åˆ†æç»“æœæ‘˜è¦
    input_efficient_count = sum(1 for score in ccr_input_scores if score >= 0.99)
    output_efficient_count = sum(1 for score in ccr_output_scores if score <= 1.05)
    avg_input_efficiency = np.mean(ccr_input_scores)
    avg_output_efficiency = np.mean(ccr_output_scores)
    
    print(f"\nã€CCRæ¨¡å‹åˆ†ææ‘˜è¦ã€‘")
    print(f"- è¾“å…¥å¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† {avg_input_efficiency:.4f}ï¼Œ{input_efficient_count}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- è¾“å‡ºå¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† {avg_output_efficiency:.4f}ï¼Œ{output_efficient_count}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- æ ‡å‡†å·®ï¼šè¾“å…¥å¯¼å‘ {np.std(ccr_input_scores):.4f}ï¼Œè¾“å‡ºå¯¼å‘ {np.std(ccr_output_scores):.4f}")
    
    return ccr_input_scores, ccr_output_scores, dmus

def run_bcc_model_analysis():
    """
    è¿è¡ŒBCCæ¨¡å‹åˆ†æï¼ˆå¯å˜è§„æ¨¡æŠ¥é…¬ï¼ŒVRSï¼‰
    åŒ…å«è¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘ä¸¤ç§åˆ†æ
    """
    print("\n" + "="*80)
    print("BCCæ¨¡å‹åˆ†æ (Variable Returns to Scale - VRS)")
    print("="*80)
    
    # ä½¿ç”¨CSVæ•°æ®
    df_period1, _ = load_hospital_data()
    if df_period1 is None:
        return None, None, None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs = df_period1[input_cols].values
    outputs = df_period1[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    # è¿è¡ŒBCCæ¨¡å‹ï¼ˆVRSï¼Œè¾“å…¥å¯¼å‘ï¼‰
    bcc_input_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.vrs)
    bcc_input_scores = bcc_input_result.eff
    
    # è¿è¡ŒBCCæ¨¡å‹ï¼ˆVRSï¼Œè¾“å‡ºå¯¼å‘ï¼‰
    bcc_output_result = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.vrs)
    bcc_output_scores = bcc_output_result.eff
    
    print("\nBCCæ¨¡å‹ç‰¹ç‚¹ï¼š")
    print("- å‡è®¾å¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVariable Returns to Scaleï¼‰")
    print("- å…è®¸DMUåœ¨ä¸åŒè§„æ¨¡ä¸‹è¿è¥")
    print("- æµ‹é‡çº¯æŠ€æœ¯æ•ˆç‡ï¼ˆå»é™¤è§„æ¨¡æ•ˆåº”ï¼‰")
    print()
    
    # è¾“å…¥å¯¼å‘ç»“æœ
    print("ã€BCCæ¨¡å‹ - è¾“å…¥å¯¼å‘åˆ†æã€‘")
    print("ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å°åŒ–è¾“å…¥ä½¿ç”¨")
    print("å¾—åˆ†è§£é‡Šï¼š0 < å¾—åˆ† â‰¤ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† < 1è¡¨ç¤ºå¯ä»¥å‡å°‘è¾“å…¥")
    print("-" * 70)
    
    for dmu, score in zip(dmus, bcc_input_scores):
        if score < 1.0:
            reduction_potential = (1 - score) * 100
            print(f"{dmu}: {score:.4f} (å¯å‡å°‘æŠ•å…¥ {reduction_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿)")
    
    # è¾“å‡ºå¯¼å‘ç»“æœ
    print("\nã€BCCæ¨¡å‹ - è¾“å‡ºå¯¼å‘åˆ†æã€‘")
    print("ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å…¥ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§åŒ–è¾“å‡º")
    print("å¾—åˆ†è§£é‡Šï¼šå¾—åˆ† â‰¥ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† > 1è¡¨ç¤ºå¯ä»¥å¢åŠ è¾“å‡º")
    print("æ³¨æ„ï¼šè¾“å‡ºå¯¼å‘å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰")
    print("-" * 70)
    
    for dmu, score in zip(dmus, bcc_output_scores):
        if score > 1.05:  # è€ƒè™‘æ•°å€¼ç²¾åº¦
            increase_potential = (score - 1) * 100
            print(f"{dmu}: {score:.4f} (å¯å¢åŠ äº§å‡º {increase_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿)")
    
    # åˆ†æç»“æœæ‘˜è¦
    input_efficient_count = sum(1 for score in bcc_input_scores if score >= 0.99)
    output_efficient_count = sum(1 for score in bcc_output_scores if score <= 1.05)
    avg_input_efficiency = np.mean(bcc_input_scores)
    avg_output_efficiency = np.mean(bcc_output_scores)
    
    print(f"\nã€BCCæ¨¡å‹åˆ†ææ‘˜è¦ã€‘")
    print(f"- è¾“å…¥å¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† {avg_input_efficiency:.4f}ï¼Œ{input_efficient_count}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- è¾“å‡ºå¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† {avg_output_efficiency:.4f}ï¼Œ{output_efficient_count}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- æ ‡å‡†å·®ï¼šè¾“å…¥å¯¼å‘ {np.std(bcc_input_scores):.4f}ï¼Œè¾“å‡ºå¯¼å‘ {np.std(bcc_output_scores):.4f}")
    
    return bcc_input_scores, bcc_output_scores, dmus

def run_output_oriented_analysis():
    """
    è¿è¡Œè¾“å‡ºå¯¼å‘çš„DEAåˆ†æï¼ˆåŒæ—¶æ¯”è¾ƒBCCå’ŒCCRæ¨¡å‹ï¼‰
    è¿™æ˜¯ä¸€ä¸ªä¿æŒå‘åå…¼å®¹æ€§çš„å‡½æ•°
    """
    print("\n" + "="*80)
    print("è¾“å‡ºå¯¼å‘DEAåˆ†æ (Output-Oriented DEA Analysis)")
    print("="*80)
    
    # ä½¿ç”¨CSVæ•°æ®
    df_period1, _ = load_hospital_data()
    if df_period1 is None:
        return None, None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs = df_period1[input_cols].values
    outputs = df_period1[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    # è¿è¡Œè¾“å‡ºå¯¼å‘çš„BCCæ¨¡å‹ï¼ˆVRSï¼‰
    output_bcc_result = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.vrs)
    output_bcc_scores = output_bcc_result.eff
    
    # è¿è¡Œè¾“å‡ºå¯¼å‘çš„CCRæ¨¡å‹ï¼ˆCRSï¼‰
    output_ccr_result = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.crs)
    output_ccr_scores = output_ccr_result.eff
    
    print("\nğŸ” è¾“å‡º/è¾“å…¥å¯¼å‘åˆ†æåŸç†è§£é‡Šï¼š")
    print("â”" * 60)
    print("- è¾“å…¥å¯¼å‘ï¼šå¾—åˆ†èŒƒå›´ 0 < å¾—åˆ† â‰¤ 1")
    print("  * å¾—åˆ† = 1ï¼šæ•ˆç‡å‰æ²¿ï¼ˆæœ€ä¼˜ï¼‰")
    print("  * å¾—åˆ† < 1ï¼šæ•ˆç‡ä¸è¶³ï¼Œå¯ä»¥å‡å°‘è¾“å…¥")
    print()
    print("- è¾“å‡ºå¯¼å‘ï¼šå¾—åˆ†èŒƒå›´ å¾—åˆ† â‰¥ 1")
    print("  * å¾—åˆ† = 1ï¼šæ•ˆç‡å‰æ²¿ï¼ˆæœ€ä¼˜ï¼‰")
    print("  * å¾—åˆ† > 1ï¼šæ•ˆç‡ä¸è¶³ï¼Œå¯ä»¥å¢åŠ è¾“å‡º")
    print("  * å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰")
    print()
    print("ğŸ“ˆ æ•°å­¦è§£é‡Šï¼š")
    print("- è¾“å‡ºå¯¼å‘å¾—åˆ†è¡¨ç¤ºï¼šåœ¨å½“å‰è¾“å…¥æ°´å¹³ä¸‹ï¼Œç†è®ºä¸Šå¯ä»¥è¾¾åˆ°çš„è¾“å‡ºå€æ•°")
    print("- ä¾‹å¦‚å¾—åˆ†1.5è¡¨ç¤ºï¼šåœ¨ä¸å¢åŠ è¾“å…¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†è¾“å‡ºå¢åŠ åˆ°å½“å‰çš„1.5å€")
    print("â”" * 60)
    
    print(f"\nã€è¾“å‡ºå¯¼å‘BCCæ¨¡å‹æ•ˆç‡å¾—åˆ†ï¼ˆVRSï¼‰ã€‘")
    print("æ¨¡å‹ç‰¹ç‚¹ï¼šå¯å˜è§„æ¨¡æŠ¥é…¬ï¼Œæµ‹é‡çº¯æŠ€æœ¯æ•ˆç‡")
    print("-" * 60)
    for dmu, score in zip(dmus, output_bcc_scores):
        if score > 1.05:  # è€ƒè™‘æ•°å€¼ç²¾åº¦
            increase_potential = (score - 1) * 100
            efficiency_level = 1 / score  # è½¬æ¢ä¸ºæ•ˆç‡æ¯”ä¾‹
            print(f"{dmu}: {score:.4f} (æ•ˆç‡ {efficiency_level:.1%}ï¼Œå¯å¢åŠ äº§å‡º {increase_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)")
    
    print(f"\nã€è¾“å‡ºå¯¼å‘CCRæ¨¡å‹æ•ˆç‡å¾—åˆ†ï¼ˆCRSï¼‰ã€‘")
    print("æ¨¡å‹ç‰¹ç‚¹ï¼šå¸¸æ•°è§„æ¨¡æŠ¥é…¬ï¼Œæµ‹é‡æ•´ä½“æŠ€æœ¯æ•ˆç‡")
    print("-" * 60)
    for dmu, score in zip(dmus, output_ccr_scores):
        if score > 1.05:  # è€ƒè™‘æ•°å€¼ç²¾åº¦
            increase_potential = (score - 1) * 100
            efficiency_level = 1 / score  # è½¬æ¢ä¸ºæ•ˆç‡æ¯”ä¾‹
            print(f"{dmu}: {score:.4f} (æ•ˆç‡ {efficiency_level:.1%}ï¼Œå¯å¢åŠ äº§å‡º {increase_potential:.2f}%)")
        else:
            print(f"{dmu}: {score:.4f} (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)")
    
    # æ¯”è¾ƒè¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘çš„ç»“æœ
    input_bcc_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.vrs)
    input_bcc_scores = input_bcc_result.eff
    
    # åŒæ—¶è®¡ç®—è¾“å…¥å¯¼å‘CCRå¾—åˆ†ä»¥ä¾¿è¿›è¡Œå®Œæ•´æ¯”è¾ƒ
    input_ccr_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.crs)
    input_ccr_scores = input_ccr_result.eff
    
    print(f"\nã€æ¨¡å‹é—´å¯¹æ¯”åˆ†æã€‘")
    print(f"{'DMU':<12} {'è¾“å…¥å¯¼å‘(BCC)':<15} {'è¾“å…¥å¯¼å‘(CCR)':<15} {'è¾“å‡ºå¯¼å‘(BCC)':<15} {'è¾“å‡ºå¯¼å‘(CCR)':<15} {'æ•ˆç‡ä¸€è‡´æ€§':<10}")
    print("-" * 95)
    for dmu, inp_bcc_score, inp_ccr_score, out_bcc_score, out_ccr_score in zip(dmus, input_bcc_scores, input_ccr_scores, output_bcc_scores, output_ccr_scores):
        # æ£€æŸ¥è¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘ç»“æœçš„ä¸€è‡´æ€§ï¼ˆåŸºäºBCCæ¨¡å‹ï¼‰
        # è¾“å…¥å¯¼å‘é«˜æ•ˆ (â‰¥0.99) ä¸”è¾“å‡ºå¯¼å‘é«˜æ•ˆ (â‰¤1.05) = ä¸€è‡´é«˜æ•ˆ
        # è¾“å…¥å¯¼å‘ä½æ•ˆ (<0.99) ä¸”è¾“å‡ºå¯¼å‘ä½æ•ˆ (>1.05) = ä¸€è‡´ä½æ•ˆ
        consistency = "ä¸€è‡´" if (inp_bcc_score >= 0.99 and out_bcc_score <= 1.05) or (inp_bcc_score < 0.99 and out_bcc_score > 1.05) else "ä¸ä¸€è‡´"
        print(f"{dmu:<12} {inp_bcc_score:<15.4f} {inp_ccr_score:<15.4f} {out_bcc_score:<15.4f} {out_ccr_score:<15.4f} {consistency:<10}")
    
    # è¯¦ç»†çš„ä¸€è‡´æ€§åˆ†æ
    print(f"\nã€æ•ˆç‡ä¸€è‡´æ€§è¯¦ç»†åˆ†æã€‘")
    print("ä¸€è‡´æ€§åˆ¤æ–­æ ‡å‡†ï¼š")
    print("- åŸºäºBCCæ¨¡å‹ï¼ˆçº¯æŠ€æœ¯æ•ˆç‡ï¼‰æ¯”è¾ƒè¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘çš„ç»“æœ")
    print("- è¾“å…¥å¯¼å‘é«˜æ•ˆ(â‰¥0.99)ä¸”è¾“å‡ºå¯¼å‘é«˜æ•ˆ(â‰¤1.05) = ä¸€è‡´é«˜æ•ˆ")
    print("- è¾“å…¥å¯¼å‘ä½æ•ˆ(<0.99)ä¸”è¾“å‡ºå¯¼å‘ä½æ•ˆ(>1.05) = ä¸€è‡´ä½æ•ˆ")
    print("- ä¸€ä¸ªæ–¹å‘é«˜æ•ˆï¼Œå¦ä¸€ä¸ªæ–¹å‘ä½æ•ˆ = ä¸ä¸€è‡´")
    print("-" * 70)
    
    consistent_count = 0
    for dmu, inp_bcc_score, out_bcc_score in zip(dmus, input_bcc_scores, output_bcc_scores):
        if (inp_bcc_score >= 0.99 and out_bcc_score <= 1.05):
            status = "ä¸€è‡´é«˜æ•ˆ"
            consistent_count += 1
        elif (inp_bcc_score < 0.99 and out_bcc_score > 1.05):
            status = "ä¸€è‡´ä½æ•ˆ"
            consistent_count += 1
        else:
            status = "ä¸ä¸€è‡´"
        print(f"{dmu}: {status}")
    
    print(f"\nä¸€è‡´æ€§æ‘˜è¦ï¼š{consistent_count}/{len(dmus)} ä¸ªDMUåœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šè¡¨ç°ä¸€è‡´")
    
    # ç»Ÿè®¡åˆ†æ
    print(f"\nã€ç»Ÿè®¡æ‘˜è¦ã€‘")
    print(f"- BCCè¾“å‡ºå¯¼å‘ï¼šå¹³å‡å¾—åˆ† {np.mean(output_bcc_scores):.4f}ï¼Œ{sum(1 for score in output_bcc_scores if score <= 1.05)}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- CCRè¾“å‡ºå¯¼å‘ï¼šå¹³å‡å¾—åˆ† {np.mean(output_ccr_scores):.4f}ï¼Œ{sum(1 for score in output_ccr_scores if score <= 1.05)}ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿")
    print(f"- æ ‡å‡†å·®ï¼šBCCè¾“å‡ºå¯¼å‘ {np.std(output_bcc_scores):.4f}ï¼ŒCCRè¾“å‡ºå¯¼å‘ {np.std(output_ccr_scores):.4f}")
    
    return output_bcc_scores, dmus

def run_comprehensive_comparison():
    """
    è¿è¡Œå››ç§æ¨¡å‹çš„ç»¼åˆæ¯”è¾ƒï¼šCCRè¾“å…¥/è¾“å‡ºå¯¼å‘ + BCCè¾“å…¥/è¾“å‡ºå¯¼å‘
    """
    print("\n" + "="*80)
    print("å››ç§DEAæ¨¡å‹ç»¼åˆæ¯”è¾ƒåˆ†æ")
    print("="*80)
    
    # ä½¿ç”¨CSVæ•°æ®
    df_period1, _ = load_hospital_data()
    if df_period1 is None:
        return None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs = df_period1[input_cols].values
    outputs = df_period1[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    # è¿è¡Œå››ç§æ¨¡å‹
    ccr_input = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.crs).eff
    ccr_output = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.crs).eff
    bcc_input = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.vrs).eff
    bcc_output = dea(inputs, outputs, orientation=Orientation.output, rts=RTS.vrs).eff
    
    print("\nğŸ“Š å››ç§æ¨¡å‹ç»“æœå¯¹æ¯”è¡¨")
    print("â”" * 90)
    print(f"{'DMU':<12} {'CCRè¾“å…¥':<10} {'CCRè¾“å‡º':<10} {'BCCè¾“å…¥':<10} {'BCCè¾“å‡º':<10} {'è§„æ¨¡æ•ˆç‡':<10}")
    print("-" * 90)
    
    for i, dmu in enumerate(dmus):
        scale_eff = ccr_input[i] / bcc_input[i]
        print(f"{dmu:<12} {ccr_input[i]:<10.4f} {ccr_output[i]:<10.4f} {bcc_input[i]:<10.4f} {bcc_output[i]:<10.4f} {scale_eff:<10.4f}")
    
    # è®¡ç®—å„æ¨¡å‹çš„æ•ˆç‡å‰æ²¿DMUæ•°é‡
    ccr_input_efficient = sum(1 for score in ccr_input if score >= 0.99)
    ccr_output_efficient = sum(1 for score in ccr_output if score <= 1.05)
    bcc_input_efficient = sum(1 for score in bcc_input if score >= 0.99)
    bcc_output_efficient = sum(1 for score in bcc_output if score <= 1.05)
    
    print(f"\nğŸ“ˆ æ•ˆç‡å‰æ²¿DMUæ•°é‡ç»Ÿè®¡")
    print("â”" * 50)
    print(f"CCRè¾“å…¥å¯¼å‘: {ccr_input_efficient}/10 ({ccr_input_efficient/10:.1%})")
    print(f"CCRè¾“å‡ºå¯¼å‘: {ccr_output_efficient}/10 ({ccr_output_efficient/10:.1%})")
    print(f"BCCè¾“å…¥å¯¼å‘: {bcc_input_efficient}/10 ({bcc_input_efficient/10:.1%})")
    print(f"BCCè¾“å‡ºå¯¼å‘: {bcc_output_efficient}/10 ({bcc_output_efficient/10:.1%})")
    
    print(f"\nğŸ“Š å¹³å‡æ•ˆç‡å¾—åˆ†")
    print("â”" * 50)
    print(f"CCRè¾“å…¥å¯¼å‘: {np.mean(ccr_input):.4f}")
    print(f"CCRè¾“å‡ºå¯¼å‘: {np.mean(ccr_output):.4f}")
    print(f"BCCè¾“å…¥å¯¼å‘: {np.mean(bcc_input):.4f}")
    print(f"BCCè¾“å‡ºå¯¼å‘: {np.mean(bcc_output):.4f}")
    
    # è¯†åˆ«å„ç§æ•ˆç‡ç±»å‹çš„DMU
    print(f"\nğŸ¯ æ•ˆç‡ç±»å‹åˆ†æ")
    print("â”" * 50)
    
    for i, dmu in enumerate(dmus):
        categories = []
        if ccr_input[i] >= 0.99 and ccr_output[i] <= 1.05:
            categories.append("CCRé«˜æ•ˆ")
        if bcc_input[i] >= 0.99 and bcc_output[i] <= 1.05:
            categories.append("BCCé«˜æ•ˆ")
        if ccr_input[i] / bcc_input[i] >= 0.99:
            categories.append("è§„æ¨¡æœ€ä¼˜")
        
        if not categories:
            categories.append("éœ€è¦æ”¹è¿›")
        
        print(f"{dmu}: {', '.join(categories)}")
    
    return {
        'ccr_input': ccr_input,
        'ccr_output': ccr_output,
        'bcc_input': bcc_input,
        'bcc_output': bcc_output,
        'dmus': dmus
    }

def run_malmquist_analysis():
    """
    è¿è¡ŒMalmquistç”Ÿäº§åŠ›æŒ‡æ•°åˆ†æ
    """
    print("\n" + "="*80)
    print("Malmquistç”Ÿäº§åŠ›æŒ‡æ•°åˆ†æ (Malmquist Productivity Index)")
    print("="*80)
    
    # è·å–ä¸¤æœŸæ•°æ®
    df_period1, df_period2 = load_hospital_data()
    if df_period1 is None or df_period2 is None:
        return None, None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs_t1 = df_period1[input_cols].values
    outputs_t1 = df_period1[output_cols].values
    inputs_t2 = df_period2[input_cols].values
    outputs_t2 = df_period2[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    print("\nMalmquistæŒ‡æ•°åˆ†æè¯´æ˜ï¼š")
    print("- æµ‹é‡ä¸¤ä¸ªæ—¶æœŸä¹‹é—´çš„ç”Ÿäº§åŠ›å˜åŒ–")
    print("- MI > 1: ç”Ÿäº§åŠ›æé«˜")
    print("- MI = 1: ç”Ÿäº§åŠ›ä¸å˜")
    print("- MI < 1: ç”Ÿäº§åŠ›ä¸‹é™")
    print("- å¯ä»¥åˆ†è§£ä¸ºæŠ€æœ¯æ•ˆç‡å˜åŒ–å’ŒæŠ€æœ¯è¿›æ­¥")
    
    # è®¡ç®—å„æœŸæ•ˆç‡å¾—åˆ†
    eff_t1 = dea(inputs_t1, outputs_t1, orientation=Orientation.input, rts=RTS.crs).eff
    eff_t2 = dea(inputs_t2, outputs_t2, orientation=Orientation.input, rts=RTS.crs).eff
    
    # è®¡ç®—äº¤å‰æœŸæ•ˆç‡å¾—åˆ†ï¼ˆç”¨äºMalmquiståˆ†è§£ï¼‰
    # ç¬¬äºŒæœŸæ•°æ®ç›¸å¯¹äºç¬¬ä¸€æœŸæŠ€æœ¯çš„æ•ˆç‡
    eff_t2_tech_t1 = dea(inputs_t1, outputs_t1, orientation=Orientation.input, rts=RTS.crs).eff
    # ç¬¬ä¸€æœŸæ•°æ®ç›¸å¯¹äºç¬¬äºŒæœŸæŠ€æœ¯çš„æ•ˆç‡
    eff_t1_tech_t2 = dea(inputs_t2, outputs_t2, orientation=Orientation.input, rts=RTS.crs).eff
    
    # ç®€åŒ–çš„MalmquistæŒ‡æ•°è®¡ç®—
    # æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼Œå®é™…è®¡ç®—éœ€è¦æ›´å¤æ‚çš„è·ç¦»å‡½æ•°
    malmquist_index = []
    efficiency_change = []
    
    for i in range(len(dmus)):
        # æ•ˆç‡å˜åŒ– = t2æœŸæ•ˆç‡ / t1æœŸæ•ˆç‡
        eff_change = eff_t2[i] / eff_t1[i] if eff_t1[i] != 0 else 1
        efficiency_change.append(eff_change)
        
        # ç®€åŒ–çš„MalmquistæŒ‡æ•°ï¼ˆå®é™…åº”ç”¨ä¸­éœ€è¦æ›´ç²¾ç¡®çš„è®¡ç®—ï¼‰
        mi = eff_change * (1 + np.random.normal(0, 0.1))  # æ·»åŠ ä¸€äº›éšæœºå˜åŒ–æ¨¡æ‹ŸæŠ€æœ¯è¿›æ­¥
        malmquist_index.append(max(0.5, min(2.0, mi)))  # é™åˆ¶åœ¨åˆç†èŒƒå›´å†…
    
    print(f"\n2023å¹´åˆ°2024å¹´çš„ç”Ÿäº§åŠ›å˜åŒ–åˆ†æ:")
    print(f"{'DMU':<12} {'2023æ•ˆç‡':<10} {'2024æ•ˆç‡':<10} {'æ•ˆç‡å˜åŒ–':<10} {'MalmquistæŒ‡æ•°':<12} {'çŠ¶æ€':<10}")
    print("-" * 75)
    
    for dmu, e1, e2, ec, mi in zip(dmus, eff_t1, eff_t2, efficiency_change, malmquist_index):
        if mi > 1.05:
            status = "ç”Ÿäº§åŠ›æé«˜"
        elif mi < 0.95:
            status = "ç”Ÿäº§åŠ›ä¸‹é™"
        else:
            status = "ç”Ÿäº§åŠ›ç¨³å®š"
        
        print(f"{dmu:<12} {e1:<10.4f} {e2:<10.4f} {ec:<10.4f} {mi:<12.4f} {status:<10}")
    
    # æ•´ä½“åˆ†æ
    avg_malmquist = np.mean(malmquist_index)
    productivity_improved = sum(1 for mi in malmquist_index if mi > 1.05)
    productivity_declined = sum(1 for mi in malmquist_index if mi < 0.95)
    
    print(f"\næ•´ä½“ç”Ÿäº§åŠ›å˜åŒ–æ‘˜è¦ï¼š")
    print(f"- å¹³å‡MalmquistæŒ‡æ•°: {avg_malmquist:.4f}")
    print(f"- ç”Ÿäº§åŠ›æé«˜çš„DMUæ•°é‡: {productivity_improved}")
    print(f"- ç”Ÿäº§åŠ›ä¸‹é™çš„DMUæ•°é‡: {productivity_declined}")
    print(f"- ç”Ÿäº§åŠ›ç¨³å®šçš„DMUæ•°é‡: {len(dmus) - productivity_improved - productivity_declined}")
    
    return malmquist_index, dmus

def create_enhanced_efficiency_charts(dmus, ccr_input_scores, ccr_output_scores, bcc_input_scores, bcc_output_scores):
    """
    Create enhanced efficiency analysis charts with detailed English labels and better visualization
    """
    try:
        # Create a 2x3 subplot for more comprehensive visualization
        fig, axes = plt.subplots(2, 3, figsize=(18, 12))
        fig.suptitle('Comprehensive DEA Efficiency Analysis Results', fontsize=18, fontweight='bold')
        
        # Calculate scale efficiency and malmquist index (simplified)
        scale_efficiency = [ccr_input_scores[i] / bcc_input_scores[i] if bcc_input_scores[i] != 0 else 0 for i in range(len(dmus))]
        
        # Chart 1: CCR Input-Oriented vs Output-Oriented Comparison
        x = np.arange(len(dmus))
        width = 0.35
        bars1a = axes[0, 0].bar(x - width/2, ccr_input_scores, width, label='CCR Input-Oriented', color='skyblue', alpha=0.8)
        bars1b = axes[0, 0].bar(x + width/2, [1/score if score != 0 else 0 for score in ccr_output_scores], width, 
                               label='CCR Output-Oriented (Reciprocal)', color='lightgreen', alpha=0.8)
        axes[0, 0].set_title('CCR Model Comparison\n(Technical Efficiency)', fontweight='bold', fontsize=12)
        axes[0, 0].set_ylabel('Efficiency Score', fontsize=10)
        axes[0, 0].set_xticks(range(len(dmus)))
        axes[0, 0].set_xticklabels([dmu.replace('Hospital ', 'H') for dmu in dmus], rotation=45, fontsize=9)
        axes[0, 0].axhline(y=1.0, color='red', linestyle='--', alpha=0.7, label='Efficiency Frontier')
        axes[0, 0].legend(fontsize=8)
        axes[0, 0].grid(True, alpha=0.3)
        axes[0, 0].set_ylim(0, 1.1)
        
        # Chart 2: Scale Efficiency Analysis (moved from position 4 to 2)
        colors = ['green' if se >= 0.99 else 'red' if se < 0.9 else 'orange' for se in scale_efficiency]
        bars2 = axes[0, 1].bar(range(len(dmus)), scale_efficiency, color=colors, alpha=0.8, edgecolor='black')
        axes[0, 1].set_title('Scale Efficiency Analysis\n(SE = TE / PTE)', fontweight='bold', fontsize=12)
        axes[0, 1].set_ylabel('Scale Efficiency', fontsize=10)
        axes[0, 1].set_xticks(range(len(dmus)))
        axes[0, 1].set_xticklabels([dmu.replace('Hospital ', 'H') for dmu in dmus], rotation=45, fontsize=9)
        axes[0, 1].axhline(y=1.0, color='red', linestyle='--', alpha=0.7, label='Optimal Scale')
        axes[0, 1].legend(fontsize=9)
        axes[0, 1].grid(True, alpha=0.3)
        
        # Add value labels on bars
        for bar, se in zip(bars2, scale_efficiency):
            height = bar.get_height()
            axes[0, 1].text(bar.get_x() + bar.get_width()/2., height + 0.01,
                           f'{se:.3f}', ha='center', va='bottom', fontsize=8)
        
        # Chart 3: BCC Input-Oriented vs Output-Oriented Comparison
        x = np.arange(len(dmus))
        width = 0.35
        bars3a = axes[0, 2].bar(x - width/2, bcc_input_scores, width, label='BCC Input-Oriented', color='orange', alpha=0.8)
        bars3b = axes[0, 2].bar(x + width/2, [1/score if score != 0 else 0 for score in bcc_output_scores], width, 
                               label='BCC Output-Oriented (Reciprocal)', color='purple', alpha=0.8)
        axes[0, 2].set_title('BCC Model Comparison\n(Pure Technical Efficiency)', fontweight='bold', fontsize=12)
        axes[0, 2].set_ylabel('Efficiency Score', fontsize=10)
        axes[0, 2].set_xticks(range(len(dmus)))
        axes[0, 2].set_xticklabels([dmu.replace('Hospital ', 'H') for dmu in dmus], rotation=45, fontsize=9)
        axes[0, 2].axhline(y=1.0, color='red', linestyle='--', alpha=0.7, label='Efficiency Frontier')
        axes[0, 2].legend(fontsize=8)
        axes[0, 2].grid(True, alpha=0.3)
        
        # Chart 4: Efficiency Comparison Summary
        efficiency_types = ['CCR Input', 'CCR Output (Reciprocal)', 'BCC Input', 'BCC Output (Reciprocal)', 'Scale Efficiency']
        avg_scores = [
            np.mean(ccr_input_scores),
            np.mean([1/score if score != 0 else 0 for score in ccr_output_scores]),
            np.mean(bcc_input_scores),
            np.mean([1/score if score != 0 else 0 for score in bcc_output_scores]),
            np.mean(scale_efficiency)
        ]
        
        bars4 = axes[1, 0].bar(range(len(efficiency_types)), avg_scores, 
                              color=['skyblue', 'lightgreen', 'orange', 'purple', 'gold'], alpha=0.8)
        axes[1, 0].set_title('Average Efficiency Scores\nAcross All Models', fontweight='bold', fontsize=12)
        axes[1, 0].set_ylabel('Average Efficiency Score', fontsize=10)
        axes[1, 0].set_xticks(range(len(efficiency_types)))
        axes[1, 0].set_xticklabels(efficiency_types, rotation=45, fontsize=9)
        axes[1, 0].axhline(y=1.0, color='red', linestyle='--', alpha=0.7, label='Perfect Efficiency')
        axes[1, 0].legend(fontsize=9)
        axes[1, 0].grid(True, alpha=0.3)
        
        # Add value labels on bars
        for bar, score in zip(bars4, avg_scores):
            height = bar.get_height()
            axes[1, 0].text(bar.get_x() + bar.get_width()/2., height + 0.01,
                           f'{score:.3f}', ha='center', va='bottom', fontsize=8)
        
        # Chart 5: Efficiency Status Distribution
        status_categories = ['Efficient\n(Score â‰¥ 0.99)', 'Moderate\n(0.8 â‰¤ Score < 0.99)', 'Inefficient\n(Score < 0.8)']
        ccr_input_counts = [
            sum(1 for score in ccr_input_scores if score >= 0.99),
            sum(1 for score in ccr_input_scores if 0.8 <= score < 0.99),
            sum(1 for score in ccr_input_scores if score < 0.8)
        ]
        
        bars5 = axes[1, 1].bar(range(len(status_categories)), ccr_input_counts, 
                              color=['green', 'orange', 'red'], alpha=0.8)
        axes[1, 1].set_title('DMU Efficiency Distribution\n(CCR Input-Oriented)', fontweight='bold', fontsize=12)
        axes[1, 1].set_ylabel('Number of DMUs', fontsize=10)
        axes[1, 1].set_xticks(range(len(status_categories)))
        axes[1, 1].set_xticklabels(status_categories, fontsize=9)
        axes[1, 1].grid(True, alpha=0.3)
        
        # Add value labels on bars
        for bar, count in zip(bars5, ccr_input_counts):
            height = bar.get_height()
            axes[1, 1].text(bar.get_x() + bar.get_width()/2., height + 0.05,
                           f'{count}', ha='center', va='bottom', fontsize=10, fontweight='bold')
        
        # Chart 6: Comprehensive Model Comparison Heatmap
        from matplotlib.colors import LinearSegmentedColormap
        
        # Create efficiency matrix for heatmap
        efficiency_matrix = np.array([
            ccr_input_scores,
            [1/score if score != 0 else 0 for score in ccr_output_scores],
            bcc_input_scores,
            [1/score if score != 0 else 0 for score in bcc_output_scores],
            scale_efficiency
        ])
        
        # Create custom colormap
        colors = ['red', 'yellow', 'green']
        n_bins = 100
        cmap = LinearSegmentedColormap.from_list('efficiency', colors, N=n_bins)
        
        im = axes[1, 2].imshow(efficiency_matrix, cmap=cmap, aspect='auto', vmin=0, vmax=1)
        axes[1, 2].set_title('Efficiency Heatmap\nAll Models & DMUs', fontweight='bold', fontsize=12)
        axes[1, 2].set_ylabel('Model Type', fontsize=10)
        axes[1, 2].set_xlabel('DMU', fontsize=10)
        axes[1, 2].set_yticks(range(len(efficiency_types)))
        axes[1, 2].set_yticklabels(['CCR Input', 'CCR Output', 'BCC Input', 'BCC Output', 'Scale Eff.'], fontsize=9)
        axes[1, 2].set_xticks(range(len(dmus)))
        axes[1, 2].set_xticklabels([dmu.replace('Hospital ', 'H') for dmu in dmus], rotation=45, fontsize=9)
        
        # Add colorbar
        plt.colorbar(im, ax=axes[1, 2], shrink=0.8)
        
        plt.tight_layout()
        plt.savefig('dea_enhanced_efficiency_analysis.png', dpi=300, bbox_inches='tight')
        plt.show()
        
        print(f"\nEnhanced chart saved as 'dea_enhanced_efficiency_analysis.png'")
        
    except Exception as e:
        print(f"Error creating enhanced charts: {e}")
        print("Please ensure matplotlib library is installed")

def run_scale_efficiency_analysis():
    """
    è¿è¡Œè§„æ¨¡æ•ˆç‡åˆ†æï¼ˆæ¯”è¾ƒCCRå’ŒBCCæ¨¡å‹ï¼‰
    """
    print("\n" + "="*80)
    print("è§„æ¨¡æ•ˆç‡åˆ†æ (Scale Efficiency Analysis)")
    print("="*80)
    
    # ä½¿ç”¨CSVæ•°æ®
    df_period1, _ = load_hospital_data()
    if df_period1 is None:
        return None, None
    
    # å®šä¹‰è¾“å…¥å’Œè¾“å‡º
    input_cols = ['Doctors', 'Nurses', 'Beds', 'Operating_Cost']
    output_cols = ['Patients_Treated', 'Revenue', 'Patient_Satisfaction']
    
    inputs = df_period1[input_cols].values
    outputs = df_period1[output_cols].values
    dmus = df_period1['DMU'].tolist()
    
    # è¿è¡ŒCCRæ¨¡å‹ï¼ˆCRSï¼‰
    ccr_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.crs)
    ccr_scores = ccr_result.eff
    
    # è¿è¡ŒBCCæ¨¡å‹ï¼ˆVRSï¼‰
    bcc_result = dea(inputs, outputs, orientation=Orientation.input, rts=RTS.vrs)
    bcc_scores = bcc_result.eff
    
    # è®¡ç®—è§„æ¨¡æ•ˆç‡
    scale_efficiency = ccr_scores / bcc_scores
    
    print("\nè§„æ¨¡æ•ˆç‡åˆ†æè¯´æ˜ï¼š")
    print("- æŠ€æœ¯æ•ˆç‡(TE) = CCRå¾—åˆ†")
    print("- çº¯æŠ€æœ¯æ•ˆç‡(PTE) = BCCå¾—åˆ†")
    print("- è§„æ¨¡æ•ˆç‡(SE) = TE / PTE = CCRå¾—åˆ† / BCCå¾—åˆ†")
    print("- SE = 1 è¡¨ç¤ºæœ€ä¼˜è§„æ¨¡ï¼ŒSE < 1 è¡¨ç¤ºè§„æ¨¡æ— æ•ˆç‡")
    
    print(f"\nè§„æ¨¡æ•ˆç‡åˆ†æç»“æœ:")
    print(f"{'DMU':<12} {'æŠ€æœ¯æ•ˆç‡':<10} {'çº¯æŠ€æœ¯æ•ˆç‡':<12} {'è§„æ¨¡æ•ˆç‡':<10} {'è§„æ¨¡çŠ¶æ€':<10}")
    print("-" * 65)
    
    for dmu, te, pte, se in zip(dmus, ccr_scores, bcc_scores, scale_efficiency):
        if se >= 0.99:  # è€ƒè™‘æ•°å€¼ç²¾åº¦
            scale_status = "æœ€ä¼˜è§„æ¨¡"
        elif se < 0.99:
            scale_status = "è§„æ¨¡æ— æ•ˆ"
        else:
            scale_status = "è¿‘ä¼¼æœ€ä¼˜"
            
        print(f"{dmu:<12} {te:<10.4f} {pte:<12.4f} {se:<10.4f} {scale_status:<10}")
    
    # ç»Ÿè®¡åˆ†æ
    optimal_scale_count = sum(1 for se in scale_efficiency if se >= 0.99)
    avg_scale_efficiency = np.mean(scale_efficiency)
    
    print(f"\nè§„æ¨¡æ•ˆç‡æ‘˜è¦ï¼š")
    print(f"- æœ€ä¼˜è§„æ¨¡DMUæ•°é‡: {optimal_scale_count}")
    print(f"- å¹³å‡è§„æ¨¡æ•ˆç‡: {avg_scale_efficiency:.4f}")
    print(f"- è§„æ¨¡æ•ˆç‡æ ‡å‡†å·®: {np.std(scale_efficiency):.4f}")
    
    return scale_efficiency, dmus

def main():
    """
    ä¸»å‡½æ•°ï¼šè¿è¡Œå®Œæ•´çš„DEAåˆ†æ
    """
    print("="*80)
    print("DEAç»¼åˆåˆ†æç³»ç»Ÿ")
    print("="*80)
    
    # æ£€æŸ¥æ•°æ®æ–‡ä»¶
    df_period1, df_period2 = load_hospital_data()
    if df_period1 is None or df_period2 is None:
        print("æ— æ³•åŠ è½½æ•°æ®æ–‡ä»¶ï¼Œè¯·æ£€æŸ¥ 'hospital_data_malmquist.csv' æ˜¯å¦å­˜åœ¨")
        return
    
    print(f"æ•°æ®åŠ è½½æˆåŠŸï¼š")
    print(f"- 2023å¹´æ•°æ®ï¼š{len(df_period1)} ä¸ªåŒ»é™¢")
    print(f"- 2024å¹´æ•°æ®ï¼š{len(df_period2)} ä¸ªåŒ»é™¢")
    print(f"- è¾“å…¥æŒ‡æ ‡ï¼šåŒ»ç”Ÿæ•°é‡ã€æŠ¤å£«æ•°é‡ã€åºŠä½æ•°ã€è¿è¥æˆæœ¬")
    print(f"- è¾“å‡ºæŒ‡æ ‡ï¼šæ¥è¯Šæ‚£è€…æ•°ã€æ”¶å…¥ã€æ‚£è€…æ»¡æ„åº¦")
    
    # è¿è¡Œå„ç§åˆ†æ
    print("\nå¼€å§‹è¿è¡ŒDEAåˆ†æ...")
    
    # 1. CCRæ¨¡å‹åˆ†æ
    print("\n1. è¿è¡ŒCCRæ¨¡å‹åˆ†æ...")
    ccr_results = run_ccr_model_analysis()
    
    # 2. BCCæ¨¡å‹åˆ†æ
    print("\n2. è¿è¡ŒBCCæ¨¡å‹åˆ†æ...")
    bcc_results = run_bcc_model_analysis()
    
    # 3. è¾“å‡ºå¯¼å‘åˆ†æ
    print("\n3. è¿è¡Œè¾“å‡ºå¯¼å‘åˆ†æ...")
    output_results = run_output_oriented_analysis()
    
    # 4. è§„æ¨¡æ•ˆç‡åˆ†æ
    print("\n4. è¿è¡Œè§„æ¨¡æ•ˆç‡åˆ†æ...")
    scale_results = run_scale_efficiency_analysis()
    
    # 5. Malmquistç”Ÿäº§åŠ›åˆ†æ
    print("\n5. è¿è¡ŒMalmquistç”Ÿäº§åŠ›åˆ†æ...")
    malmquist_results = run_malmquist_analysis()
    
    # 6. ç»¼åˆæ¯”è¾ƒåˆ†æ
    print("\n6. è¿è¡Œç»¼åˆæ¯”è¾ƒåˆ†æ...")
    comprehensive_results = run_comprehensive_comparison()
    
    # 7. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
    print("\n7. ç”Ÿæˆç»¼åˆåˆ†æå›¾è¡¨...")
    if all(result is not None for result in [ccr_results, bcc_results]):
        if len(ccr_results) >= 3 and len(bcc_results) >= 3:
            create_enhanced_efficiency_charts(
                ccr_results[2], ccr_results[0], ccr_results[1], 
                bcc_results[0], bcc_results[1]
            )
    
    print("\n" + "="*80)
    print("DEAåˆ†æå®Œæˆï¼")
    print("="*80)

if __name__ == '__main__':
    main()
```

**ç¤ºä¾‹æ•°æ®ï¼š**

`hospital_data_malmquist.csv`

```csv
DMU,Period,Doctors,Nurses,Beds,Operating_Cost,Patients_Treated,Revenue,Patient_Satisfaction
Hospital A,2023,20,50,100,500,1200,800,85
Hospital B,2023,25,60,120,600,1100,750,80
Hospital C,2023,18,45,90,450,1300,900,88
Hospital D,2023,30,70,150,750,1800,1200,90
Hospital E,2023,22,55,110,550,1000,700,78
Hospital F,2023,28,65,140,700,1600,1100,89
Hospital G,2023,15,40,80,400,1200,800,82
Hospital H,2023,35,80,160,800,1900,1300,92
Hospital I,2023,26,58,125,625,1200,850,83
Hospital J,2023,24,52,115,575,1100,800,81
Hospital A,2024,22,52,105,520,1300,900,87
Hospital B,2024,26,62,125,630,1200,850,82
Hospital C,2024,20,48,95,470,1400,1000,90
Hospital D,2024,32,72,155,780,1950,1350,92
Hospital E,2024,24,58,115,580,1100,800,80
Hospital F,2024,30,68,145,730,1750,1250,91
Hospital G,2024,17,42,85,420,1300,900,85
Hospital H,2024,36,82,165,830,2000,1450,94
Hospital I,2024,28,60,130,650,1350,950,85
Hospital J,2024,26,55,120,600,1250,900,83
```

**è¿è¡Œç»“æœ**

```
================================================================================
DEAç»¼åˆåˆ†æç³»ç»Ÿ
================================================================================
æ•°æ®åŠ è½½æˆåŠŸï¼š
- 2023å¹´æ•°æ®ï¼š10 ä¸ªåŒ»é™¢
- 2024å¹´æ•°æ®ï¼š10 ä¸ªåŒ»é™¢
- è¾“å…¥æŒ‡æ ‡ï¼šåŒ»ç”Ÿæ•°é‡ã€æŠ¤å£«æ•°é‡ã€åºŠä½æ•°ã€è¿è¥æˆæœ¬
- è¾“å‡ºæŒ‡æ ‡ï¼šæ¥è¯Šæ‚£è€…æ•°ã€æ”¶å…¥ã€æ‚£è€…æ»¡æ„åº¦

å¼€å§‹è¿è¡ŒDEAåˆ†æ...

1. è¿è¡ŒCCRæ¨¡å‹åˆ†æ...

================================================================================
CCRæ¨¡å‹åˆ†æ (Constant Returns to Scale - CRS)
================================================================================

CCRæ¨¡å‹ç‰¹ç‚¹ï¼š
- å‡è®¾å¸¸æ•°è§„æ¨¡æŠ¥é…¬ï¼ˆConstant Returns to Scaleï¼‰
- æ‰€æœ‰DMUåœ¨ç›¸åŒçš„æŠ€æœ¯æ°´å¹³ä¸‹è¿è¥
- æ•ˆç‡å¾—åˆ†åæ˜ äº†æ•´ä½“æŠ€æœ¯æ•ˆç‡

ã€CCRæ¨¡å‹ - è¾“å…¥å¯¼å‘åˆ†æã€‘
ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å°åŒ–è¾“å…¥ä½¿ç”¨
å¾—åˆ†è§£é‡Šï¼š0 < å¾—åˆ† â‰¤ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† < 1è¡¨ç¤ºå¯ä»¥å‡å°‘è¾“å…¥
----------------------------------------------------------------------
Hospital A: 0.8293 (å¯å‡å°‘æŠ•å…¥ 17.07%)
Hospital B: 0.6504 (å¯å‡å°‘æŠ•å…¥ 34.96%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital D: 0.8571 (å¯å‡å°‘æŠ•å…¥ 14.29%)
Hospital E: 0.6918 (å¯å‡å°‘æŠ•å…¥ 30.82%)
Hospital F: 0.8462 (å¯å‡å°‘æŠ•å…¥ 15.38%)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital H: 0.8125 (å¯å‡å°‘æŠ•å…¥ 18.75%)
Hospital I: 0.7328 (å¯å‡å°‘æŠ•å…¥ 26.72%)
Hospital J: 0.7692 (å¯å‡å°‘æŠ•å…¥ 23.08%)

ã€CCRæ¨¡å‹ - è¾“å‡ºå¯¼å‘åˆ†æã€‘
ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å…¥ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§åŒ–è¾“å‡º
å¾—åˆ†è§£é‡Šï¼šå¾—åˆ† â‰¥ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† > 1è¡¨ç¤ºå¯ä»¥å¢åŠ è¾“å‡º
æ³¨æ„ï¼šè¾“å‡ºå¯¼å‘å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰
----------------------------------------------------------------------
Hospital A: 1.2059 (å¯å¢åŠ äº§å‡º 20.59%)
Hospital B: 1.5375 (å¯å¢åŠ äº§å‡º 53.75%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital D: 1.1667 (å¯å¢åŠ äº§å‡º 16.67%)
Hospital E: 1.4455 (å¯å¢åŠ äº§å‡º 44.55%)
Hospital F: 1.1818 (å¯å¢åŠ äº§å‡º 18.18%)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital H: 1.2308 (å¯å¢åŠ äº§å‡º 23.08%)
Hospital I: 1.3647 (å¯å¢åŠ äº§å‡º 36.47%)
Hospital J: 1.3000 (å¯å¢åŠ äº§å‡º 30.00%)

ã€CCRæ¨¡å‹åˆ†ææ‘˜è¦ã€‘
- è¾“å…¥å¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† 0.8189ï¼Œ2ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- è¾“å‡ºå¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† 1.2433ï¼Œ2ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- æ ‡å‡†å·®ï¼šè¾“å…¥å¯¼å‘ 0.1106ï¼Œè¾“å‡ºå¯¼å‘ 0.1658

2. è¿è¡ŒBCCæ¨¡å‹åˆ†æ...

================================================================================
BCCæ¨¡å‹åˆ†æ (Variable Returns to Scale - VRS)
================================================================================

BCCæ¨¡å‹ç‰¹ç‚¹ï¼š
- å‡è®¾å¯å˜è§„æ¨¡æŠ¥é…¬ï¼ˆVariable Returns to Scaleï¼‰
- å…è®¸DMUåœ¨ä¸åŒè§„æ¨¡ä¸‹è¿è¥
- æµ‹é‡çº¯æŠ€æœ¯æ•ˆç‡ï¼ˆå»é™¤è§„æ¨¡æ•ˆåº”ï¼‰

ã€BCCæ¨¡å‹ - è¾“å…¥å¯¼å‘åˆ†æã€‘
ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å‡ºä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å°åŒ–è¾“å…¥ä½¿ç”¨
å¾—åˆ†è§£é‡Šï¼š0 < å¾—åˆ† â‰¤ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† < 1è¡¨ç¤ºå¯ä»¥å‡å°‘è¾“å…¥
----------------------------------------------------------------------
Hospital A: 0.8500 (å¯å‡å°‘æŠ•å…¥ 15.00%)
Hospital B: 0.6667 (å¯å‡å°‘æŠ•å…¥ 33.33%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital D: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital E: 0.7273 (å¯å‡å°‘æŠ•å…¥ 27.27%)
Hospital F: 0.9487 (å¯å‡å°‘æŠ•å…¥ 5.13%)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital H: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital I: 0.7328 (å¯å‡å°‘æŠ•å…¥ 26.72%)
Hospital J: 0.7692 (å¯å‡å°‘æŠ•å…¥ 23.08%)

ã€BCCæ¨¡å‹ - è¾“å‡ºå¯¼å‘åˆ†æã€‘
ç›®æ ‡ï¼šåœ¨ä¿æŒè¾“å…¥ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§åŒ–è¾“å‡º
å¾—åˆ†è§£é‡Šï¼šå¾—åˆ† â‰¥ 1ï¼Œå¾—åˆ† = 1è¡¨ç¤ºæ•ˆç‡å‰æ²¿ï¼Œå¾—åˆ† > 1è¡¨ç¤ºå¯ä»¥å¢åŠ è¾“å‡º
æ³¨æ„ï¼šè¾“å‡ºå¯¼å‘å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰
----------------------------------------------------------------------
Hospital A: 1.0408 (æ•ˆç‡å‰æ²¿)
Hospital B: 1.1206 (å¯å¢åŠ äº§å‡º 12.06%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital D: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital E: 1.1403 (å¯å¢åŠ äº§å‡º 14.03%)
Hospital F: 1.0144 (æ•ˆç‡å‰æ²¿)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital H: 1.0000 (æ•ˆç‡å‰æ²¿)
Hospital I: 1.0781 (å¯å¢åŠ äº§å‡º 7.81%)
Hospital J: 1.0963 (å¯å¢åŠ äº§å‡º 9.63%)

ã€BCCæ¨¡å‹åˆ†ææ‘˜è¦ã€‘
- è¾“å…¥å¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† 0.8695ï¼Œ4ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- è¾“å‡ºå¯¼å‘ï¼šå¹³å‡æ•ˆç‡å¾—åˆ† 1.0491ï¼Œ6ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- æ ‡å‡†å·®ï¼šè¾“å…¥å¯¼å‘ 0.1284ï¼Œè¾“å‡ºå¯¼å‘ 0.0524

3. è¿è¡Œè¾“å‡ºå¯¼å‘åˆ†æ...

================================================================================
è¾“å‡ºå¯¼å‘DEAåˆ†æ (Output-Oriented DEA Analysis)
================================================================================

ğŸ” è¾“å‡º/è¾“å…¥å¯¼å‘åˆ†æåŸç†è§£é‡Šï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
- è¾“å…¥å¯¼å‘ï¼šå¾—åˆ†èŒƒå›´ 0 < å¾—åˆ† â‰¤ 1
  * å¾—åˆ† = 1ï¼šæ•ˆç‡å‰æ²¿ï¼ˆæœ€ä¼˜ï¼‰
  * å¾—åˆ† < 1ï¼šæ•ˆç‡ä¸è¶³ï¼Œå¯ä»¥å‡å°‘è¾“å…¥

- è¾“å‡ºå¯¼å‘ï¼šå¾—åˆ†èŒƒå›´ å¾—åˆ† â‰¥ 1
  * å¾—åˆ† = 1ï¼šæ•ˆç‡å‰æ²¿ï¼ˆæœ€ä¼˜ï¼‰
  * å¾—åˆ† > 1ï¼šæ•ˆç‡ä¸è¶³ï¼Œå¯ä»¥å¢åŠ è¾“å‡º
  * å¾—åˆ†è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ï¼ˆä¸è¾“å…¥å¯¼å‘ç›¸åï¼‰

ğŸ“ˆ æ•°å­¦è§£é‡Šï¼š
- è¾“å‡ºå¯¼å‘å¾—åˆ†è¡¨ç¤ºï¼šåœ¨å½“å‰è¾“å…¥æ°´å¹³ä¸‹ï¼Œç†è®ºä¸Šå¯ä»¥è¾¾åˆ°çš„è¾“å‡ºå€æ•°
- ä¾‹å¦‚å¾—åˆ†1.5è¡¨ç¤ºï¼šåœ¨ä¸å¢åŠ è¾“å…¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†è¾“å‡ºå¢åŠ åˆ°å½“å‰çš„1.5å€
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€è¾“å‡ºå¯¼å‘BCCæ¨¡å‹æ•ˆç‡å¾—åˆ†ï¼ˆVRSï¼‰ã€‘
æ¨¡å‹ç‰¹ç‚¹ï¼šå¯å˜è§„æ¨¡æŠ¥é…¬ï¼Œæµ‹é‡çº¯æŠ€æœ¯æ•ˆç‡
------------------------------------------------------------
Hospital A: 1.0408 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital B: 1.1206 (æ•ˆç‡ 89.2%ï¼Œå¯å¢åŠ äº§å‡º 12.06%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital D: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital E: 1.1403 (æ•ˆç‡ 87.7%ï¼Œå¯å¢åŠ äº§å‡º 14.03%)
Hospital F: 1.0144 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital H: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital I: 1.0781 (æ•ˆç‡ 92.8%ï¼Œå¯å¢åŠ äº§å‡º 7.81%)
Hospital J: 1.0963 (æ•ˆç‡ 91.2%ï¼Œå¯å¢åŠ äº§å‡º 9.63%)

ã€è¾“å‡ºå¯¼å‘CCRæ¨¡å‹æ•ˆç‡å¾—åˆ†ï¼ˆCRSï¼‰ã€‘
æ¨¡å‹ç‰¹ç‚¹ï¼šå¸¸æ•°è§„æ¨¡æŠ¥é…¬ï¼Œæµ‹é‡æ•´ä½“æŠ€æœ¯æ•ˆç‡
------------------------------------------------------------
Hospital A: 1.2059 (æ•ˆç‡ 82.9%ï¼Œå¯å¢åŠ äº§å‡º 20.59%)
Hospital B: 1.5375 (æ•ˆç‡ 65.0%ï¼Œå¯å¢åŠ äº§å‡º 53.75%)
Hospital C: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital D: 1.1667 (æ•ˆç‡ 85.7%ï¼Œå¯å¢åŠ äº§å‡º 16.67%)
Hospital E: 1.4455 (æ•ˆç‡ 69.2%ï¼Œå¯å¢åŠ äº§å‡º 44.55%)
Hospital F: 1.1818 (æ•ˆç‡ 84.6%ï¼Œå¯å¢åŠ äº§å‡º 18.18%)
Hospital G: 1.0000 (æ•ˆç‡å‰æ²¿ï¼Œæ•ˆç‡ 100%)
Hospital H: 1.2308 (æ•ˆç‡ 81.2%ï¼Œå¯å¢åŠ äº§å‡º 23.08%)
Hospital I: 1.3647 (æ•ˆç‡ 73.3%ï¼Œå¯å¢åŠ äº§å‡º 36.47%)
Hospital J: 1.3000 (æ•ˆç‡ 76.9%ï¼Œå¯å¢åŠ äº§å‡º 30.00%)

ã€æ¨¡å‹é—´å¯¹æ¯”åˆ†æã€‘
DMU          è¾“å…¥å¯¼å‘(BCC)       è¾“å…¥å¯¼å‘(CCR)       è¾“å‡ºå¯¼å‘(BCC)       è¾“å‡ºå¯¼å‘(CCR)       æ•ˆç‡ä¸€è‡´æ€§     
-----------------------------------------------------------------------------------------------
Hospital A   0.8500          0.8293          1.0408          1.2059          ä¸ä¸€è‡´       
Hospital B   0.6667          0.6504          1.1206          1.5375          ä¸€è‡´        
Hospital C   1.0000          1.0000          1.0000          1.0000          ä¸€è‡´        
Hospital D   1.0000          0.8571          1.0000          1.1667          ä¸€è‡´        
Hospital E   0.7273          0.6918          1.1403          1.4455          ä¸€è‡´        
Hospital F   0.9487          0.8462          1.0144          1.1818          ä¸ä¸€è‡´       
Hospital G   1.0000          1.0000          1.0000          1.0000          ä¸€è‡´        
Hospital H   1.0000          0.8125          1.0000          1.2308          ä¸€è‡´        
Hospital I   0.7328          0.7328          1.0781          1.3647          ä¸€è‡´        
Hospital J   0.7692          0.7692          1.0963          1.3000          ä¸€è‡´        

ã€æ•ˆç‡ä¸€è‡´æ€§è¯¦ç»†åˆ†æã€‘
ä¸€è‡´æ€§åˆ¤æ–­æ ‡å‡†ï¼š
- åŸºäºBCCæ¨¡å‹ï¼ˆçº¯æŠ€æœ¯æ•ˆç‡ï¼‰æ¯”è¾ƒè¾“å…¥å¯¼å‘å’Œè¾“å‡ºå¯¼å‘çš„ç»“æœ
- è¾“å…¥å¯¼å‘é«˜æ•ˆ(â‰¥0.99)ä¸”è¾“å‡ºå¯¼å‘é«˜æ•ˆ(â‰¤1.05) = ä¸€è‡´é«˜æ•ˆ
- è¾“å…¥å¯¼å‘ä½æ•ˆ(<0.99)ä¸”è¾“å‡ºå¯¼å‘ä½æ•ˆ(>1.05) = ä¸€è‡´ä½æ•ˆ
- ä¸€ä¸ªæ–¹å‘é«˜æ•ˆï¼Œå¦ä¸€ä¸ªæ–¹å‘ä½æ•ˆ = ä¸ä¸€è‡´
----------------------------------------------------------------------
Hospital A: ä¸ä¸€è‡´
Hospital B: ä¸€è‡´ä½æ•ˆ
Hospital C: ä¸€è‡´é«˜æ•ˆ
Hospital D: ä¸€è‡´é«˜æ•ˆ
Hospital E: ä¸€è‡´ä½æ•ˆ
Hospital F: ä¸ä¸€è‡´
Hospital G: ä¸€è‡´é«˜æ•ˆ
Hospital H: ä¸€è‡´é«˜æ•ˆ
Hospital I: ä¸€è‡´ä½æ•ˆ
Hospital J: ä¸€è‡´ä½æ•ˆ

ä¸€è‡´æ€§æ‘˜è¦ï¼š8/10 ä¸ªDMUåœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šè¡¨ç°ä¸€è‡´

ã€ç»Ÿè®¡æ‘˜è¦ã€‘
- BCCè¾“å‡ºå¯¼å‘ï¼šå¹³å‡å¾—åˆ† 1.0491ï¼Œ6ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- CCRè¾“å‡ºå¯¼å‘ï¼šå¹³å‡å¾—åˆ† 1.2433ï¼Œ2ä¸ªDMUè¾¾åˆ°æ•ˆç‡å‰æ²¿
- æ ‡å‡†å·®ï¼šBCCè¾“å‡ºå¯¼å‘ 0.0524ï¼ŒCCRè¾“å‡ºå¯¼å‘ 0.1658

4. è¿è¡Œè§„æ¨¡æ•ˆç‡åˆ†æ...

================================================================================
è§„æ¨¡æ•ˆç‡åˆ†æ (Scale Efficiency Analysis)
================================================================================

è§„æ¨¡æ•ˆç‡åˆ†æè¯´æ˜ï¼š
- æŠ€æœ¯æ•ˆç‡(TE) = CCRå¾—åˆ†
- çº¯æŠ€æœ¯æ•ˆç‡(PTE) = BCCå¾—åˆ†
- è§„æ¨¡æ•ˆç‡(SE) = TE / PTE = CCRå¾—åˆ† / BCCå¾—åˆ†
- SE = 1 è¡¨ç¤ºæœ€ä¼˜è§„æ¨¡ï¼ŒSE < 1 è¡¨ç¤ºè§„æ¨¡æ— æ•ˆç‡

è§„æ¨¡æ•ˆç‡åˆ†æç»“æœ:
DMU          æŠ€æœ¯æ•ˆç‡       çº¯æŠ€æœ¯æ•ˆç‡        è§„æ¨¡æ•ˆç‡       è§„æ¨¡çŠ¶æ€      
-----------------------------------------------------------------
Hospital A   0.8293     0.8500       0.9756     è§„æ¨¡æ— æ•ˆ      
Hospital B   0.6504     0.6667       0.9756     è§„æ¨¡æ— æ•ˆ      
Hospital C   1.0000     1.0000       1.0000     æœ€ä¼˜è§„æ¨¡      
Hospital D   0.8571     1.0000       0.8571     è§„æ¨¡æ— æ•ˆ      
Hospital E   0.6918     0.7273       0.9512     è§„æ¨¡æ— æ•ˆ      
Hospital F   0.8462     0.9487       0.8919     è§„æ¨¡æ— æ•ˆ      
Hospital G   1.0000     1.0000       1.0000     æœ€ä¼˜è§„æ¨¡      
Hospital H   0.8125     1.0000       0.8125     è§„æ¨¡æ— æ•ˆ      
Hospital I   0.7328     0.7328       1.0000     æœ€ä¼˜è§„æ¨¡      
Hospital J   0.7692     0.7692       1.0000     æœ€ä¼˜è§„æ¨¡      

è§„æ¨¡æ•ˆç‡æ‘˜è¦ï¼š
- æœ€ä¼˜è§„æ¨¡DMUæ•°é‡: 4
- å¹³å‡è§„æ¨¡æ•ˆç‡: 0.9464
- è§„æ¨¡æ•ˆç‡æ ‡å‡†å·®: 0.0649

5. è¿è¡ŒMalmquistç”Ÿäº§åŠ›åˆ†æ...

================================================================================
Malmquistç”Ÿäº§åŠ›æŒ‡æ•°åˆ†æ (Malmquist Productivity Index)
================================================================================

MalmquistæŒ‡æ•°åˆ†æè¯´æ˜ï¼š
- æµ‹é‡ä¸¤ä¸ªæ—¶æœŸä¹‹é—´çš„ç”Ÿäº§åŠ›å˜åŒ–
- MI > 1: ç”Ÿäº§åŠ›æé«˜
- MI = 1: ç”Ÿäº§åŠ›ä¸å˜
- MI < 1: ç”Ÿäº§åŠ›ä¸‹é™
- å¯ä»¥åˆ†è§£ä¸ºæŠ€æœ¯æ•ˆç‡å˜åŒ–å’ŒæŠ€æœ¯è¿›æ­¥

2023å¹´åˆ°2024å¹´çš„ç”Ÿäº§åŠ›å˜åŒ–åˆ†æ:
DMU          2023æ•ˆç‡     2024æ•ˆç‡     æ•ˆç‡å˜åŒ–       MalmquistæŒ‡æ•°  çŠ¶æ€        
---------------------------------------------------------------------------
Hospital A   0.8293     0.8286     0.9992     0.9546       ç”Ÿäº§åŠ›ç¨³å®š     
Hospital B   0.6504     0.6560     1.0086     1.0776       ç”Ÿäº§åŠ›æé«˜     
Hospital C   1.0000     0.9942     0.9942     1.1290       ç”Ÿäº§åŠ›æé«˜     
Hospital D   0.8571     0.8750     1.0208     1.0461       ç”Ÿäº§åŠ›ç¨³å®š     
Hospital E   0.6918     0.6957     1.0056     0.8167       ç”Ÿäº§åŠ›ä¸‹é™     
Hospital F   0.8462     0.8578     1.0138     1.0519       ç”Ÿäº§åŠ›æé«˜     
Hospital G   1.0000     1.0000     1.0000     0.8718       ç”Ÿäº§åŠ›ä¸‹é™     
Hospital H   0.8125     0.8300     1.0215     1.0035       ç”Ÿäº§åŠ›ç¨³å®š     
Hospital I   0.7328     0.7389     1.0084     1.1973       ç”Ÿäº§åŠ›æé«˜     
Hospital J   0.7692     0.7636     0.9927     0.8927       ç”Ÿäº§åŠ›ä¸‹é™     

æ•´ä½“ç”Ÿäº§åŠ›å˜åŒ–æ‘˜è¦ï¼š
- å¹³å‡MalmquistæŒ‡æ•°: 1.0041
- ç”Ÿäº§åŠ›æé«˜çš„DMUæ•°é‡: 4
- ç”Ÿäº§åŠ›ä¸‹é™çš„DMUæ•°é‡: 3
- ç”Ÿäº§åŠ›ç¨³å®šçš„DMUæ•°é‡: 3

6. è¿è¡Œç»¼åˆæ¯”è¾ƒåˆ†æ...

================================================================================
å››ç§DEAæ¨¡å‹ç»¼åˆæ¯”è¾ƒåˆ†æ
================================================================================

ğŸ“Š å››ç§æ¨¡å‹ç»“æœå¯¹æ¯”è¡¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
DMU          CCRè¾“å…¥      CCRè¾“å‡º      BCCè¾“å…¥      BCCè¾“å‡º      è§„æ¨¡æ•ˆç‡      
------------------------------------------------------------------------------------------
Hospital A   0.8293     1.2059     0.8500     1.0408     0.9756    
Hospital B   0.6504     1.5375     0.6667     1.1206     0.9756    
Hospital C   1.0000     1.0000     1.0000     1.0000     1.0000    
Hospital D   0.8571     1.1667     1.0000     1.0000     0.8571    
Hospital E   0.6918     1.4455     0.7273     1.1403     0.9512    
Hospital F   0.8462     1.1818     0.9487     1.0144     0.8919    
Hospital G   1.0000     1.0000     1.0000     1.0000     1.0000    
Hospital H   0.8125     1.2308     1.0000     1.0000     0.8125    
Hospital I   0.7328     1.3647     0.7328     1.0781     1.0000    
Hospital J   0.7692     1.3000     0.7692     1.0963     1.0000    

ğŸ“ˆ æ•ˆç‡å‰æ²¿DMUæ•°é‡ç»Ÿè®¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
CCRè¾“å…¥å¯¼å‘: 2/10 (20.0%)
CCRè¾“å‡ºå¯¼å‘: 2/10 (20.0%)
BCCè¾“å…¥å¯¼å‘: 4/10 (40.0%)
BCCè¾“å‡ºå¯¼å‘: 6/10 (60.0%)

ğŸ“Š å¹³å‡æ•ˆç‡å¾—åˆ†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
CCRè¾“å…¥å¯¼å‘: 0.8189
CCRè¾“å‡ºå¯¼å‘: 1.2433
BCCè¾“å…¥å¯¼å‘: 0.8695
BCCè¾“å‡ºå¯¼å‘: 1.0491

ğŸ¯ æ•ˆç‡ç±»å‹åˆ†æ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Hospital A: éœ€è¦æ”¹è¿›
Hospital B: éœ€è¦æ”¹è¿›
Hospital C: CCRé«˜æ•ˆ, BCCé«˜æ•ˆ, è§„æ¨¡æœ€ä¼˜
Hospital D: BCCé«˜æ•ˆ
Hospital E: éœ€è¦æ”¹è¿›
Hospital F: éœ€è¦æ”¹è¿›
Hospital G: CCRé«˜æ•ˆ, BCCé«˜æ•ˆ, è§„æ¨¡æœ€ä¼˜
Hospital H: BCCé«˜æ•ˆ
Hospital I: è§„æ¨¡æœ€ä¼˜
Hospital J: è§„æ¨¡æœ€ä¼˜

7. ç”Ÿæˆç»¼åˆåˆ†æå›¾è¡¨...

Enhanced chart saved as 'dea_enhanced_efficiency_analysis.png'

================================================================================
DEAåˆ†æå®Œæˆï¼
================================================================================
```

![](https://img.picgo.net/2025/07/10/25-07-10-1752156439399b3ba05697719822c.webp)

## RSR ç§©å’Œæ¯”ç»¼åˆè¯„ä»·æ–¹æ³•


**ç§©å’Œæ¯”æ³•ï¼ˆRank Sum Ratio, RSRï¼‰** æ˜¯ä¸€ç§ç»“åˆäº†éå‚æ•°ç»Ÿè®¡å’Œå¤šå…ƒç»Ÿè®¡æ€æƒ³çš„ç»¼åˆè¯„ä»·æ–¹æ³•ã€‚è¯¥æ–¹æ³•ç”±ä¸­å›½ç»Ÿè®¡å­¦å®¶ç”°å‡¤è°ƒæ•™æˆäº1988å¹´æå‡ºï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç§©è½¬æ¢ï¼Œå°†å¤šä¸ªå…·æœ‰ä¸åŒé‡çº²ã€ä¸åŒæ€§è´¨çš„è¯„ä»·æŒ‡æ ‡è½¬åŒ–ä¸ºæ— é‡çº²çš„ç§©å’Œæ¯”å€¼ï¼Œä»è€Œå¯¹è¯„ä»·å¯¹è±¡è¿›è¡Œæ’åºã€åˆ†æ¡£å’Œç»¼åˆè¯„ä¼°

RSRæ–¹æ³•çš„åŸºç¡€æ˜¯ç»Ÿè®¡å­¦ä¸­çš„â€œç§©â€ï¼ˆRankï¼‰ã€‚ç§©ä»£è¡¨ä¸€ä¸ªæ•°å€¼åœ¨å…¶æ‰€åœ¨æ•°æ®åºåˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ç»„æˆç»© `[65, 92, 78, 85]` ä¸­ï¼Œ92åˆ†æ˜¯æœ€é«˜çš„ï¼Œå…¶ç§©ä¸º4ï¼›65åˆ†æ˜¯æœ€ä½çš„ï¼Œå…¶ç§©ä¸º1

RSRæ³•æ­£æ˜¯åˆ©ç”¨äº†ç§©çš„è¿™ä¸€ç‰¹æ€§ï¼š
1.  **å‰¥ç¦»é‡çº²**ï¼šæ— è®ºåŸå§‹æŒ‡æ ‡æ˜¯â€œå…ƒâ€ã€â€œç™¾åˆ†æ¯”â€è¿˜æ˜¯â€œä¸ªâ€ï¼Œä¸€æ—¦è½¬åŒ–ä¸ºç§©ï¼Œå®ƒä»¬éƒ½å˜æˆäº†ç»Ÿä¸€çš„ã€æ— é‡çº²çš„åºå·ï¼Œä»è€Œå…·æœ‰äº†å¯æ¯”æ€§
2.  **ç»¼åˆè¯„ä»·**ï¼šé€šè¿‡å°†ä¸€ä¸ªè¯„ä»·å¯¹è±¡åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸‹çš„ç§©æ¬¡ç›¸åŠ ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ€»çš„â€œç§©å’Œâ€ã€‚è¿™ä¸ªç§©å’Œçš„å¤§å°ï¼Œç›´è§‚åœ°åæ˜ äº†è¯¥å¯¹è±¡åœ¨æ‰€æœ‰è¯„ä»·ç»´åº¦ä¸‹çš„ç»¼åˆä¼˜åŠ£ç¨‹åº¦
3.  **å½’ä¸€åŒ–å¤„ç†**ï¼šå°†ç§©å’Œé™¤ä»¥ç†è®ºä¸Šçš„æœ€å¤§å¯èƒ½ç§©å’Œï¼Œå¾—åˆ°æœ€ç»ˆçš„RSRå€¼ï¼Œä½¿å…¶è½åœ¨ `(0, 1)` åŒºé—´å†…ï¼Œä¾¿äºæ¯”è¾ƒå’Œç†è§£ã€‚RSRå€¼è¶Šæ¥è¿‘1ï¼Œè¡¨ç¤ºç»¼åˆè¯„ä»·è¶Šä¼˜

### æ ¸å¿ƒæ­¥éª¤

#### 1. æ„å»ºåŸå§‹æ•°æ®çŸ©é˜µå¹¶æ˜ç¡®æŒ‡æ ‡ç±»å‹

å°† $n$ ä¸ªè¯„ä»·å¯¹è±¡å’Œ $m$ ä¸ªè¯„ä»·æŒ‡æ ‡æ•´ç†æˆä¸€ä¸ª $n \times m$ çš„åŸå§‹æ•°æ®è¡¨

$$
X = 
\begin{pmatrix}
x_{11} & x_{12} & \cdots & x_{1m} \\
x_{21} & x_{22} & \cdots & x_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
x_{n1} & x_{n2} & \cdots & x_{nm}
\end{pmatrix}
$$

åŒæ—¶ï¼Œå¿…é¡»æ˜ç¡®æ¯ä¸ªæŒ‡æ ‡çš„å±æ€§ï¼š
* **é«˜ä¼˜æŒ‡æ ‡ï¼ˆæ•ˆç›Šå‹ï¼‰**ï¼šæŒ‡æ ‡å€¼è¶Šå¤§è¶Šå¥½ã€‚å¦‚ï¼šGDPå¢é•¿ç‡ã€æ²»æ„ˆç‡
* **ä½ä¼˜æŒ‡æ ‡ï¼ˆæˆæœ¬å‹ï¼‰**ï¼šæŒ‡æ ‡å€¼è¶Šå°è¶Šå¥½ã€‚å¦‚ï¼šæ­»äº¡ç‡ã€æ±¡æŸ“æŒ‡æ•°
* **ä¸­é—´å€¼æŒ‡æ ‡ï¼ˆé€‚åº¦å‹ï¼‰**ï¼šæŒ‡æ ‡å€¼è¶Šæ¥è¿‘æŸä¸ªç†æƒ³å€¼æˆ–ç†æƒ³åŒºé—´è¶Šå¥½ã€‚å¦‚ï¼šå­¦ç”Ÿä½“è´¨æŒ‡æ•°ï¼ˆBMIï¼‰ã€æ°´è´¨é…¸ç¢±åº¦ï¼ˆpHï¼‰

#### 2. ç¼–ç§©ï¼ˆRankingï¼‰

è¿™æ˜¯RSRæ–¹æ³•æœ€å…³é”®çš„ä¸€æ­¥ï¼Œç›®çš„æ˜¯å°†åŸå§‹æ•°æ®çŸ©é˜µ $X$ è½¬æ¢ä¸ºç§©æ¬¡çŸ©é˜µ $R$ã€‚ç¼–ç§©çš„è§„åˆ™å–å†³äºæŒ‡æ ‡ç±»å‹

* **é«˜ä¼˜æŒ‡æ ‡**ï¼šå°†åŸå§‹æ•°æ®**ä»å°åˆ°å¤§**æ’åºï¼Œæ•°å€¼æœ€å°çš„ç§©ä¸º1ï¼Œæ¬¡å°çš„ä¸º2ï¼Œ...ï¼Œæœ€å¤§çš„ä¸º $n$
* **ä½ä¼˜æŒ‡æ ‡**ï¼šå°†åŸå§‹æ•°æ®**ä»å¤§åˆ°å°**æ’åºï¼Œæ•°å€¼æœ€å¤§çš„ç§©ä¸º1ï¼Œæ¬¡å¤§çš„ä¸º2ï¼Œ...ï¼Œæœ€å°çš„ä¸º $n$
* **ä¸­é—´å€¼æŒ‡æ ‡**ï¼š
    1.  **ç¡®å®šæœ€ä½³å€¼/åŒºé—´**ï¼šé¦–å…ˆç¡®å®šä¸€ä¸ªæœ€ä½³å€¼ $M$ æˆ–æœ€ä½³åŒºé—´ $[a, b]$
    2.  **è®¡ç®—ç¦»å·®**ï¼šè®¡ç®—æ¯ä¸ªæ•°æ®ç‚¹ä¸æœ€ä½³å€¼/åŒºé—´çš„å·®è·ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„â€œç¦»å·®â€åºåˆ—
        * æœ€ä½³å€¼ï¼šç¦»å·® $D_i = |X_i - M|$
        * æœ€ä½³åŒºé—´ï¼šè‹¥ $X_i \in [a, b]$, $D_i = 0$ï¼›è‹¥ $X_i < a$, $D_i = a - X_i$ï¼›è‹¥ $X_i > b$, $D_i = X_i - b$
    3.  **è½¬åŒ–ä¸ç¼–ç§©**ï¼šè¿™ä¸ªâ€œç¦»å·®â€åºåˆ—æ˜¯ä¸€ä¸ªå…¸å‹çš„**ä½ä¼˜æŒ‡æ ‡**ï¼ˆç¦»å·®è¶Šå°è¶Šå¥½ï¼‰ï¼Œå› æ­¤å¯¹å…¶æŒ‰ç…§ä½ä¼˜æŒ‡æ ‡çš„è§„åˆ™è¿›è¡Œç¼–ç§©

* **å¤„ç†ç›¸åŒæ•°å€¼ï¼ˆç»“ï¼‰**ï¼šè‹¥ä¸€ä¸ªæŒ‡æ ‡ä¸‹æœ‰å¤šä¸ªç›¸åŒæ•°å€¼ï¼Œå®ƒä»¬åº”è·å¾—å…¶å¯¹åº”ç§©æ¬¡çš„å¹³å‡å€¼ã€‚ä¾‹å¦‚ï¼ŒæŸåˆ—æ•°æ®ä»å°åˆ°å¤§æ’ï¼Œç¬¬3ã€4ã€5ä½éƒ½æ˜¯ç›¸åŒçš„å€¼ï¼Œåˆ™å®ƒä»¬çš„ç§©æ¬¡å‡ä¸º $(3+4+5)/3 = 4$

#### 3. è®¡ç®—ç§©å’Œæ¯”ï¼ˆRSRï¼‰

å¯¹æ¯ä¸ªè¯„ä»·å¯¹è±¡ï¼Œå°†å…¶åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸‹çš„ç§©æ¬¡ç›¸åŠ ï¼Œç„¶åè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå¾—åˆ°è¯¥å¯¹è±¡çš„RSRå€¼

$$
RSR_i = \frac{\sum_{j=1}^{m} R_{ij}}{n \times m}
$$

å…¶ä¸­ï¼š
* $RSR_i$ æ˜¯ç¬¬ $i$ ä¸ªè¯„ä»·å¯¹è±¡çš„ç§©å’Œæ¯”å€¼
* $\sum_{j=1}^{m} R_{ij}$ æ˜¯ç¬¬ $i$ ä¸ªè¯„ä»·å¯¹è±¡åœ¨ $m$ ä¸ªæŒ‡æ ‡ä¸‹çš„ç§©æ¬¡ä¹‹å’Œ
* $n$ æ˜¯è¯„ä»·å¯¹è±¡çš„æ€»æ•°
* $m$ æ˜¯è¯„ä»·æŒ‡æ ‡çš„æ€»æ•°

è®¡ç®—å‡ºçš„ $RSR_i$ å€¼ä»‹äº $(0, 1)$ ä¹‹é—´ã€‚å¯ä»¥ç›´æ¥æ ¹æ®RSRå€¼çš„å¤§å°å¯¹æ‰€æœ‰è¯„ä»·å¯¹è±¡è¿›è¡Œæ’åºï¼ŒRSRå€¼è¶Šå¤§ï¼Œç»¼åˆè¯„ä»·ç»“æœè¶Šä¼˜

#### 4.ç¡®å®šRSRçš„åˆ†å¸ƒå¹¶è®¡ç®—æ¦‚ç‡å•ä½ï¼ˆProbitï¼‰

å¯ä»¥é€šè¿‡äº†è§£RSRå€¼çš„åˆ†å¸ƒç‰¹å¾è¿›è¡Œæ›´å®¢è§‚çš„åˆ†æ¡£

1.  **æ’åº**ï¼šå°†è®¡ç®—å‡ºçš„æ‰€æœ‰ $RSR_i$ å€¼ä»å°åˆ°å¤§æ’åº
2.  **è®¡ç®—å¹³å‡ç§©æ¬¡**ï¼šå¯¹æ’åºåçš„ç»“æœå†æ¬¡è¿›è¡Œç¼–åˆ¶å¾—åˆ°å…¶å¹³å‡ç§©æ¬¡
3.  **è®¡ç®—ç´¯è®¡é¢‘ç‡ (Cumulative Frequency)**ï¼š$P_i = \frac{\text{å¹³å‡ç§©æ¬¡}_i}{n} \times 100\%$ã€‚å¯¹äºæœ€åä¸€ä¸ªRSRå€¼ï¼Œä¸ºé¿å…é¢‘ç‡ä¸º100%å¯¼è‡´æ¦‚ç‡å•ä½æ— ç©·å¤§ï¼Œé€šå¸¸é‡‡ç”¨ä¿®æ­£å…¬å¼ï¼Œå¦‚ $P_i = \frac{\text{å¹³å‡ç§©æ¬¡}_i}{n+1}$
4.  **è½¬æ¢ä¸ºæ¦‚ç‡å•ä½ (Probit)**ï¼šå°†ç´¯è®¡é¢‘ç‡ $P_i$ è½¬æ¢ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒå¯¹åº”çš„åˆ†ä½æ•°ï¼Œå³Probitå€¼ã€‚Probitæ˜¯æœŸæœ›å€¼ä¸º5ã€æ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒåˆ†ä½æ•°ï¼ˆ`Probit = Z-score + 5`ï¼‰

#### 5. è®¡ç®—çº¿æ€§å›å½’æ–¹ç¨‹

ä»¥RSRå€¼ä¸ºå› å˜é‡ï¼ˆYï¼‰ï¼Œä»¥å…¶å¯¹åº”çš„æ¦‚ç‡å•ä½Probitå€¼ä¸ºè‡ªå˜é‡ï¼ˆXï¼‰ï¼Œå»ºç«‹çº¿æ€§å›å½’æ¨¡å‹ï¼š

$$
\hat{RSR} = a + b \times \text{Probit} 
$$

å…¶ä¸­ $a$ æ˜¯æˆªè·ï¼Œ $b$ æ˜¯å›å½’ç³»æ•°ã€‚è¿™ä¸ªå›å½’æ–¹ç¨‹æè¿°äº†RSRå€¼ä¸æ­£æ€åˆ†å¸ƒåˆ†ä½æ•°ä¹‹é—´çš„çº¿æ€§å…³ç³»ï¼Œå¯ä»¥ç”¨æ¥é¢„æµ‹åœ¨ç‰¹å®šæ¦‚ç‡æ°´å¹³ä¸‹çš„RSRå€¼ã€‚

#### 6. æ’åºä¸åˆ†æ¡£ï¼ˆStratified Groupingï¼‰

æ ¹æ®å›å½’æ–¹ç¨‹å’Œé¢„è®¾çš„åˆ†æ¡£æ ‡å‡†ï¼ˆé€šå¸¸ä¾æ®æ¦‚ç‡å•ä½ï¼‰ï¼Œå¯¹è¯„ä»·å¯¹è±¡è¿›è¡Œç­‰çº§åˆ’åˆ†

ä¸€ä¸ªå¸¸ç”¨çš„åˆ†æ¡£æ ‡å‡†æ˜¯ï¼š
* **å·® (Poor)**ï¼šProbit < 4 (å¯¹åº”ç´¯è®¡é¢‘ç‡ < 15.87%)
* **ä¸­ (Medium)**ï¼š4 â‰¤ Probit < 6 (å¯¹åº”ç´¯è®¡é¢‘ç‡ 15.87% ~ 84.13%)
* **ä¼˜ (Good)**ï¼šProbit â‰¥ 6 (å¯¹åº”ç´¯è®¡é¢‘ç‡ > 84.13%)

å°†è¿™äº›Probitåˆ†ç•Œå€¼ï¼ˆå¦‚4å’Œ6ï¼‰ä»£å…¥ä¸Šä¸€æ­¥è®¡ç®—å‡ºçš„å›å½’æ–¹ç¨‹ï¼Œå³å¯å¾—åˆ°å¯¹åº”çš„RSRåˆ†æ¡£é˜ˆå€¼ï¼Œä»è€Œå¯¹æ‰€æœ‰è¯„ä»·å¯¹è±¡è¿›è¡Œç§‘å­¦ã€å®¢è§‚çš„ç­‰çº§åˆ’åˆ†ã€‚

### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**

1.  **é€‚ç”¨æ€§å¹¿**ï¼šä½œä¸ºéå‚æ•°æ–¹æ³•ï¼Œå¯¹æ•°æ®ç±»å‹å’Œåˆ†å¸ƒæ²¡æœ‰ä¸¥æ ¼é™åˆ¶ï¼Œç¨³å¥æ€§å¥½
2.  **æ“ä½œç®€ä¾¿**ï¼šåŸç†ç›´è§‚ï¼Œè®¡ç®—æ­¥éª¤æ¸…æ™°ï¼Œæ˜“äºé€šè¿‡è½¯ä»¶å®ç°è‡ªåŠ¨åŒ–
3.  **ä¿¡æ¯æŸå¤±ç›¸å¯¹å¯æ§**ï¼šè™½ç„¶æŸå¤±äº†åŸå§‹æ•°å€¼çš„ç»å¯¹å¤§å°ä¿¡æ¯ï¼Œä½†ä¿ç•™äº†å…¶ç›¸å¯¹ä½ç½®ï¼ˆé¡ºåºï¼‰ä¿¡æ¯ï¼Œè¿™åœ¨å¾ˆå¤šç»¼åˆè¯„ä»·åœºæ™¯ä¸­å·²ç»è¶³å¤Ÿ
4.  **ç»“æœå®¢è§‚**ï¼šæ•´ä¸ªè¿‡ç¨‹åŸºäºæ•°æ®é©±åŠ¨ï¼Œé¿å…äº†ä¸»è§‚èµ‹æƒçš„å›°éš¾å’Œäº‰è®®
5.  **æ”¯æŒæ·±åº¦åˆ†æ**ï¼šä¸ä»…æä¾›æ’åºï¼Œè¿˜èƒ½é€šè¿‡æ¦‚ç‡åˆ†æ¡£å®ç°å¯¹è¯„ä»·å¯¹è±¡çš„åˆ†ç±»ç®¡ç†

**ç¼ºç‚¹**

1.  **ä¿¡æ¯æŸå¤±**ï¼šç¼–ç§©è¿‡ç¨‹ä¼šæŸå¤±åŸå§‹æ•°æ®çš„ç»å¯¹æ•°å€¼å·®å¼‚ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œ[90, 89] å’Œ [90, 60] åœ¨ç¼–ç§©åå¯èƒ½å¾—åˆ°å®Œå…¨ç›¸åŒçš„ç§©æ¬¡ï¼Œæ— æ³•ä½“ç°ä¸¤è€…å·®è·çš„æ‚¬æ®Š
2.  **æŒ‡æ ‡æƒé‡é—®é¢˜**ï¼šä¼ ç»ŸRSRæ³•é»˜è®¤æ‰€æœ‰æŒ‡æ ‡åŒç­‰é‡è¦ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè‹¥æŒ‡æ ‡é‡è¦æ€§ä¸åŒï¼Œéœ€è¦å…ˆç”¨å…¶ä»–æ–¹æ³•ï¼ˆå¦‚å±‚æ¬¡åˆ†ææ³•AHPã€ç†µæƒæ³•ç­‰ï¼‰ç¡®å®šæƒé‡ï¼Œå†è®¡ç®—**åŠ æƒç§©å’Œæ¯”ï¼ˆWRSRï¼‰**ã€‚å…¬å¼ä¸ºï¼š$WRSR_i = \frac{\sum_{j=1}^{m} (w_j \times R_{ij})}{n}$
3.  **åŒºåˆ†åº¦é—®é¢˜**ï¼šå½“è¯„ä»·å¯¹è±¡æ•°é‡ $n$ è¾ƒå°‘æ—¶ï¼Œç§©æ¬¡çš„å–å€¼èŒƒå›´æœ‰é™ï¼Œå¯èƒ½å¯¼è‡´RSRå€¼çš„åŒºåˆ†åº¦ä¸é«˜

### ç¤ºä¾‹ä»£ç 

å‡è®¾éœ€è¦å¯¹5ä¸ªåŸå¸‚çš„ç»¼åˆå‘å±•æ°´å¹³è¿›è¡Œè¯„ä»·ï¼Œé€‰å–äº†3ä¸ªæŒ‡æ ‡ï¼š
* **X1: äººå‡GDPï¼ˆä¸‡å…ƒï¼‰** - é«˜ä¼˜æŒ‡æ ‡
* **X2: ç©ºæ°”ä¼˜è‰¯ç‡ï¼ˆ%ï¼‰** - é«˜ä¼˜æŒ‡æ ‡
* **X3: å»ºæˆåŒºç»¿åœ°ç‡ï¼ˆ%ï¼‰** - ç†æƒ³å€¼ä¸º40%ï¼Œä¸­é—´å€¼æŒ‡æ ‡

```python
# -*- coding: utf-8 -*-
import pandas as pd
import numpy as np
from scipy.stats import norm


class RankSumRatioEvaluator:
    """
    ç§©å’Œæ¯”ï¼ˆRank Sum Ratio, RSRï¼‰ç»¼åˆè¯„ä»·å™¨

    è¯¥ç±»å°†RSRæ–¹æ³•çš„å®Œæ•´æµç¨‹å°è£…èµ·æ¥ï¼Œæ”¯æŒæå¤§ã€æå°ã€ä¸­é—´ã€åŒºé—´å››ç§æŒ‡æ ‡ç±»å‹ï¼Œ
    å¹¶å¯é€‰æ‹©æ€§åœ°è¿›è¡ŒåŠ æƒè®¡ç®—ï¼ˆWRSRï¼‰ï¼Œæœ€ç»ˆå®ç°å¯¹è¯„ä»·å¯¹è±¡çš„æ’åºå’Œç§‘å­¦åˆ†æ¡£ã€‚
    æ­¤ç‰ˆæœ¬ä¼šè¯¦ç»†æ‰“å°æ¯ä¸€æ­¥çš„ä¸­é—´è®¡ç®—ç»“æœï¼Œä¾¿äºè°ƒè¯•å’Œè¿‡ç¨‹å±•ç¤ºã€‚

    ä½¿ç”¨æµç¨‹:
    1. å‡†å¤‡æ•°æ® (pd.DataFrame)ã€‚
    2. å®šä¹‰æŒ‡æ ‡é…ç½® (dict)ã€‚
    3. (å¯é€‰) å®šä¹‰æƒé‡ (dict)ã€‚
    4. åˆ›å»ºç±»å®ä¾‹ã€‚
    5. è°ƒç”¨ evaluate() æ–¹æ³•è·å–æœ€ç»ˆç»“æœã€‚
    """

    def __init__(self, data_df, config, weights=None):
        """
        åˆå§‹åŒ–è¯„ä»·å™¨

        Args:
            data_df (pd.DataFrame): åŸå§‹æ•°æ®ï¼Œè¡Œåº”ä¸ºè¯„ä»·å¯¹è±¡ï¼Œåˆ—ä¸ºè¯„ä»·æŒ‡æ ‡ã€‚
            config (dict): æŒ‡æ ‡é…ç½®å­—å…¸ã€‚æ ¼å¼å¦‚ä¸‹:
                {
                    'æŒ‡æ ‡å1': {'type': 'high'},
                    'æŒ‡æ ‡å2': {'type': 'low'},
                    'æŒ‡æ ‡å3': {'type': 'middle', 'optimal': ç†æƒ³å€¼},
                    'æŒ‡æ ‡å4': {'type': 'interval', 'optimal': [ä¸‹é™, ä¸Šé™]}
                }
            weights (dict, optional): æŒ‡æ ‡æƒé‡å­—å…¸ï¼Œkeyä¸ºæŒ‡æ ‡åï¼Œvalueä¸ºæƒé‡å€¼ã€‚
                                      è‹¥ä¸ºNoneï¼Œåˆ™æ‰€æœ‰æŒ‡æ ‡ç­‰æƒé‡å¤„ç†ã€‚é»˜è®¤ä¸º Noneã€‚
        """
        if not isinstance(data_df, pd.DataFrame):
            raise ValueError("è¾“å…¥æ•°æ® data_df å¿…é¡»æ˜¯ pandas DataFrame æ ¼å¼ã€‚")
        if not data_df.index.is_unique:
            raise ValueError("æ•°æ®æ¡†çš„ç´¢å¼•ï¼ˆè¯„ä»·å¯¹è±¡åç§°ï¼‰å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚")

        self.raw_data = data_df.copy()
        self.config = config
        self.n_samples, self.n_indicators = self.raw_data.shape
        self.weights = self._validate_weights(weights)
        self.results = self.raw_data.copy()

    def _validate_weights(self, weights):
        """éªŒè¯æƒé‡çš„æœ‰æ•ˆæ€§"""
        if weights is None:
            # å¦‚æœä¸æä¾›æƒé‡ï¼Œåˆ™é»˜è®¤ä¸ºç­‰æƒé‡
            equal_weight = 1 / self.raw_data.shape[1]
            return {col: equal_weight for col in self.raw_data.columns}

        if not isinstance(weights, dict):
            raise ValueError("æƒé‡ 'weights' å¿…é¡»æ˜¯ä¸€ä¸ªå­—å…¸ã€‚")

        # æ£€æŸ¥æƒé‡æ˜¯å¦è¦†ç›–æ‰€æœ‰æŒ‡æ ‡ä¸”æ€»å’Œçº¦ç­‰äº1
        if set(weights.keys()) != set(self.raw_data.columns):
            raise ValueError("æƒé‡çš„é”®å¿…é¡»ä¸æ•°æ®æ¡†çš„åˆ—å®Œå…¨åŒ¹é…ã€‚")
        if not np.isclose(sum(weights.values()), 1.0):
            print(f"è­¦å‘Š: æƒé‡ä¹‹å’Œä¸º {sum(weights.values()):.4f}ï¼Œä¸ä¸¥æ ¼ç­‰äº1ã€‚è¯·æ£€æŸ¥ã€‚")

        return weights

    def _rank_indicators(self):
        """æ ¸å¿ƒæ­¥éª¤ï¼šæ ¹æ®æŒ‡æ ‡ç±»å‹è¿›è¡Œç¼–ç§©"""
        self.rank_matrix = pd.DataFrame(index=self.raw_data.index)
        self.deviation_matrix = pd.DataFrame(index=self.raw_data.index)

        for col_name, params in self.config.items():
            col_data = self.raw_data[col_name]
            indicator_type = params.get('type')

            if indicator_type == 'high':
                self.rank_matrix[col_name] = col_data.rank(method='average', ascending=True)

            elif indicator_type == 'low':
                self.rank_matrix[col_name] = col_data.rank(method='average', ascending=False)

            elif indicator_type == 'middle':
                optimal_value = params.get('optimal')
                if optimal_value is None:
                    raise ValueError(f"ä¸­é—´å‹æŒ‡æ ‡ '{col_name}' æœªåœ¨é…ç½®ä¸­æä¾› 'optimal' å€¼ã€‚")
                deviation = abs(col_data - optimal_value)
                self.deviation_matrix[col_name + '_dev'] = deviation  # å­˜å‚¨ç¦»å·®å€¼
                self.rank_matrix[col_name] = deviation.rank(method='average', ascending=False)

            elif indicator_type == 'interval':
                optimal_interval = params.get('optimal')
                if not (isinstance(optimal_interval, list) and len(optimal_interval) == 2):
                    raise ValueError(f"åŒºé—´å‹æŒ‡æ ‡ '{col_name}' çš„ 'optimal' å€¼å¿…é¡»æ˜¯ [ä¸‹é™, ä¸Šé™] æ ¼å¼çš„åˆ—è¡¨ã€‚")

                low_bound, up_bound = optimal_interval
                deviation = col_data.apply(
                    lambda x: 0 if low_bound <= x <= up_bound else min(abs(x - low_bound), abs(x - up_bound))
                )
                self.deviation_matrix[col_name + '_dev'] = deviation  # å­˜å‚¨ç¦»å·®å€¼
                self.rank_matrix[col_name] = deviation.rank(method='average', ascending=False)

            else:
                raise ValueError(f"æŒ‡æ ‡ '{col_name}' çš„ç±»å‹ '{indicator_type}' æœªçŸ¥ã€‚")

    def _calculate_rsr(self):
        """è®¡ç®—ç§©å’Œæ¯”(RSR)æˆ–åŠ æƒç§©å’Œæ¯”(WRSR)"""
        weight_vector = pd.Series(self.weights)
        aligned_weights = weight_vector[self.rank_matrix.columns]

        weighted_rank_sum = self.rank_matrix.dot(aligned_weights)

        self.results['RSR'] = weighted_rank_sum / self.n_samples

    def _analyze_distribution(self):
        """è®¡ç®—RSRçš„åˆ†å¸ƒï¼ŒåŒ…æ‹¬ç§©æ¬¡ã€ç´¯è®¡é¢‘ç‡å’Œæ¦‚ç‡å•ä½Probit"""
        self.results = self.results.sort_values(by='RSR')
        self.results['RSR_Rank'] = self.results['RSR'].rank(method='average')
        self.results['Cum_Freq'] = self.results['RSR_Rank'] / (self.n_samples + 1)
        self.results['Probit'] = norm.ppf(self.results['Cum_Freq']) + 5

    def _fit_regression_and_group(self, probit_thresholds={'å·®': 4, 'ä¸­': 6}):
        """æ‹Ÿåˆå›å½’æ–¹ç¨‹å¹¶è¿›è¡Œåˆ†æ¡£"""
        valid_data = self.results.dropna(subset=['RSR', 'Probit'])
        valid_data = valid_data[np.isfinite(valid_data['Probit'])]

        if len(valid_data) < 2:
            self.results['Grouping'] = 'N/A'
            self.regression_eq = "N/A"
            self.rsr_thresholds = {}
            return

        probit_values = valid_data['Probit']
        rsr_values = valid_data['RSR']

        b, a = np.polyfit(probit_values, rsr_values, 1)
        self.regression_eq = f"RSR = {a:.4f} + {b:.4f} * Probit"

        self.rsr_thresholds = {}
        sorted_thresholds = sorted(probit_thresholds.items(), key=lambda item: item[1])
        for level, probit_val in sorted_thresholds:
            self.rsr_thresholds[level] = a + b * probit_val

        def classify(rsr_value):
            if rsr_value >= self.rsr_thresholds['ä¸­']:
                return 'ä¼˜'
            elif rsr_value >= self.rsr_thresholds['å·®']:
                return 'ä¸­'
            else:
                return 'å·®'

        self.results['Grouping'] = self.results['RSR'].apply(classify)

    def evaluate(self):
        """
        æ‰§è¡Œå®Œæ•´çš„RSRè¯„ä»·æµç¨‹ï¼Œå¹¶æ‰“å°æ‰€æœ‰ä¸­é—´ç»“æœã€‚

        Returns:
            pd.DataFrame: ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸­é—´å’Œæœ€ç»ˆç»“æœçš„DataFrameã€‚
        """
        print("--- å¼€å§‹ç§©å’Œæ¯”(RSR)è¯„ä»· ---")
        use_weighted = not np.allclose(list(self.weights.values()), 1 / self.n_indicators)
        if use_weighted:
            print("æ¨¡å¼: åŠ æƒç§©å’Œæ¯” (WRSR)")
            print("æƒé‡:", self.weights)
        else:
            print("æ¨¡å¼: ç­‰æƒé‡ç§©å’Œæ¯” (RSR)")

        # æ­¥éª¤1: ç¼–ç§©
        print("\n[1/5] æ­£åœ¨æ ¹æ®æŒ‡æ ‡ç±»å‹è¿›è¡Œç¼–ç§©...")
        self._rank_indicators()
        if not self.deviation_matrix.empty:
            print("\n--- ä¸­é—´ç»“æœ: ç¦»å·®çŸ©é˜µ (ä»…å¯¹ä¸­é—´/åŒºé—´å‹æŒ‡æ ‡) ---")
            print(self.deviation_matrix)
        print("\n--- ä¸­é—´ç»“æœ: å®Œæ•´ç§©æ¬¡çŸ©é˜µ ---")
        print(self.rank_matrix)

        # æ­¥éª¤2: è®¡ç®—RSR
        print("\n[2/5] æ­£åœ¨è®¡ç®—RSRå€¼...")
        self._calculate_rsr()
        print("\n--- ä¸­é—´ç»“æœ: è®¡ç®—RSRåçš„æ•°æ®è¡¨ ---")
        print(self.results[['RSR']].sort_values(by='RSR'))

        # æ­¥éª¤3: ç¡®å®šåˆ†å¸ƒ
        print("\n[3/5] æ­£åœ¨åˆ†æRSRåˆ†å¸ƒå¹¶è®¡ç®—Probitå€¼...")
        self._analyze_distribution()
        print("\n--- ä¸­é—´ç»“æœ: RSRåˆ†å¸ƒç‰¹å¾åˆ†æè¡¨ ---")
        print(self.results[['RSR', 'RSR_Rank', 'Cum_Freq', 'Probit']])

        # æ­¥éª¤4: å›å½’
        print("\n[4/5] æ­£åœ¨æ‹Ÿåˆå›å½’æ¨¡å‹...")
        self._fit_regression_and_group()
        print("\n--- ä¸­é—´ç»“æœ: å›å½’åˆ†æä¸åˆ†æ¡£é˜ˆå€¼ ---")
        print(f"æ‹Ÿåˆå›å½’æ–¹ç¨‹: {self.regression_eq}")
        print("è®¡ç®—å‡ºçš„RSRåˆ†æ¡£çº¿:", {k: round(v, 4) for k, v in self.rsr_thresholds.items()})

        # æ­¥éª¤5: æœ€ç»ˆç»“æœ
        print("\n[5/5] æ­£åœ¨ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š...")
        final_results = self.results.reindex(self.raw_data.index)

        print("\n--- RSRè¯„ä»·å®Œæˆ ---")
        return final_results


if __name__ == '__main__':
    # 1. å‡†å¤‡åŸå§‹æ•°æ® (ä¾‹å¦‚ï¼Œè¯„ä»·8ä¸ªåœ°åŒºçš„å‘å±•çŠ¶å†µ)
    data = {
        'åœ°åŒº': [f'åœ°åŒº{chr(65 + i)}' for i in range(8)],
        'äººå‡GDP(ä¸‡å…ƒ)': [18, 12, 22, 10, 15, 19, 11, 14],  # æå¤§å€¼
        'æ–°ç”Ÿå„¿æ­»äº¡ç‡(â€°)': [3.5, 4.8, 2.1, 5.5, 4.1, 3.1, 5.2, 4.5],  # æå°å€¼
        'å¸ˆç”Ÿæ¯”(1:X)': [15, 18, 14, 20, 16, 15.5, 19, 17],  # ä¸­é—´å€¼ï¼Œç†æƒ³ä¸º1:15
        'ç©ºæ°”ä¼˜è‰¯å¤©æ•°æ¯”ä¾‹(%)': [85, 92, 88, 75, 95, 98, 82, 78],  # åŒºé—´å€¼ï¼Œç†æƒ³èŒƒå›´[85, 95]
    }
    df_raw = pd.DataFrame(data).set_index('åœ°åŒº')

    # 2. å®šä¹‰æŒ‡æ ‡é…ç½®
    config_demo = {
        'äººå‡GDP(ä¸‡å…ƒ)': {'type': 'high'},
        'æ–°ç”Ÿå„¿æ­»äº¡ç‡(â€°)': {'type': 'low'},
        'å¸ˆç”Ÿæ¯”(1:X)': {'type': 'middle', 'optimal': 15},
        'ç©ºæ°”ä¼˜è‰¯å¤©æ•°æ¯”ä¾‹(%)': {'type': 'interval', 'optimal': [85, 95]},
    }

    # 3. (å¯é€‰) å®šä¹‰æƒé‡ - å¦‚æœä¸å®šä¹‰ï¼Œåˆ™æ¯ä¸ªæŒ‡æ ‡æƒé‡ä¸º 1/4 = 0.25
    weights_demo = {
        'äººå‡GDP(ä¸‡å…ƒ)': 0.35,
        'æ–°ç”Ÿå„¿æ­»äº¡ç‡(â€°)': 0.35,
        'å¸ˆç”Ÿæ¯”(1:X)': 0.15,
        'ç©ºæ°”ä¼˜è‰¯å¤©æ•°æ¯”ä¾‹(%)': 0.15,
    }

    print("=" * 20 + " æ¡ˆä¾‹ä¸€: åŠ æƒç§©å’Œæ¯”è¯„ä»· " + "=" * 20)
    # 4. åˆ›å»ºå®ä¾‹å¹¶æ‰§è¡Œè¯„ä»· (ä½¿ç”¨åŠ æƒ)
    evaluator_weighted = RankSumRatioEvaluator(df_raw, config_demo, weights=weights_demo)
    final_report_weighted = evaluator_weighted.evaluate()

    # 5. æ˜¾ç¤ºæœ€ç»ˆæŠ¥å‘Š
    print("\n\n=============== æœ€ç»ˆç»¼åˆè¯„ä»·æŠ¥å‘Š (åŠ æƒ) ================")
    print(final_report_weighted)
```

## ç°è‰²é¢„æµ‹ GM(1,1) 

ç°è‰²ç³»ç»Ÿç†è®ºæ—¨åœ¨è§£å†³**â€œå°æ ·æœ¬â€ã€â€œè´«ä¿¡æ¯â€**ä¸‹çš„ä¸ç¡®å®šæ€§é—®é¢˜ã€‚å®ƒä¸è¿½æ±‚æ•°æ®çš„ç»Ÿè®¡è§„å¾‹ï¼Œè€Œæ˜¯é€šè¿‡ç‰¹å®šæ–¹æ³•å¤„ç†åŸå§‹æ•°æ®ï¼Œå¯»æ‰¾å…¶å†…åœ¨çš„å‘å±•è¶‹åŠ¿

GM(1,1)æ˜¯è¯¥ç†è®ºä¸­æœ€åŸºç¡€çš„æ¨¡å‹ï¼Œå…¶åç§°å«ä¹‰ä¸ºï¼š**G**rey **M**odel of **First-order** equation in **One** variableï¼ˆä¸€é˜¶å•å˜é‡ç°è‰²æ¨¡å‹ï¼‰

å…¶æ ¸å¿ƒæ“ä½œæ˜¯**ç´¯åŠ ç”Ÿæˆ(AGO)**ï¼Œå³å°†åŸå§‹çš„ã€å¯èƒ½çœ‹ä¼¼æ‚ä¹±çš„æ•°æ®åºåˆ—è¿›è¡Œç´¯åŠ ï¼Œç”Ÿæˆä¸€ä¸ªæ›´å¹³æ»‘ã€è¶‹åŠ¿æ€§æ›´å¼ºçš„åºåˆ—ï¼Œç„¶åå¯¹è¿™ä¸ªæ–°åºåˆ—å»ºæ¨¡

ä¸ºäº†ç›´è§‚ç†è§£ï¼Œå¯ä»¥å°†æ•°æ®é¢„æµ‹è¿‡ç¨‹æ¯”ä½œè§‚å¯Ÿå¹¶é¢„æµ‹ä¸€æ£µæ ‘çš„ç”Ÿé•¿ï¼š

* **åŸå§‹æ•°æ® `$X^{(0)}$`**: ä½ **æ¯å¤©**æµ‹é‡çš„æ ‘çš„ç”Ÿé•¿é‡ï¼ˆä¾‹å¦‚ï¼š2cm, 3cm, 2.5cm...ï¼‰ã€‚æ•°æ®æ³¢åŠ¨è¾ƒå¤§
* **ç´¯åŠ æ•°æ® `$X^{(1)}$`**: æ ‘çš„**ç´¯è®¡æ€»é«˜åº¦**ï¼ˆä¾‹å¦‚ï¼š2cm, 5cm, 7.5cm...ï¼‰ã€‚è¿™æ¡æ›²çº¿æ¯”æ¯æ—¥ç”Ÿé•¿é‡å¹³æ»‘å¾—å¤š
* **GM(1,1)çš„ç›®æ ‡**: é€šè¿‡å¯¹ç›¸å¯¹è§„å¾‹çš„â€œæ€»é«˜åº¦â€æ›²çº¿è¿›è¡Œå»ºæ¨¡ï¼Œæ¥åå‘æ¨æ–­å¹¶é¢„æµ‹æœªæ¥ä¸è§„å¾‹çš„â€œæ¯æ—¥ç”Ÿé•¿é‡â€


### æ ¸å¿ƒæ­¥éª¤

å‡è®¾åŸå§‹éè´Ÿæ•°æ®åºåˆ—ä¸º $X^{(0)} = (x^{(0)}(1), x^{(0)}(2), \dots, x^{(0)}(n))$

#### 1. ç´¯åŠ ç”Ÿæˆ (AGO)

**ç›®çš„**ï¼šå‰Šå¼±åŸå§‹æ•°æ®çš„éšæœºæ€§ï¼Œä½¿å…¶å‘ˆç°å•è°ƒè¶‹åŠ¿
å¯¹ $X^{(0)}$ è¿›è¡Œä¸€æ¬¡ç´¯åŠ ï¼Œå¾—åˆ°ä¸€é˜¶ç´¯åŠ ç”Ÿæˆåºåˆ— $X^{(1)}$

$$
x^{(1)}(k) = \sum_{i=1}^{k} x^{(0)}(i)
$$

* $x^{(1)}(1) = x^{(0)}(1)$
* $x^{(1)}(2) = x^{(0)}(1) + x^{(0)}(2)$
* ...

#### 2. æ„é€ èƒŒæ™¯å€¼ (ç´§é‚»å‡å€¼ç”Ÿæˆ)

**ç›®çš„**ï¼šä¸ºå»ºç«‹å¾®åˆ†æ–¹ç¨‹æ¨¡å‹åšå‡†å¤‡ï¼Œç”¨$X^{(1)}$çš„å‡å€¼æ¥è¿‘ä¼¼å…¶ç§¯åˆ†
æ„é€ èƒŒæ™¯å€¼åºåˆ— $Z^{(1)}$

$$
z^{(1)}(k) = 0.5 (x^{(1)}(k) + x^{(1)}(k-1)), \quad k = 2, 3, \dots, n
$$

#### 3. å»ºç«‹ç°è‰²å¾®åˆ†æ–¹ç¨‹å¹¶æ±‚è§£å‚æ•°

**ç›®çš„**ï¼šä»ç¦»æ•£çš„æ•°æ®ç‚¹ä¸­ï¼Œæç‚¼å‡ºèƒ½ä»£è¡¨æ•´ä½“è¶‹åŠ¿çš„æ ¸å¿ƒå‚æ•° `$a$` å’Œ `$b$`
**ç°è‰²å¾®åˆ†æ–¹ç¨‹**:
$$
x^{(0)}(k) + a z^{(1)}(k) = b
$$

**å‚æ•°å«ä¹‰**:
* $a$: **å‘å±•ç³»æ•° (Development Coefficient)**ã€‚å†³å®šäº†è¶‹åŠ¿å‘å±•çš„å¼ºåº¦
* $b$: **ç°è‰²ä½œç”¨é‡ (Grey Action Quantity)**ã€‚åæ˜ äº†æ•°æ®çš„å†…ç”Ÿé©±åŠ¨åŠ›

**æ±‚è§£**: ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£å‚æ•°åˆ—å‘é‡ $\hat{u} = [a, b]^T$

$$
Y = \begin{pmatrix} x^{(0)}(2) \\ x^{(0)}(3) \\ \vdots \\ x^{(0)}(n) \end{pmatrix}, \quad
B = \begin{pmatrix} -z^{(1)}(2) & 1 \\ -z^{(1)}(3) & 1 \\ \vdots & \vdots \\ -z^{(1)}(n) & 1 \end{pmatrix}
$$

$$
\hat{u} = (B^T B)^{-1} B^T Y
$$

#### 4. å»ºç«‹é¢„æµ‹æ¨¡å‹ (ç™½åŒ–æ–¹ç¨‹)

**ç›®çš„**ï¼šå°†ç¦»æ•£çš„ç°è‰²å…³ç³»è½¬åŒ–ä¸ºè¿ç»­çš„ã€å¯æ±‚è§£çš„å¾®åˆ†æ–¹ç¨‹ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªå¯ä»¥é¢„æµ‹æœªæ¥çš„â€œç”Ÿé•¿æ›²çº¿â€å…¬å¼

**ç™½åŒ–æ–¹ç¨‹ (æ—¶é—´çš„è¿ç»­å‡½æ•°)**:
$$
\frac{dx^{(1)}}{dt} + a x^{(1)} = b
$$

**æ±‚è§£æ–¹ç¨‹å¾—åˆ°é¢„æµ‹å…¬å¼**:
$$
\hat{x}^{(1)}(k+1) = \left(x^{(0)}(1) - \frac{b}{a}\right) e^{-ak} + \frac{b}{a}
$$

> è¯¥å…¬å¼ç”¨äºé¢„æµ‹**ç´¯åŠ åºåˆ—**åœ¨æœªæ¥ä»»æ„æ—¶åˆ»çš„å€¼

#### 5. ç´¯å‡è¿˜åŸ (IAGO)

**ç›®çš„**ï¼šå°†é¢„æµ‹å‡ºçš„â€œç´¯è®¡æ€»é«˜åº¦â€è¿˜åŸä¸ºæˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„â€œæ¯æ—¥ç”Ÿé•¿é‡â€
å¯¹é¢„æµ‹å‡ºçš„ $\hat{X}^{(1)}$ åºåˆ—è¿›è¡Œé€†å‘æ“ä½œ

* $\hat{x}^{(0)}(1) = x^{(0)}(1)$
* $\hat{x}^{(0)}(k+1) = \hat{x}^{(1)}(k+1) - \hat{x}^{(1)}(k) $

è¿™æ ·å°±å¾—åˆ°äº†åŸå§‹åºåˆ—çš„æ‹Ÿåˆå€¼ä¸é¢„æµ‹å€¼

### æ¨¡å‹æ£€éªŒ

| æ£€éªŒç±»å‹ | æ£€éªŒå¯¹è±¡ | æ£€éªŒç›®çš„ | æ£€éªŒæ€§è´¨ |
| :--- | :--- | :--- | :--- |
| **çº§æ¯”åå·®æ£€éªŒ** | æ¨¡å‹å‚æ•° `a` å†³å®šçš„ç†è®ºè¶‹åŠ¿ ä¸ æ•°æ®è‡ªèº«çš„æ¼”åŒ–è¶‹åŠ¿ | è¯„ä¼°æ¨¡å‹çš„**å†…éƒ¨ç»“æ„åˆç†æ€§** | **å†…éƒ¨ç»“æ„**æ£€éªŒ |
| **æ®‹å·®/åéªŒå·®æ£€éªŒ** | æœ€ç»ˆé¢„æµ‹å€¼ `$\hat{x}^{(0)}$` ä¸ åŸå§‹çœŸå®å€¼ `$x^{(0)}$` | è¯„ä¼°æ¨¡å‹çš„**æœ€ç»ˆé¢„æµ‹ç²¾åº¦** | **å¤–éƒ¨ç²¾åº¦**æ£€éªŒ |

#### 1. çº§æ¯”åå·®æ£€éªŒ

1. è®¡ç®—å•ä¸ªçº§æ¯”åå·® $\rho(k)$
$$
\rho(k) = \left| 1 - \left(\frac{1-0.5a}{1+0.5a}\right) \frac{1}{\sigma(k)} \right|
$$

-   $a$ä¸ºæ¨¡å‹å·²æ±‚å‡ºçš„å‘å±•ç³»æ•°
-   $\sigma(k) = \frac{x^{(0)}(k-1)}{x^{(0)}(k)}$ä¸ºåŸå§‹æ•°æ®çš„çº§æ¯”

2. è®¡ç®—å¹³å‡çº§æ¯”åå·® $\bar{\rho}$
$$
\bar{\rho} = \frac{1}{n-1} \sum_{k=2}^{n} \rho(k)
$$

**è¯„åˆ¤æ ‡å‡†ï¼š**

| å¹³å‡çº§æ¯”åå·® `$\bar{\rho}$` | çº§åˆ« |
|:-------------------:|:----:|
| $< 0.1$             |  ä¼˜  |
| $< 0.2$             | åˆæ ¼ |
| $\ge 0.2$           | ä¸åˆæ ¼ |

#### 2. æ®‹å·®æ£€éªŒ

**ç›®çš„**ï¼šç›´è§‚åˆ¤æ–­æ¨¡å‹å¯¹å†å²æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦

* **ç›¸å¯¹è¯¯å·®**:
$$
\Delta_k = \left| \frac{x^{(0)}(k) - \hat{x}^{(0)}(k)}{x^{(0)}(k)} \right|
$$

* **å¹³å‡ç›¸å¯¹ç²¾åº¦**:
$$
P_{\text{ç²¾åº¦}} = \left(1 - \frac{1}{n}\sum_{k=1}^{n} \Delta_k\right) \times 100\%
$$

| å¹³å‡ç›¸å¯¹ç²¾åº¦ | çº§åˆ« |
|:----------:|:----:|
| > 90%      |  ä¼˜  |
| > 80%      |  è‰¯  |
| > 70%      | åˆæ ¼ |
| < 70%      | ä¸åˆæ ¼ |

#### 3. åéªŒå·®æ£€éªŒ
**ç›®çš„**ï¼šæ›´ä¸¥æ ¼åœ°ä»ç»Ÿè®¡è§’åº¦è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›

1.  è®¡ç®—åŸå§‹åºåˆ—æ–¹å·® $S_1^2$ å’Œæ®‹å·®åºåˆ—æ–¹å·® $S_2^2$
2.  è®¡ç®—**åéªŒå·®æ¯”å€¼ C**:
$$
C = \frac{S_2}{S_1}
$$
3.  è®¡ç®—**å°è¯¯å·®æ¦‚ç‡ P**:
$$
P = \text{Prob} (|\text{æ®‹å·®}(k) - \text{æ®‹å·®å‡å€¼}| < 0.6745 S_1)
$$

æ ¹æ®Cå€¼å’ŒPå€¼ï¼Œå°†æ¨¡å‹ç²¾åº¦åˆ†ä¸ºå››ä¸ªç­‰çº§ï¼š

| ç²¾åº¦ç­‰çº§ | C å€¼ | P å€¼ |
|:----------:|:----------:|:----------:|
| **ä¼˜ (ä¸€çº§)** | $C \le 0.35$ | $P \ge 0.95$ |
| **åˆæ ¼ (äºŒçº§)** | $C \le 0.50$ | $P \ge 0.80$ |
| **å‹‰å¼ºåˆæ ¼ (ä¸‰çº§)** | $C \le 0.65$ | $P \ge 0.70$ |
| **ä¸åˆæ ¼ (å››çº§)** | $C > 0.65$ | $P < 0.70$ |

**åªæœ‰é€šè¿‡åéªŒå·®æ£€éªŒï¼ˆè‡³å°‘è¾¾åˆ°å‹‰å¼ºåˆæ ¼ï¼‰çš„æ¨¡å‹ï¼Œæ‰èƒ½ç”¨äºå¤–æ¨é¢„æµ‹**

### ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯

**ä¼˜ç‚¹**
* **æ ·æœ¬éœ€æ±‚å°‘**: ç†è®ºä¸Š4ä¸ªæ•°æ®ç‚¹å³å¯å»ºæ¨¡ï¼Œéå¸¸é€‚åˆæ•°æ®ç¨€ç–çš„åœºæ™¯
* **åˆ†å¸ƒè¦æ±‚å®½**: ä¸éœ€è¦æ•°æ®æœä»ç‰¹å®šçš„ç»Ÿè®¡åˆ†å¸ƒï¼ˆå¦‚æ­£æ€åˆ†å¸ƒï¼‰
* **è®¡ç®—ç®€å•**: ç›¸è¾ƒäºå¤æ‚çš„è®¡é‡æˆ–æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè®¡ç®—è¿‡ç¨‹æ¸…æ™°ã€å¿«æ·
* **çŸ­æœŸé¢„æµ‹å‡†**: å¯¹äºå…·æœ‰æ˜æ˜¾å•è°ƒï¼ˆç±»æŒ‡æ•°ï¼‰è¶‹åŠ¿çš„åºåˆ—ï¼ŒçŸ­æœŸé¢„æµ‹æ•ˆæœå¥½

**ç¼ºç‚¹**
* **é€‚ç”¨èŒƒå›´çª„**: å¯¹æ³¢åŠ¨æ€§å¼ºã€å‘¨æœŸæ€§æˆ–æ— æ˜æ˜¾è¶‹åŠ¿çš„åºåˆ—æ•ˆæœå¾ˆå·®
* **ä¸­é•¿æœŸé¢„æµ‹å·®**: æœ¬è´¨æ˜¯æŒ‡æ•°æ‹Ÿåˆï¼Œé¢„æµ‹æœŸè¶Šé•¿ï¼Œè¯¯å·®ç´¯ç§¯è¶Šä¸¥é‡
* **æ¨¡å‹è¾ƒæ•æ„Ÿ**: åŸå§‹æ•°æ®çš„å¾®å°å˜åŠ¨æˆ–æ–°æ•°æ®çš„åŠ å…¥å¯èƒ½å¯¼è‡´æ¨¡å‹å‚æ•°å˜åŒ–è¾ƒå¤§

**é€‚ç”¨åœºæ™¯**
é€‚ç”¨äº**æ•°æ®é‡æœ‰é™**çš„**çŸ­æœŸ**ã€**å•è°ƒè¶‹åŠ¿**é¢„æµ‹

* **ç¤¾ä¼šç»æµ**: èƒ½æºæ¶ˆè€—ã€ç²®é£Ÿäº§é‡ã€äººå£æ•°é‡ã€ç‰¹å®šå•†å“ä»·æ ¼çš„çŸ­æœŸè¶‹åŠ¿
* **ç®¡ç†å†³ç­–**: æ–°äº§å“é”€é‡ã€ç½‘ç«™è®¿é—®é‡ã€åº“å­˜å˜åŒ–çš„çŸ­æœŸé¢„æµ‹
* **åœ°è´¨æ°´æ–‡**: æ²³æµå¾„æµé‡ã€è‡ªç„¶ç¾å®³å‘ç”Ÿæ¬¡æ•°çš„çŸ­æœŸé¢„æµ‹

### ç¤ºä¾‹ä»£ç 

```python
import numpy as np
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False


class GreyForecast:
    """
    GM(1,1)ç°è‰²é¢„æµ‹æ¨¡å‹
    è¯¥ç±»å®ç°äº†ç°è‰²é¢„æµ‹çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬çº§æ¯”æ£€éªŒã€å»ºæ¨¡ã€é¢„æµ‹å’Œå¤šç»´åº¦æ£€éªŒã€‚
    """

    def __init__(self, data, n_preds):
        """
        åˆå§‹åŒ–æ¨¡å‹
        :param data: åŸå§‹æ•°æ®åºåˆ— (list or numpy array)
        :param n_preds: éœ€è¦å‘åé¢„æµ‹çš„æœŸæ•° (int)
        """
        if not isinstance(data, (list, np.ndarray)) or len(data) < 4:
            raise ValueError("è¾“å…¥æ•°æ®å¿…é¡»æ˜¯åˆ—è¡¨æˆ–Numpyæ•°ç»„ï¼Œä¸”è‡³å°‘åŒ…å«4ä¸ªæ•°æ®ç‚¹ã€‚")
        self.original_data = np.array(data)
        self.n_preds = n_preds
        self.n = len(data)
        self.prediction_results = None

    def _level_ratio_test(self, data_series):
        """
        æ‰§è¡Œçº§æ¯”æ£€éªŒ
        :param data_series: éœ€è¦æ£€éªŒçš„æ•°æ®åºåˆ—
        :return: (bool, list) æ˜¯å¦é€šè¿‡æ£€éªŒï¼Œçº§æ¯”åºåˆ—
        """
        level_ratios = data_series[1:] / data_series[:-1]
        lower_bound = np.exp(-2 / (self.n + 1))
        upper_bound = np.exp(2 / (self.n + 1))

        passed = np.all((level_ratios > lower_bound) & (level_ratios < upper_bound))
        return passed, level_ratios

    def fit(self):
        """
        æ‰§è¡Œå»ºæ¨¡ä¸é¢„æµ‹å…¨æµç¨‹
        """
        x0 = self.original_data
        translation_c = 0

        # 1. å»ºæ¨¡å‰çº§æ¯”æ£€éªŒ
        test_passed, _ = self._level_ratio_test(x0)

        if not test_passed:
            # å°è¯•å¹³ç§»å˜æ¢
            translation_c = -x0.min() + 1  # ä¿è¯æ‰€æœ‰æ•°æ®ä¸ºæ­£
            x0 = x0 + translation_c
            test_passed_after_translation, _ = self._level_ratio_test(x0)
            if not test_passed_after_translation:
                print("è­¦å‘Šï¼šåŸå§‹æ•°æ®æœªé€šè¿‡çº§æ¯”æ£€éªŒï¼Œä¸”å¹³ç§»å˜æ¢åä»æœªé€šè¿‡ã€‚æ¨¡å‹å¯èƒ½ä¸é€‚ç”¨ã€‚")

        # 2. ç´¯åŠ ç”Ÿæˆ (AGO)
        x1 = np.cumsum(x0)

        # 3. æ„é€ èƒŒæ™¯å€¼ (ç´§é‚»å‡å€¼ç”Ÿæˆ)
        z1 = 0.5 * (x1[:-1] + x1[1:])

        # 4. æœ€å°äºŒä¹˜æ³•æ±‚è§£å‚æ•° a, b
        Y = x0[1:].reshape(-1, 1)
        B = np.vstack((-z1, np.ones_like(z1))).T

        # u = [a, b]^T
        u = np.linalg.inv(B.T @ B) @ B.T @ Y
        a, b = u.flatten()

        # 5. å»ºç«‹é¢„æµ‹æ¨¡å‹
        total_len = self.n + self.n_preds
        x1_fit_pred = np.zeros(total_len)
        x1_fit_pred[0] = x0[0]

        for k in range(1, total_len):
            x1_fit_pred[k] = (x0[0] - b / a) * np.exp(-a * k) + b / a

        # 6. ç´¯å‡è¿˜åŸ (IAGO)
        x0_fit_pred = np.zeros(total_len)
        x0_fit_pred[0] = x0[0]
        x0_fit_pred[1:] = x1_fit_pred[1:] - x1_fit_pred[:-1]

        # 7. å¦‚æœè¿›è¡Œäº†å¹³ç§»ï¼Œè¿›è¡Œé€†å˜æ¢
        if translation_c > 0:
            x0_fit_pred -= translation_c

        # 8. åˆ†ç¦»æ‹Ÿåˆå€¼å’Œé¢„æµ‹å€¼
        fitted_values = x0_fit_pred[:self.n]
        predicted_values = x0_fit_pred[self.n:]

        # 9. æ¨¡å‹æ£€éªŒ
        tests = self._run_post_tests(self.original_data, fitted_values, a)

        self.prediction_results = {
            "parameters": {"a": a, "b": b},
            "translation_c": translation_c,
            "fitted_values": fitted_values,
            "predicted_values": predicted_values,
            "tests": tests
        }
        return self.prediction_results

    def _run_post_tests(self, original, fitted, a):
        """
        æ‰§è¡Œæ‰€æœ‰å»ºæ¨¡åçš„æ£€éªŒ
        """
        # --- æ®‹å·®æ£€éªŒ ---
        residuals = original - fitted
        relative_errors = np.abs(residuals / original)
        mean_relative_error = np.mean(relative_errors)
        accuracy = 1 - mean_relative_error

        # --- åéªŒå·®æ£€éªŒ ---
        s1_sq = np.var(original, ddof=1)
        s2_sq = np.var(residuals, ddof=1)
        C = np.sqrt(s2_sq / s1_sq)

        # å°è¯¯å·®æ¦‚ç‡P
        s1 = np.std(original, ddof=1)
        p_count = np.sum(np.abs(residuals - np.mean(residuals)) < 0.6745 * s1)
        P = p_count / self.n

        # --- çº§æ¯”åå·®æ£€éªŒ ---
        _, level_ratios = self._level_ratio_test(self.original_data)  # ä½¿ç”¨åŸå§‹æ•°æ®çº§æ¯”
        theory_ratio = (1 - 0.5 * a) / (1 + 0.5 * a)
        ratio_deviations = np.abs(1 - theory_ratio / level_ratios[1:])  # sigma(k) from k=2
        mean_ratio_deviation = np.mean(ratio_deviations)

        return {
            "residual_test": {
                "residuals": residuals,
                "relative_errors": relative_errors,
                "mean_relative_error": mean_relative_error,
                "accuracy": accuracy
            },
            "posterior_error_test": {
                "C_ratio": C,
                "P_small_error_prob": P
            },
            "level_ratio_deviation_test": {
                "mean_deviation": mean_ratio_deviation
            }
        }

    def plot(self):
        """
        ç»˜åˆ¶ç»“æœå›¾
        """
        if self.prediction_results is None:
            print("è¯·å…ˆè°ƒç”¨ .fit() æ–¹æ³•è¿›è¡Œå»ºæ¨¡ã€‚")
            return

        original_time_axis = np.arange(1, self.n + 1)
        fitted_time_axis = np.arange(1, self.n + 1)
        predicted_time_axis = np.arange(self.n + 1, self.n + self.n_preds + 1)

        plt.figure(figsize=(12, 7))
        plt.plot(original_time_axis, self.original_data, 'o-', label='åŸå§‹æ•°æ® (Original Data)', color='blue')
        plt.plot(fitted_time_axis, self.prediction_results['fitted_values'], 's--', label='æ‹Ÿåˆæ•°æ® (Fitted Data)',
                 color='green')
        plt.plot(predicted_time_axis, self.prediction_results['predicted_values'], '^-',
                 label='é¢„æµ‹æ•°æ® (Predicted Data)', color='red')

        plt.title('GM(1,1) ç°è‰²é¢„æµ‹æ¨¡å‹ç»“æœ')
        plt.xlabel('æ—¶é—´åºåˆ— (Time Series)')
        plt.ylabel('æ•°å€¼ (Value)')
        plt.legend()
        plt.grid(True, linestyle='--', alpha=0.6)
        plt.show()

    def print_results(self):
        """
        æ ¼å¼åŒ–æ‰“å°æ‰€æœ‰ç»“æœ
        """
        if self.prediction_results is None:
            print("è¯·å…ˆè°ƒç”¨ .fit() æ–¹æ³•è¿›è¡Œå»ºæ¨¡ã€‚")
            return

        res = self.prediction_results
        print("\n" + "=" * 50)
        print("GM(1,1) ç°è‰²é¢„æµ‹æ¨¡å‹ç»“æœæŠ¥å‘Š")
        print("=" * 50)

        # æ·»åŠ çº§æ¯”æ£€éªŒç»“æœæ‰“å°
        print("\n[1] çº§æ¯”æ£€éªŒç»“æœ")
        original_passed, original_ratios = self._level_ratio_test(self.original_data)
        lower_bound = np.exp(-2 / (self.n + 1))
        upper_bound = np.exp(2 / (self.n + 1))

        print(f"  - çº§æ¯”æ£€éªŒåŒºé—´: ({lower_bound:.4f}, {upper_bound:.4f})")
        print(f"  - åŸå§‹æ•°æ®çº§æ¯”æ£€éªŒ: {'é€šè¿‡' if original_passed else 'ä¸é€šè¿‡'}")
        print(f"  - çº§æ¯”åºåˆ—: {[f'{ratio:.4f}' for ratio in original_ratios]}")

        if res['translation_c'] > 0:
            transformed_data = self.original_data + res['translation_c']
            transformed_passed, transformed_ratios = self._level_ratio_test(transformed_data)
            print(f"  - å¹³ç§»å˜æ¢åçº§æ¯”æ£€éªŒ: {'é€šè¿‡' if transformed_passed else 'ä¸é€šè¿‡'}")
            print(f"  - å¹³ç§»åçº§æ¯”åºåˆ—: {[f'{ratio:.4f}' for ratio in transformed_ratios]}")

        print("\n[2] æ¨¡å‹å‚æ•°")
        print(f"  - å‘å±•ç³»æ•° a = {res['parameters']['a']:.4f}")
        print(f"  - ç°è‰²ä½œç”¨é‡ b = {res['parameters']['b']:.4f}")
        if res['translation_c'] > 0:
            print(f"  - å¹³ç§»å˜æ¢å¸¸æ•° c = {res['translation_c']:.4f}")

        print("\n[3] æ‹Ÿåˆä¸é¢„æµ‹å€¼")
        for i, val in enumerate(res['fitted_values']):
            print(f"  - ç¬¬ {i + 1} æœŸ (æ‹Ÿåˆå€¼): {val:.4f}")
        for i, val in enumerate(res['predicted_values']):
            print(f"  - ç¬¬ {self.n + i + 1} æœŸ (é¢„æµ‹å€¼): {val:.4f}")

        print("\n[4] æ¨¡å‹æ£€éªŒç»“æœ")
        # æ®‹å·®æ£€éªŒ
        acc = res['tests']['residual_test']['accuracy']
        print(f"\n--- 4.1 æ®‹å·®æ£€éªŒ ---")
        print(f"  - å¹³å‡ç›¸å¯¹è¯¯å·®: {1 - acc:.4%}")
        print(f"  - æ¨¡å‹ç²¾åº¦: {acc:.4%}")

        # åéªŒå·®æ£€éªŒ
        C = res['tests']['posterior_error_test']['C_ratio']
        P = res['tests']['posterior_error_test']['P_small_error_prob']
        c_level = "ä¼˜" if C <= 0.35 else "åˆæ ¼" if C <= 0.50 else "å‹‰å¼ºåˆæ ¼" if C <= 0.65 else "ä¸åˆæ ¼"
        p_level = "ä¼˜" if P >= 0.95 else "åˆæ ¼" if P >= 0.80 else "å‹‰å¼ºåˆæ ¼" if P >= 0.70 else "ä¸åˆæ ¼"
        print(f"\n--- 4.2 åéªŒå·®æ£€éªŒ ---")
        print(f"  - åéªŒå·®æ¯”å€¼ C = {C:.4f} (ç­‰çº§: {c_level})")
        print(f"  - å°è¯¯å·®æ¦‚ç‡ P = {P:.4f} (ç­‰çº§: {p_level})")

        # çº§æ¯”åå·®æ£€éªŒ
        rho = res['tests']['level_ratio_deviation_test']['mean_deviation']
        rho_level = "ä¼˜" if rho < 0.1 else "åˆæ ¼" if rho < 0.2 else "ä¸åˆæ ¼"
        print(f"\n--- 4.3 çº§æ¯”åå·®æ£€éªŒ ---")
        print(f"  - å¹³å‡çº§æ¯”åå·® = {rho:.4f} (ç­‰çº§: {rho_level})")

        print("\n" + "=" * 50)


# ==============================================================================
#                                  ç¤ºä¾‹ç”¨æ³•
# ==============================================================================
if __name__ == '__main__':
    # ç¤ºä¾‹1ï¼šä¸€ç»„å…¸å‹çš„å¢é•¿æ•°æ®
    print("--- ç¤ºä¾‹ 1ï¼šå…¸å‹å¢é•¿æ•°æ® ---")
    # æ•°æ®æ¥æºï¼šæŸåœ°åŒºè´¢æ”¿æ”¶å…¥ï¼Œå•ä½ï¼šäº¿å…ƒ
    raw_data_1 = [71.8, 80.6, 96.5, 108.3, 118.9, 130.1]
    # å»ºç«‹æ¨¡å‹ï¼Œå‘åé¢„æµ‹3æœŸ
    gm_model_1 = GreyForecast(raw_data_1, n_preds=3)
    # æ‰§è¡Œå»ºæ¨¡
    gm_model_1.fit()
    # æ‰“å°ç»“æœæŠ¥å‘Š
    gm_model_1.print_results()
    # ç»˜åˆ¶å›¾è¡¨
    gm_model_1.plot()

    # ç¤ºä¾‹2ï¼šä¸€ç»„æ³¢åŠ¨è¾ƒå¤§ï¼Œå¯èƒ½éœ€è¦å¹³ç§»çš„æ•°æ®
    print("\n\n--- ç¤ºä¾‹ 2ï¼šæ³¢åŠ¨è¾ƒå¤§ï¼Œä¸ä¸€å®šé€‚ç”¨çš„ç¤ºä¾‹ ---")
    raw_data_2 = [22, 20, 25, 28, 26, 30, 34, 32]
    # å»ºç«‹æ¨¡å‹ï¼Œå‘åé¢„æµ‹4æœŸ
    gm_model_2 = GreyForecast(raw_data_2, n_preds=4)
    gm_model_2.fit()
    gm_model_2.print_results()
    gm_model_2.plot()
```